{
    "ast": "TranslationUnit",
    "filename": "/Users/mp/alicenode_inhabitat/project.cpp",
    "nodes": [
        {
            "ast": "StructDecl",
            "loc": {
                "begin": {
                    "char": 355,
                    "col": 1,
                    "line": 19
                },
                "end": {
                    "char": 3398,
                    "col": 2,
                    "line": 120
                }
            },
            "name": "GBuffer",
            "nodes": [
                {
                    "ast": "VarDecl",
                    "loc": {
                        "begin": {
                            "char": 374,
                            "col": 2,
                            "line": 21
                        },
                        "end": {
                            "char": 405,
                            "col": 33,
                            "line": 21
                        }
                    },
                    "name": "numBuffers",
                    "nodes": [
                        {
                            "ast": "IntegerLiteral",
                            "loc": {
                                "begin": {
                                    "char": 404,
                                    "col": 32,
                                    "line": 21
                                },
                                "end": {
                                    "char": 405,
                                    "col": 33,
                                    "line": 21
                                }
                            },
                            "type": "int",
                            "value": 3
                        }
                    ],
                    "type": "const int"
                },
                {
                    "ast": "FieldDecl",
                    "loc": {
                        "begin": {
                            "char": 409,
                            "col": 2,
                            "line": 23
                        },
                        "end": {
                            "char": 425,
                            "col": 18,
                            "line": 23
                        }
                    },
                    "name": "fbo",
                    "offsetof": 0,
                    "sizeof": 4,
                    "type": "unsigned int"
                },
                {
                    "ast": "FieldDecl",
                    "loc": {
                        "begin": {
                            "char": 428,
                            "col": 2,
                            "line": 24
                        },
                        "end": {
                            "char": 444,
                            "col": 18,
                            "line": 24
                        }
                    },
                    "name": "rbo",
                    "offsetof": 0,
                    "sizeof": 4,
                    "type": "unsigned int"
                },
                {
                    "ast": "FieldDecl",
                    "loc": {
                        "begin": {
                            "char": 447,
                            "col": 2,
                            "line": 25
                        },
                        "end": {
                            "char": 481,
                            "col": 36,
                            "line": 25
                        }
                    },
                    "name": "textures",
                    "offsetof": 0,
                    "sizeof": 4,
                    "type": "int"
                },
                {
                    "ast": "FieldDecl",
                    "loc": {
                        "begin": {
                            "char": 484,
                            "col": 2,
                            "line": 26
                        },
                        "end": {
                            "char": 521,
                            "col": 39,
                            "line": 26
                        }
                    },
                    "name": "attachments",
                    "offsetof": 0,
                    "sizeof": 4,
                    "type": "int"
                },
                {
                    "ast": "FieldDecl",
                    "comment": {
                        "text": "//GLint min_filter = GL_LINEAR; \n\t//GLint mag_filter = GL_LINEAR;"
                    },
                    "loc": {
                        "begin": {
                            "char": 592,
                            "col": 2,
                            "line": 30
                        },
                        "end": {
                            "char": 621,
                            "col": 31,
                            "line": 30
                        }
                    },
                    "name": "min_filter",
                    "nodes": [
                        {
                            "ast": "TypeRef",
                            "loc": {
                                "begin": {
                                    "char": 592,
                                    "col": 2,
                                    "line": 30
                                },
                                "end": {
                                    "char": 597,
                                    "col": 7,
                                    "line": 30
                                }
                            },
                            "name": "GLint",
                            "type": "GLint"
                        },
                        {
                            "ast": "IntegerLiteral",
                            "loc": {
                                "begin": {
                                    "char": 611,
                                    "col": 21,
                                    "line": 30
                                },
                                "end": {
                                    "char": 621,
                                    "col": 31,
                                    "line": 30
                                }
                            },
                            "type": "int",
                            "value": 9728
                        }
                    ],
                    "offsetof": 0,
                    "sizeof": 4,
                    "type": "GLint"
                },
                {
                    "ast": "FieldDecl",
                    "loc": {
                        "begin": {
                            "char": 624,
                            "col": 2,
                            "line": 31
                        },
                        "end": {
                            "char": 653,
                            "col": 31,
                            "line": 31
                        }
                    },
                    "name": "mag_filter",
                    "nodes": [
                        {
                            "ast": "TypeRef",
                            "loc": {
                                "begin": {
                                    "char": 624,
                                    "col": 2,
                                    "line": 31
                                },
                                "end": {
                                    "char": 629,
                                    "col": 7,
                                    "line": 31
                                }
                            },
                            "name": "GLint",
                            "type": "GLint"
                        },
                        {
                            "ast": "IntegerLiteral",
                            "loc": {
                                "begin": {
                                    "char": 643,
                                    "col": 21,
                                    "line": 31
                                },
                                "end": {
                                    "char": 653,
                                    "col": 31,
                                    "line": 31
                                }
                            },
                            "type": "int",
                            "value": 9728
                        }
                    ],
                    "offsetof": 0,
                    "sizeof": 4,
                    "type": "GLint"
                },
                {
                    "ast": "FieldDecl",
                    "loc": {
                        "begin": {
                            "char": 657,
                            "col": 2,
                            "line": 33
                        },
                        "end": {
                            "char": 671,
                            "col": 16,
                            "line": 33
                        }
                    },
                    "name": "dim",
                    "nodes": [
                        {
                            "ast": "NamespaceRef",
                            "loc": {
                                "begin": {
                                    "char": 657,
                                    "col": 2,
                                    "line": 33
                                },
                                "end": {
                                    "char": 660,
                                    "col": 5,
                                    "line": 33
                                }
                            },
                            "name": "glm"
                        },
                        {
                            "ast": "TypeRef",
                            "loc": {
                                "begin": {
                                    "char": 662,
                                    "col": 7,
                                    "line": 33
                                },
                                "end": {
                                    "char": 667,
                                    "col": 12,
                                    "line": 33
                                }
                            },
                            "name": "glm::ivec2",
                            "type": "glm::ivec2"
                        }
                    ],
                    "offsetof": 0,
                    "sizeof": -2,
                    "type": "glm::ivec2"
                },
                {
                    "ast": "CXXConstructor",
                    "loc": {
                        "begin": {
                            "char": 700,
                            "col": 2,
                            "line": 35
                        },
                        "end": {
                            "char": 797,
                            "col": 3,
                            "line": 38
                        }
                    },
                    "name": "GBuffer",
                    "nodes": [
                        {
                            "ast": "ParmDecl",
                            "loc": {
                                "begin": {
                                    "char": 708,
                                    "col": 10,
                                    "line": 35
                                },
                                "end": {
                                    "char": 726,
                                    "col": 28,
                                    "line": 35
                                }
                            },
                            "name": "numbuffers",
                            "nodes": [
                                {
                                    "ast": "IntegerLiteral",
                                    "loc": {
                                        "begin": {
                                            "char": 725,
                                            "col": 27,
                                            "line": 35
                                        },
                                        "end": {
                                            "char": 726,
                                            "col": 28,
                                            "line": 35
                                        }
                                    },
                                    "type": "int",
                                    "value": 3
                                }
                            ],
                            "type": "int"
                        },
                        {
                            "ast": "CompoundStmt",
                            "loc": {
                                "begin": {
                                    "char": 728,
                                    "col": 30,
                                    "line": 35
                                },
                                "end": {
                                    "char": 797,
                                    "col": 3,
                                    "line": 38
                                }
                            },
                            "text": "{\n\t\ttextures.resize(numbuffers);\n\t\tattachments.resize(numbuffers);\n\t}"
                        }
                    ],
                    "type": "void (int)"
                },
                {
                    "ast": "CXXMethod",
                    "loc": {
                        "begin": {
                            "char": 800,
                            "col": 2,
                            "line": 40
                        },
                        "end": {
                            "char": 1451,
                            "col": 3,
                            "line": 49
                        }
                    },
                    "mangled_name": "__ZN7GBuffer16configureTextureEiijj",
                    "name": "configureTexture",
                    "nodes": [
                        {
                            "ast": "ParmDecl",
                            "loc": {
                                "begin": {
                                    "char": 822,
                                    "col": 24,
                                    "line": 40
                                },
                                "end": {
                                    "char": 838,
                                    "col": 40,
                                    "line": 40
                                }
                            },
                            "name": "attachment",
                            "nodes": [
                                {
                                    "ast": "IntegerLiteral",
                                    "loc": {
                                        "begin": {
                                            "char": 837,
                                            "col": 39,
                                            "line": 40
                                        },
                                        "end": {
                                            "char": 838,
                                            "col": 40,
                                            "line": 40
                                        }
                                    },
                                    "type": "int",
                                    "value": 0
                                }
                            ],
                            "type": "int"
                        },
                        {
                            "ast": "ParmDecl",
                            "loc": {
                                "begin": {
                                    "char": 840,
                                    "col": 42,
                                    "line": 40
                                },
                                "end": {
                                    "char": 870,
                                    "col": 72,
                                    "line": 40
                                }
                            },
                            "name": "internalFormat",
                            "nodes": [
                                {
                                    "ast": "TypeRef",
                                    "loc": {
                                        "begin": {
                                            "char": 840,
                                            "col": 42,
                                            "line": 40
                                        },
                                        "end": {
                                            "char": 845,
                                            "col": 47,
                                            "line": 40
                                        }
                                    },
                                    "name": "GLint",
                                    "type": "GLint"
                                },
                                {
                                    "ast": "IntegerLiteral",
                                    "loc": {
                                        "begin": {
                                            "char": 863,
                                            "col": 65,
                                            "line": 40
                                        },
                                        "end": {
                                            "char": 870,
                                            "col": 72,
                                            "line": 40
                                        }
                                    },
                                    "type": "int",
                                    "value": 6408
                                }
                            ],
                            "type": "GLint"
                        },
                        {
                            "ast": "ParmDecl",
                            "loc": {
                                "begin": {
                                    "char": 872,
                                    "col": 74,
                                    "line": 40
                                },
                                "end": {
                                    "char": 895,
                                    "col": 97,
                                    "line": 40
                                }
                            },
                            "name": "format",
                            "nodes": [
                                {
                                    "ast": "TypeRef",
                                    "loc": {
                                        "begin": {
                                            "char": 872,
                                            "col": 74,
                                            "line": 40
                                        },
                                        "end": {
                                            "char": 878,
                                            "col": 80,
                                            "line": 40
                                        }
                                    },
                                    "name": "GLenum",
                                    "type": "GLenum"
                                },
                                {
                                    "ast": "IntegerLiteral",
                                    "loc": {
                                        "begin": {
                                            "char": 888,
                                            "col": 90,
                                            "line": 40
                                        },
                                        "end": {
                                            "char": 895,
                                            "col": 97,
                                            "line": 40
                                        }
                                    },
                                    "type": "int"
                                }
                            ],
                            "type": "GLenum"
                        },
                        {
                            "ast": "ParmDecl",
                            "loc": {
                                "begin": {
                                    "char": 897,
                                    "col": 99,
                                    "line": 40
                                },
                                "end": {
                                    "char": 927,
                                    "col": 129,
                                    "line": 40
                                }
                            },
                            "name": "type",
                            "nodes": [
                                {
                                    "ast": "TypeRef",
                                    "loc": {
                                        "begin": {
                                            "char": 897,
                                            "col": 99,
                                            "line": 40
                                        },
                                        "end": {
                                            "char": 903,
                                            "col": 105,
                                            "line": 40
                                        }
                                    },
                                    "name": "GLenum",
                                    "type": "GLenum"
                                },
                                {
                                    "ast": "IntegerLiteral",
                                    "loc": {
                                        "begin": {
                                            "char": 911,
                                            "col": 113,
                                            "line": 40
                                        },
                                        "end": {
                                            "char": 927,
                                            "col": 129,
                                            "line": 40
                                        }
                                    },
                                    "type": "int"
                                }
                            ],
                            "type": "GLenum"
                        },
                        {
                            "ast": "CompoundStmt",
                            "loc": {
                                "begin": {
                                    "char": 929,
                                    "col": 131,
                                    "line": 40
                                },
                                "end": {
                                    "char": 1451,
                                    "col": 3,
                                    "line": 49
                                }
                            },
                            "text": "{\n\t\tattachments[attachment] = GL_COLOR_ATTACHMENT0+attachment;\n\t\tglBindTexture(GL_TEXTURE_2D, textures[attachment]);\n\t\tglTexImage2D(GL_TEXTURE_2D, 0, internalFormat, dim.x, dim.y, 0, format, type, NULL);\n\t\tglTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_MIN_FILTER, min_filter);\n\t\tglTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_MAG_FILTER, mag_filter);\n\t\tglTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_WRAP_S, GL_CLAMP_TO_EDGE);\n\t\tglTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_WRAP_T, GL_CLAMP_TO_EDGE); \n\t\tglBindTexture(GL_TEXTURE_2D, 0);\n\t}"
                        }
                    ],
                    "type": "void (int, GLint, GLenum, GLenum)",
                    "type_args": [
                        "int",
                        "GLint",
                        "GLenum",
                        "GLenum"
                    ],
                    "type_ret": "void"
                },
                {
                    "ast": "CXXMethod",
                    "loc": {
                        "begin": {
                            "char": 1455,
                            "col": 2,
                            "line": 51
                        },
                        "end": {
                            "char": 2679,
                            "col": 3,
                            "line": 86
                        }
                    },
                    "mangled_name": "__ZN7GBuffer12dest_changedEv",
                    "name": "dest_changed",
                    "nodes": [
                        {
                            "ast": "CompoundStmt",
                            "loc": {
                                "begin": {
                                    "char": 1475,
                                    "col": 22,
                                    "line": 51
                                },
                                "end": {
                                    "char": 2679,
                                    "col": 3,
                                    "line": 86
                                }
                            },
                            "text": "{\n\t\tdest_closing();\n\n\t\t// create the GPU objects:\n\t\tglGenFramebuffers(1, &fbo);\n\t\tglGenRenderbuffers(1, &rbo);\n\t\tglGenTextures(textures.size(), &textures[0]);\n\n\t\t// configure textures:\n\t\t// color buffer\n\t\tconfigureTexture(0, GL_RGBA, GL_RGBA, GL_UNSIGNED_BYTE);\n\t\t// normal buffer\n\t\tconfigureTexture(1, GL_RGB16F, GL_RGB, GL_FLOAT);\n\t\t// position buffer\n\t\tconfigureTexture(2, GL_RGB16F, GL_RGB, GL_FLOAT);\n\t\t\n\t\t// configure RBO:\n\t\tglBindRenderbuffer(GL_RENDERBUFFER, rbo);\n\t\tglRenderbufferStorage(GL_RENDERBUFFER, GL_DEPTH_COMPONENT, dim.x, dim.y);\n\t\t// configure FBO:\n\t\tglBindFramebuffer(GL_FRAMEBUFFER, fbo);\n\t\t// specify RBO:\n\t\tglFramebufferRenderbuffer(GL_FRAMEBUFFER, GL_DEPTH_ATTACHMENT, GL_RENDERBUFFER, rbo);\n\t\t// specify drawbuffers:\n\t\tglDrawBuffers(attachments.size(), &attachments[0]);\n\t\t// specify colour attachments:\n\t\tfor (int i=0; i<textures.size(); i++) {\n\t\t\tglFramebufferTexture2D(GL_FRAMEBUFFER, attachments[i], GL_TEXTURE_2D, textures[i], 0);\n\t\t}\n\t\t// check if framebuffer is complete\n\t\tif (glCheckFramebufferStatus(GL_FRAMEBUFFER) != GL_FRAMEBUFFER_COMPLETE) {\n\t\t\tstd::cout << \"Framebuffer not complete!\" << std::endl;\n\t\t\tdest_closing();\n\t\t}\n\t\tglBindFramebuffer(GL_FRAMEBUFFER, 0);\n\t}"
                        }
                    ],
                    "type": "void ()",
                    "type_args": [],
                    "type_ret": "void"
                },
                {
                    "ast": "CXXMethod",
                    "loc": {
                        "begin": {
                            "char": 2682,
                            "col": 2,
                            "line": 88
                        },
                        "end": {
                            "char": 2940,
                            "col": 3,
                            "line": 102
                        }
                    },
                    "mangled_name": "__ZN7GBuffer12dest_closingEv",
                    "name": "dest_closing",
                    "nodes": [
                        {
                            "ast": "CompoundStmt",
                            "loc": {
                                "begin": {
                                    "char": 2702,
                                    "col": 22,
                                    "line": 88
                                },
                                "end": {
                                    "char": 2940,
                                    "col": 3,
                                    "line": 102
                                }
                            },
                            "text": "{\n\t\t// TODO\n\t\tif (fbo) {\n\t\t\tglDeleteFramebuffers(1, &fbo);\n\t\t\tfbo = 0;\n\t\t}\n\t\tif (rbo) {\n\t\t\tglDeleteRenderbuffers(1, &rbo);\n\t\t\trbo = 0;\n\t\t}\n\t\tif (textures[0]) {\n\t\t\tglDeleteTextures(textures.size(), &textures[0]);\n\t\t\ttextures[0] = 0;\n\t\t}\n\t}"
                        }
                    ],
                    "type": "void ()",
                    "type_args": [],
                    "type_ret": "void"
                },
                {
                    "ast": "CXXMethod",
                    "loc": {
                        "begin": {
                            "char": 2943,
                            "col": 2,
                            "line": 104
                        },
                        "end": {
                            "char": 2999,
                            "col": 58,
                            "line": 104
                        }
                    },
                    "mangled_name": "__ZN7GBuffer5beginEv",
                    "name": "begin",
                    "nodes": [
                        {
                            "ast": "CompoundStmt",
                            "loc": {
                                "begin": {
                                    "char": 2956,
                                    "col": 15,
                                    "line": 104
                                },
                                "end": {
                                    "char": 2999,
                                    "col": 58,
                                    "line": 104
                                }
                            },
                            "text": "{ glBindFramebuffer(GL_FRAMEBUFFER, fbo); }"
                        }
                    ],
                    "type": "void ()",
                    "type_args": [],
                    "type_ret": "void"
                },
                {
                    "ast": "CXXMethod",
                    "loc": {
                        "begin": {
                            "char": 3001,
                            "col": 2,
                            "line": 105
                        },
                        "end": {
                            "char": 3060,
                            "col": 61,
                            "line": 105
                        }
                    },
                    "mangled_name": "__ZN7GBuffer3endEv",
                    "name": "end",
                    "nodes": [
                        {
                            "ast": "CompoundStmt",
                            "loc": {
                                "begin": {
                                    "char": 3019,
                                    "col": 20,
                                    "line": 105
                                },
                                "end": {
                                    "char": 3060,
                                    "col": 61,
                                    "line": 105
                                }
                            },
                            "text": "{ glBindFramebuffer(GL_FRAMEBUFFER, 0); }"
                        }
                    ],
                    "type": "void ()",
                    "type_args": [],
                    "type_ret": "void"
                },
                {
                    "ast": "CXXMethod",
                    "loc": {
                        "begin": {
                            "char": 3063,
                            "col": 2,
                            "line": 107
                        },
                        "end": {
                            "char": 3229,
                            "col": 3,
                            "line": 112
                        }
                    },
                    "mangled_name": "__ZN7GBuffer12bindTexturesEv",
                    "name": "bindTextures",
                    "nodes": [
                        {
                            "ast": "CompoundStmt",
                            "loc": {
                                "begin": {
                                    "char": 3083,
                                    "col": 22,
                                    "line": 107
                                },
                                "end": {
                                    "char": 3229,
                                    "col": 3,
                                    "line": 112
                                }
                            },
                            "text": "{\n\t\tfor (int i=textures.size()-1; i>=0; i--) {\n        \tglActiveTexture(GL_TEXTURE0+i);\n        \tglBindTexture(GL_TEXTURE_2D, textures[i]);\n\t\t}\n\t}"
                        }
                    ],
                    "type": "void ()",
                    "type_args": [],
                    "type_ret": "void"
                },
                {
                    "ast": "CXXMethod",
                    "loc": {
                        "begin": {
                            "char": 3232,
                            "col": 2,
                            "line": 114
                        },
                        "end": {
                            "char": 3396,
                            "col": 3,
                            "line": 119
                        }
                    },
                    "mangled_name": "__ZN7GBuffer14unbindTexturesEv",
                    "name": "unbindTextures",
                    "nodes": [
                        {
                            "ast": "CompoundStmt",
                            "loc": {
                                "begin": {
                                    "char": 3254,
                                    "col": 24,
                                    "line": 114
                                },
                                "end": {
                                    "char": 3396,
                                    "col": 3,
                                    "line": 119
                                }
                            },
                            "text": "{\n        for (int i=textures.size()-1; i>=0; i--) {\n        \tglActiveTexture(GL_TEXTURE0+i);\n        \tglBindTexture(GL_TEXTURE_2D, 0);\n\t\t}\n\t}"
                        }
                    ],
                    "type": "void ()",
                    "type_args": [],
                    "type_ret": "void"
                }
            ],
            "type": "GBuffer"
        },
        {
            "ast": "FunctionDecl",
            "loc": {
                "begin": {
                    "char": 3539,
                    "col": 1,
                    "line": 126
                },
                "end": {
                    "char": 3909,
                    "col": 2,
                    "line": 133
                }
            },
            "mangled_name": "__Z18make_orthogonal_toN3glm5tvec3IfLNS_9precisionE0EEES2_",
            "name": "make_orthogonal_to",
            "nodes": [
                {
                    "ast": "NamespaceRef",
                    "loc": {
                        "begin": {
                            "char": 3539,
                            "col": 1,
                            "line": 126
                        },
                        "end": {
                            "char": 3542,
                            "col": 4,
                            "line": 126
                        }
                    },
                    "name": "glm"
                },
                {
                    "ast": "TypeRef",
                    "loc": {
                        "begin": {
                            "char": 3544,
                            "col": 6,
                            "line": 126
                        },
                        "end": {
                            "char": 3548,
                            "col": 10,
                            "line": 126
                        }
                    },
                    "name": "glm::vec3",
                    "type": "glm::vec3"
                },
                {
                    "ast": "ParmDecl",
                    "loc": {
                        "begin": {
                            "char": 3568,
                            "col": 30,
                            "line": 126
                        },
                        "end": {
                            "char": 3585,
                            "col": 47,
                            "line": 126
                        }
                    },
                    "name": "v",
                    "nodes": [
                        {
                            "ast": "NamespaceRef",
                            "loc": {
                                "begin": {
                                    "char": 3568,
                                    "col": 30,
                                    "line": 126
                                },
                                "end": {
                                    "char": 3571,
                                    "col": 33,
                                    "line": 126
                                }
                            },
                            "name": "glm"
                        },
                        {
                            "ast": "TypeRef",
                            "loc": {
                                "begin": {
                                    "char": 3573,
                                    "col": 35,
                                    "line": 126
                                },
                                "end": {
                                    "char": 3577,
                                    "col": 39,
                                    "line": 126
                                }
                            },
                            "name": "glm::vec3",
                            "type": "glm::vec3"
                        }
                    ],
                    "type": "const glm::vec3"
                },
                {
                    "ast": "ParmDecl",
                    "loc": {
                        "begin": {
                            "char": 3587,
                            "col": 49,
                            "line": 126
                        },
                        "end": {
                            "char": 3609,
                            "col": 71,
                            "line": 126
                        }
                    },
                    "name": "normal",
                    "nodes": [
                        {
                            "ast": "NamespaceRef",
                            "loc": {
                                "begin": {
                                    "char": 3587,
                                    "col": 49,
                                    "line": 126
                                },
                                "end": {
                                    "char": 3590,
                                    "col": 52,
                                    "line": 126
                                }
                            },
                            "name": "glm"
                        },
                        {
                            "ast": "TypeRef",
                            "loc": {
                                "begin": {
                                    "char": 3592,
                                    "col": 54,
                                    "line": 126
                                },
                                "end": {
                                    "char": 3596,
                                    "col": 58,
                                    "line": 126
                                }
                            },
                            "name": "glm::vec3",
                            "type": "glm::vec3"
                        }
                    ],
                    "type": "const glm::vec3"
                },
                {
                    "ast": "CompoundStmt",
                    "loc": {
                        "begin": {
                            "char": 3611,
                            "col": 73,
                            "line": 126
                        },
                        "end": {
                            "char": 3909,
                            "col": 2,
                            "line": 133
                        }
                    },
                    "text": "{\n\t// get component of v along normal:\n\tglm::vec3 normal_component = normal * (dot(v, normal));\n\t// remove this component from v:\n\tglm::vec3 without_normal_component = v - normal_component;\n\t// and re-scale to original magnitude:\n\treturn safe_normalize(without_normal_component) * glm::length(v);\n}"
                }
            ],
            "type": "glm::vec3 (const glm::vec3, const glm::vec3)",
            "type_args": [
                "const glm::vec3",
                "const glm::vec3"
            ],
            "type_ret": "glm::vec3"
        },
        {
            "ast": "FunctionDecl",
            "loc": {
                "begin": {
                    "char": 4078,
                    "col": 1,
                    "line": 138
                },
                "end": {
                    "char": 4657,
                    "col": 2,
                    "line": 152
                }
            },
            "mangled_name": "__Z11align_up_toN3glm5tquatIfLNS_9precisionE0EEENS_5tvec3IfLS1_0EEE",
            "name": "align_up_to",
            "nodes": [
                {
                    "ast": "NamespaceRef",
                    "loc": {
                        "begin": {
                            "char": 4078,
                            "col": 1,
                            "line": 138
                        },
                        "end": {
                            "char": 4081,
                            "col": 4,
                            "line": 138
                        }
                    },
                    "name": "glm"
                },
                {
                    "ast": "TypeRef",
                    "loc": {
                        "begin": {
                            "char": 4083,
                            "col": 6,
                            "line": 138
                        },
                        "end": {
                            "char": 4087,
                            "col": 10,
                            "line": 138
                        }
                    },
                    "name": "glm::quat",
                    "type": "glm::quat"
                },
                {
                    "ast": "ParmDecl",
                    "loc": {
                        "begin": {
                            "char": 4100,
                            "col": 23,
                            "line": 138
                        },
                        "end": {
                            "char": 4117,
                            "col": 40,
                            "line": 138
                        }
                    },
                    "name": "q",
                    "nodes": [
                        {
                            "ast": "NamespaceRef",
                            "loc": {
                                "begin": {
                                    "char": 4100,
                                    "col": 23,
                                    "line": 138
                                },
                                "end": {
                                    "char": 4103,
                                    "col": 26,
                                    "line": 138
                                }
                            },
                            "name": "glm"
                        },
                        {
                            "ast": "TypeRef",
                            "loc": {
                                "begin": {
                                    "char": 4105,
                                    "col": 28,
                                    "line": 138
                                },
                                "end": {
                                    "char": 4109,
                                    "col": 32,
                                    "line": 138
                                }
                            },
                            "name": "glm::quat",
                            "type": "glm::quat"
                        }
                    ],
                    "type": "const glm::quat"
                },
                {
                    "ast": "ParmDecl",
                    "loc": {
                        "begin": {
                            "char": 4119,
                            "col": 42,
                            "line": 138
                        },
                        "end": {
                            "char": 4141,
                            "col": 64,
                            "line": 138
                        }
                    },
                    "name": "normal",
                    "nodes": [
                        {
                            "ast": "NamespaceRef",
                            "loc": {
                                "begin": {
                                    "char": 4119,
                                    "col": 42,
                                    "line": 138
                                },
                                "end": {
                                    "char": 4122,
                                    "col": 45,
                                    "line": 138
                                }
                            },
                            "name": "glm"
                        },
                        {
                            "ast": "TypeRef",
                            "loc": {
                                "begin": {
                                    "char": 4124,
                                    "col": 47,
                                    "line": 138
                                },
                                "end": {
                                    "char": 4128,
                                    "col": 51,
                                    "line": 138
                                }
                            },
                            "name": "glm::vec3",
                            "type": "glm::vec3"
                        }
                    ],
                    "type": "const glm::vec3"
                },
                {
                    "ast": "CompoundStmt",
                    "loc": {
                        "begin": {
                            "char": 4143,
                            "col": 66,
                            "line": 138
                        },
                        "end": {
                            "char": 4657,
                            "col": 2,
                            "line": 152
                        }
                    },
                    "text": "{\n\tconst float eps = 0.00001f;\n\t// get q's up vector:\n\tglm::vec3 uy = quat_uy(q);\n\t// get similarity with normal:\n\tfloat dp = glm::dot(uy, normal);\n\t// if `direction` is already similar to `dir`, leave as-is\n\tif (fabsf(dp) < eps) return q; \n\t// find an orthogonal axis to rotate around:\n\tglm::vec3 axis = glm::cross(uy, normal);\n\t// get the rotation needed around this axis:\n\tglm::quat diff = glm::angleAxis(acosf(dp), axis);\n\t// rotate the original quat to align to the normal:\n\treturn safe_normalize(diff * q);\n}"
                }
            ],
            "type": "glm::quat (const glm::quat, const glm::vec3)",
            "type_args": [
                "const glm::quat",
                "const glm::vec3"
            ],
            "type_ret": "glm::quat"
        },
        {
            "ast": "FunctionDecl",
            "loc": {
                "begin": {
                    "char": 4778,
                    "col": 1,
                    "line": 156
                },
                "end": {
                    "char": 5554,
                    "col": 2,
                    "line": 173
                }
            },
            "mangled_name": "__Z16align_forward_toN3glm5tquatIfLNS_9precisionE0EEENS_5tvec3IfLS1_0EEE",
            "name": "align_forward_to",
            "nodes": [
                {
                    "ast": "NamespaceRef",
                    "loc": {
                        "begin": {
                            "char": 4778,
                            "col": 1,
                            "line": 156
                        },
                        "end": {
                            "char": 4781,
                            "col": 4,
                            "line": 156
                        }
                    },
                    "name": "glm"
                },
                {
                    "ast": "TypeRef",
                    "loc": {
                        "begin": {
                            "char": 4783,
                            "col": 6,
                            "line": 156
                        },
                        "end": {
                            "char": 4787,
                            "col": 10,
                            "line": 156
                        }
                    },
                    "name": "glm::quat",
                    "type": "glm::quat"
                },
                {
                    "ast": "ParmDecl",
                    "loc": {
                        "begin": {
                            "char": 4805,
                            "col": 28,
                            "line": 156
                        },
                        "end": {
                            "char": 4822,
                            "col": 45,
                            "line": 156
                        }
                    },
                    "name": "q",
                    "nodes": [
                        {
                            "ast": "NamespaceRef",
                            "loc": {
                                "begin": {
                                    "char": 4805,
                                    "col": 28,
                                    "line": 156
                                },
                                "end": {
                                    "char": 4808,
                                    "col": 31,
                                    "line": 156
                                }
                            },
                            "name": "glm"
                        },
                        {
                            "ast": "TypeRef",
                            "loc": {
                                "begin": {
                                    "char": 4810,
                                    "col": 33,
                                    "line": 156
                                },
                                "end": {
                                    "char": 4814,
                                    "col": 37,
                                    "line": 156
                                }
                            },
                            "name": "glm::quat",
                            "type": "glm::quat"
                        }
                    ],
                    "type": "const glm::quat"
                },
                {
                    "ast": "ParmDecl",
                    "loc": {
                        "begin": {
                            "char": 4824,
                            "col": 47,
                            "line": 156
                        },
                        "end": {
                            "char": 4849,
                            "col": 72,
                            "line": 156
                        }
                    },
                    "name": "direction",
                    "nodes": [
                        {
                            "ast": "NamespaceRef",
                            "loc": {
                                "begin": {
                                    "char": 4824,
                                    "col": 47,
                                    "line": 156
                                },
                                "end": {
                                    "char": 4827,
                                    "col": 50,
                                    "line": 156
                                }
                            },
                            "name": "glm"
                        },
                        {
                            "ast": "TypeRef",
                            "loc": {
                                "begin": {
                                    "char": 4829,
                                    "col": 52,
                                    "line": 156
                                },
                                "end": {
                                    "char": 4833,
                                    "col": 56,
                                    "line": 156
                                }
                            },
                            "name": "glm::vec3",
                            "type": "glm::vec3"
                        }
                    ],
                    "type": "const glm::vec3"
                },
                {
                    "ast": "CompoundStmt",
                    "loc": {
                        "begin": {
                            "char": 4851,
                            "col": 74,
                            "line": 156
                        },
                        "end": {
                            "char": 5554,
                            "col": 2,
                            "line": 173
                        }
                    },
                    "text": "{\n\tconst float eps = 0.00001f;\n\tfloat d = glm::length(direction);\n\t// if `direction` is too small, any direction is as good as any other... no change needed\n\tif (fabsf(d) < eps) return q; \n\t// get similarity with direction:\n\tglm::vec3 desired = safe_normalize(direction);\n\tglm::vec3 uf = quat_uf(q);\n\tfloat dp = glm::dot(uf, desired); \n\t// if `direction` is already similar to `dir`, leave as-is\n\tif (fabsf(dp) < eps) return q; \n\t// get an orthogonal axis to rotate around:\n\tglm::vec3 axis = glm::cross(uf, desired);\n\t// get the rotation needed around this axis:\n\tglm::quat diff = glm::angleAxis(acosf(dp), axis);\n\t// rotate the original quat to align to the normal:\n\treturn safe_normalize(diff * q);\t\n}"
                }
            ],
            "type": "glm::quat (const glm::quat, const glm::vec3)",
            "type_args": [
                "const glm::quat",
                "const glm::vec3"
            ],
            "type_ret": "glm::quat"
        },
        {
            "ast": "FunctionDecl",
            "loc": {
                "begin": {
                    "char": 5579,
                    "col": 1,
                    "line": 176
                },
                "end": {
                    "char": 5705,
                    "col": 2,
                    "line": 182
                }
            },
            "mangled_name": "__Z5limitN3glm5tvec2IfLNS_9precisionE0EEEf",
            "name": "limit",
            "nodes": [
                {
                    "ast": "NamespaceRef",
                    "loc": {
                        "begin": {
                            "char": 5579,
                            "col": 1,
                            "line": 176
                        },
                        "end": {
                            "char": 5582,
                            "col": 4,
                            "line": 176
                        }
                    },
                    "name": "glm"
                },
                {
                    "ast": "TypeRef",
                    "loc": {
                        "begin": {
                            "char": 5584,
                            "col": 6,
                            "line": 176
                        },
                        "end": {
                            "char": 5588,
                            "col": 10,
                            "line": 176
                        }
                    },
                    "name": "glm::vec2",
                    "type": "glm::vec2"
                },
                {
                    "ast": "ParmDecl",
                    "loc": {
                        "begin": {
                            "char": 5595,
                            "col": 17,
                            "line": 176
                        },
                        "end": {
                            "char": 5606,
                            "col": 28,
                            "line": 176
                        }
                    },
                    "name": "v",
                    "nodes": [
                        {
                            "ast": "NamespaceRef",
                            "loc": {
                                "begin": {
                                    "char": 5595,
                                    "col": 17,
                                    "line": 176
                                },
                                "end": {
                                    "char": 5598,
                                    "col": 20,
                                    "line": 176
                                }
                            },
                            "name": "glm"
                        },
                        {
                            "ast": "TypeRef",
                            "loc": {
                                "begin": {
                                    "char": 5600,
                                    "col": 22,
                                    "line": 176
                                },
                                "end": {
                                    "char": 5604,
                                    "col": 26,
                                    "line": 176
                                }
                            },
                            "name": "glm::vec2",
                            "type": "glm::vec2"
                        }
                    ],
                    "type": "glm::vec2"
                },
                {
                    "ast": "ParmDecl",
                    "loc": {
                        "begin": {
                            "char": 5608,
                            "col": 30,
                            "line": 176
                        },
                        "end": {
                            "char": 5617,
                            "col": 39,
                            "line": 176
                        }
                    },
                    "name": "max",
                    "type": "float"
                },
                {
                    "ast": "CompoundStmt",
                    "loc": {
                        "begin": {
                            "char": 5619,
                            "col": 41,
                            "line": 176
                        },
                        "end": {
                            "char": 5705,
                            "col": 2,
                            "line": 182
                        }
                    },
                    "text": "{\n\tfloat len = glm::length(v);\n\tif (len > max) {\n\t\treturn v * max/len;\n\t}\n\treturn v;\n}"
                }
            ],
            "type": "glm::vec2 (glm::vec2, float)",
            "type_args": [
                "glm::vec2",
                "float"
            ],
            "type_ret": "glm::vec2"
        },
        {
            "ast": "VarDecl",
            "loc": {
                "begin": {
                    "char": 5707,
                    "col": 1,
                    "line": 184
                },
                "end": {
                    "char": 5726,
                    "col": 20,
                    "line": 184
                }
            },
            "name": "flip",
            "nodes": [
                {
                    "ast": "IntegerLiteral",
                    "loc": {
                        "begin": {
                            "char": 5725,
                            "col": 19,
                            "line": 184
                        },
                        "end": {
                            "char": 5726,
                            "col": 20,
                            "line": 184
                        }
                    },
                    "type": "int",
                    "value": 0
                }
            ],
            "type": "int"
        },
        {
            "ast": "VarDecl",
            "loc": {
                "begin": {
                    "char": 5729,
                    "col": 1,
                    "line": 186
                },
                "end": {
                    "char": 5748,
                    "col": 20,
                    "line": 186
                }
            },
            "name": "objectShader",
            "nodes": [
                {
                    "ast": "TypeRef",
                    "loc": {
                        "begin": {
                            "char": 5729,
                            "col": 1,
                            "line": 186
                        },
                        "end": {
                            "char": 5735,
                            "col": 7,
                            "line": 186
                        }
                    },
                    "name": "struct Shader",
                    "type": "Shader"
                },
                {
                    "ast": "CallExpr",
                    "loc": {
                        "begin": {
                            "char": 5736,
                            "col": 8,
                            "line": 186
                        },
                        "end": {
                            "char": 5748,
                            "col": 20,
                            "line": 186
                        }
                    },
                    "name": "Shader",
                    "type": "Shader"
                }
            ],
            "type": "Shader"
        },
        {
            "ast": "VarDecl",
            "loc": {
                "begin": {
                    "char": 5750,
                    "col": 1,
                    "line": 187
                },
                "end": {
                    "char": 5770,
                    "col": 21,
                    "line": 187
                }
            },
            "name": "segmentShader",
            "nodes": [
                {
                    "ast": "TypeRef",
                    "loc": {
                        "begin": {
                            "char": 5750,
                            "col": 1,
                            "line": 187
                        },
                        "end": {
                            "char": 5756,
                            "col": 7,
                            "line": 187
                        }
                    },
                    "name": "struct Shader",
                    "type": "Shader"
                },
                {
                    "ast": "CallExpr",
                    "loc": {
                        "begin": {
                            "char": 5757,
                            "col": 8,
                            "line": 187
                        },
                        "end": {
                            "char": 5770,
                            "col": 21,
                            "line": 187
                        }
                    },
                    "name": "Shader",
                    "type": "Shader"
                }
            ],
            "type": "Shader"
        },
        {
            "ast": "VarDecl",
            "loc": {
                "begin": {
                    "char": 5772,
                    "col": 1,
                    "line": 188
                },
                "end": {
                    "char": 5793,
                    "col": 22,
                    "line": 188
                }
            },
            "name": "particleShader",
            "nodes": [
                {
                    "ast": "TypeRef",
                    "loc": {
                        "begin": {
                            "char": 5772,
                            "col": 1,
                            "line": 188
                        },
                        "end": {
                            "char": 5778,
                            "col": 7,
                            "line": 188
                        }
                    },
                    "name": "struct Shader",
                    "type": "Shader"
                },
                {
                    "ast": "CallExpr",
                    "loc": {
                        "begin": {
                            "char": 5779,
                            "col": 8,
                            "line": 188
                        },
                        "end": {
                            "char": 5793,
                            "col": 22,
                            "line": 188
                        }
                    },
                    "name": "Shader",
                    "type": "Shader"
                }
            ],
            "type": "Shader"
        },
        {
            "ast": "VarDecl",
            "loc": {
                "begin": {
                    "char": 5795,
                    "col": 1,
                    "line": 189
                },
                "end": {
                    "char": 5812,
                    "col": 18,
                    "line": 189
                }
            },
            "name": "landShader",
            "nodes": [
                {
                    "ast": "TypeRef",
                    "loc": {
                        "begin": {
                            "char": 5795,
                            "col": 1,
                            "line": 189
                        },
                        "end": {
                            "char": 5801,
                            "col": 7,
                            "line": 189
                        }
                    },
                    "name": "struct Shader",
                    "type": "Shader"
                },
                {
                    "ast": "CallExpr",
                    "loc": {
                        "begin": {
                            "char": 5802,
                            "col": 8,
                            "line": 189
                        },
                        "end": {
                            "char": 5812,
                            "col": 18,
                            "line": 189
                        }
                    },
                    "name": "Shader",
                    "type": "Shader"
                }
            ],
            "type": "Shader"
        },
        {
            "ast": "VarDecl",
            "loc": {
                "begin": {
                    "char": 5814,
                    "col": 1,
                    "line": 190
                },
                "end": {
                    "char": 5837,
                    "col": 24,
                    "line": 190
                }
            },
            "name": "heightMeshShader",
            "nodes": [
                {
                    "ast": "TypeRef",
                    "loc": {
                        "begin": {
                            "char": 5814,
                            "col": 1,
                            "line": 190
                        },
                        "end": {
                            "char": 5820,
                            "col": 7,
                            "line": 190
                        }
                    },
                    "name": "struct Shader",
                    "type": "Shader"
                },
                {
                    "ast": "CallExpr",
                    "loc": {
                        "begin": {
                            "char": 5821,
                            "col": 8,
                            "line": 190
                        },
                        "end": {
                            "char": 5837,
                            "col": 24,
                            "line": 190
                        }
                    },
                    "name": "Shader",
                    "type": "Shader"
                }
            ],
            "type": "Shader"
        },
        {
            "ast": "VarDecl",
            "loc": {
                "begin": {
                    "char": 5839,
                    "col": 1,
                    "line": 191
                },
                "end": {
                    "char": 5857,
                    "col": 19,
                    "line": 191
                }
            },
            "name": "deferShader",
            "nodes": [
                {
                    "ast": "TypeRef",
                    "loc": {
                        "begin": {
                            "char": 5839,
                            "col": 1,
                            "line": 191
                        },
                        "end": {
                            "char": 5845,
                            "col": 7,
                            "line": 191
                        }
                    },
                    "name": "struct Shader",
                    "type": "Shader"
                },
                {
                    "ast": "CallExpr",
                    "loc": {
                        "begin": {
                            "char": 5846,
                            "col": 8,
                            "line": 191
                        },
                        "end": {
                            "char": 5857,
                            "col": 19,
                            "line": 191
                        }
                    },
                    "name": "Shader",
                    "type": "Shader"
                }
            ],
            "type": "Shader"
        },
        {
            "ast": "VarDecl",
            "loc": {
                "begin": {
                    "char": 5860,
                    "col": 1,
                    "line": 192
                },
                "end": {
                    "char": 5879,
                    "col": 20,
                    "line": 192
                }
            },
            "name": "simpleShader",
            "nodes": [
                {
                    "ast": "TypeRef",
                    "loc": {
                        "begin": {
                            "char": 5860,
                            "col": 1,
                            "line": 192
                        },
                        "end": {
                            "char": 5866,
                            "col": 7,
                            "line": 192
                        }
                    },
                    "name": "struct Shader",
                    "type": "Shader"
                },
                {
                    "ast": "CallExpr",
                    "loc": {
                        "begin": {
                            "char": 5867,
                            "col": 8,
                            "line": 192
                        },
                        "end": {
                            "char": 5879,
                            "col": 20,
                            "line": 192
                        }
                    },
                    "name": "Shader",
                    "type": "Shader"
                }
            ],
            "type": "Shader"
        },
        {
            "ast": "VarDecl",
            "loc": {
                "begin": {
                    "char": 5881,
                    "col": 1,
                    "line": 193
                },
                "end": {
                    "char": 5899,
                    "col": 19,
                    "line": 193
                }
            },
            "name": "debugShader",
            "nodes": [
                {
                    "ast": "TypeRef",
                    "loc": {
                        "begin": {
                            "char": 5881,
                            "col": 1,
                            "line": 193
                        },
                        "end": {
                            "char": 5887,
                            "col": 7,
                            "line": 193
                        }
                    },
                    "name": "struct Shader",
                    "type": "Shader"
                },
                {
                    "ast": "CallExpr",
                    "loc": {
                        "begin": {
                            "char": 5888,
                            "col": 8,
                            "line": 193
                        },
                        "end": {
                            "char": 5899,
                            "col": 19,
                            "line": 193
                        }
                    },
                    "name": "Shader",
                    "type": "Shader"
                }
            ],
            "type": "Shader"
        },
        {
            "ast": "VarDecl",
            "loc": {
                "begin": {
                    "char": 5902,
                    "col": 1,
                    "line": 195
                },
                "end": {
                    "char": 5919,
                    "col": 18,
                    "line": 195
                }
            },
            "name": "quadMesh",
            "nodes": [
                {
                    "ast": "TypeRef",
                    "loc": {
                        "begin": {
                            "char": 5902,
                            "col": 1,
                            "line": 195
                        },
                        "end": {
                            "char": 5910,
                            "col": 9,
                            "line": 195
                        }
                    },
                    "name": "struct QuadMesh",
                    "type": "QuadMesh"
                },
                {
                    "ast": "CallExpr",
                    "loc": {
                        "begin": {
                            "char": 5911,
                            "col": 10,
                            "line": 195
                        },
                        "end": {
                            "char": 5919,
                            "col": 18,
                            "line": 195
                        }
                    },
                    "name": "QuadMesh",
                    "type": "QuadMesh"
                }
            ],
            "type": "QuadMesh"
        },
        {
            "ast": "VarDecl",
            "loc": {
                "begin": {
                    "char": 5921,
                    "col": 1,
                    "line": 196
                },
                "end": {
                    "char": 5936,
                    "col": 16,
                    "line": 196
                }
            },
            "name": "colorTex",
            "nodes": [
                {
                    "ast": "TypeRef",
                    "loc": {
                        "begin": {
                            "char": 5921,
                            "col": 1,
                            "line": 196
                        },
                        "end": {
                            "char": 5927,
                            "col": 7,
                            "line": 196
                        }
                    },
                    "name": "GLuint",
                    "type": "GLuint"
                }
            ],
            "type": "GLuint"
        },
        {
            "ast": "VarDecl",
            "loc": {
                "begin": {
                    "char": 5938,
                    "col": 1,
                    "line": 197
                },
                "end": {
                    "char": 5961,
                    "col": 24,
                    "line": 197
                }
            },
            "name": "fluidTex",
            "nodes": [
                {
                    "ast": "TypeRef",
                    "loc": {
                        "begin": {
                            "char": 5938,
                            "col": 1,
                            "line": 197
                        },
                        "end": {
                            "char": 5952,
                            "col": 15,
                            "line": 197
                        }
                    },
                    "name": "struct FloatTexture3D",
                    "type": "FloatTexture3D"
                },
                {
                    "ast": "CallExpr",
                    "loc": {
                        "begin": {
                            "char": 5953,
                            "col": 16,
                            "line": 197
                        },
                        "end": {
                            "char": 5961,
                            "col": 24,
                            "line": 197
                        }
                    },
                    "name": "FloatTexture3D",
                    "type": "FloatTexture3D"
                }
            ],
            "type": "FloatTexture3D"
        },
        {
            "ast": "VarDecl",
            "loc": {
                "begin": {
                    "char": 5963,
                    "col": 1,
                    "line": 198
                },
                "end": {
                    "char": 5988,
                    "col": 26,
                    "line": 198
                }
            },
            "name": "densityTex",
            "nodes": [
                {
                    "ast": "TypeRef",
                    "loc": {
                        "begin": {
                            "char": 5963,
                            "col": 1,
                            "line": 198
                        },
                        "end": {
                            "char": 5977,
                            "col": 15,
                            "line": 198
                        }
                    },
                    "name": "struct FloatTexture3D",
                    "type": "FloatTexture3D"
                },
                {
                    "ast": "CallExpr",
                    "loc": {
                        "begin": {
                            "char": 5978,
                            "col": 16,
                            "line": 198
                        },
                        "end": {
                            "char": 5988,
                            "col": 26,
                            "line": 198
                        }
                    },
                    "name": "FloatTexture3D",
                    "type": "FloatTexture3D"
                }
            ],
            "type": "FloatTexture3D"
        },
        {
            "ast": "VarDecl",
            "loc": {
                "begin": {
                    "char": 5990,
                    "col": 1,
                    "line": 199
                },
                "end": {
                    "char": 6016,
                    "col": 27,
                    "line": 199
                }
            },
            "name": "distanceTex",
            "nodes": [
                {
                    "ast": "TypeRef",
                    "loc": {
                        "begin": {
                            "char": 5990,
                            "col": 1,
                            "line": 199
                        },
                        "end": {
                            "char": 6004,
                            "col": 15,
                            "line": 199
                        }
                    },
                    "name": "struct FloatTexture3D",
                    "type": "FloatTexture3D"
                },
                {
                    "ast": "CallExpr",
                    "loc": {
                        "begin": {
                            "char": 6005,
                            "col": 16,
                            "line": 199
                        },
                        "end": {
                            "char": 6016,
                            "col": 27,
                            "line": 199
                        }
                    },
                    "name": "FloatTexture3D",
                    "type": "FloatTexture3D"
                }
            ],
            "type": "FloatTexture3D"
        },
        {
            "ast": "VarDecl",
            "loc": {
                "begin": {
                    "char": 6018,
                    "col": 1,
                    "line": 200
                },
                "end": {
                    "char": 6042,
                    "col": 25,
                    "line": 200
                }
            },
            "name": "fungusTex",
            "nodes": [
                {
                    "ast": "TypeRef",
                    "loc": {
                        "begin": {
                            "char": 6018,
                            "col": 1,
                            "line": 200
                        },
                        "end": {
                            "char": 6032,
                            "col": 15,
                            "line": 200
                        }
                    },
                    "name": "struct FloatTexture2D",
                    "type": "FloatTexture2D"
                },
                {
                    "ast": "CallExpr",
                    "loc": {
                        "begin": {
                            "char": 6033,
                            "col": 16,
                            "line": 200
                        },
                        "end": {
                            "char": 6042,
                            "col": 25,
                            "line": 200
                        }
                    },
                    "name": "FloatTexture2D",
                    "type": "FloatTexture2D"
                }
            ],
            "type": "FloatTexture2D"
        },
        {
            "ast": "VarDecl",
            "loc": {
                "begin": {
                    "char": 6044,
                    "col": 1,
                    "line": 201
                },
                "end": {
                    "char": 6066,
                    "col": 23,
                    "line": 201
                }
            },
            "name": "landTex",
            "nodes": [
                {
                    "ast": "TypeRef",
                    "loc": {
                        "begin": {
                            "char": 6044,
                            "col": 1,
                            "line": 201
                        },
                        "end": {
                            "char": 6058,
                            "col": 15,
                            "line": 201
                        }
                    },
                    "name": "struct FloatTexture2D",
                    "type": "FloatTexture2D"
                },
                {
                    "ast": "CallExpr",
                    "loc": {
                        "begin": {
                            "char": 6059,
                            "col": 16,
                            "line": 201
                        },
                        "end": {
                            "char": 6066,
                            "col": 23,
                            "line": 201
                        }
                    },
                    "name": "FloatTexture2D",
                    "type": "FloatTexture2D"
                }
            ],
            "type": "FloatTexture2D"
        },
        {
            "ast": "VarDecl",
            "loc": {
                "begin": {
                    "char": 6069,
                    "col": 1,
                    "line": 203
                },
                "end": {
                    "char": 6087,
                    "col": 19,
                    "line": 203
                }
            },
            "name": "tableObj",
            "nodes": [
                {
                    "ast": "TypeRef",
                    "loc": {
                        "begin": {
                            "char": 6069,
                            "col": 1,
                            "line": 203
                        },
                        "end": {
                            "char": 6078,
                            "col": 10,
                            "line": 203
                        }
                    },
                    "name": "struct SimpleOBJ",
                    "type": "SimpleOBJ"
                }
            ],
            "type": "SimpleOBJ"
        },
        {
            "ast": "VarDecl",
            "loc": {
                "begin": {
                    "char": 6115,
                    "col": 1,
                    "line": 205
                },
                "end": {
                    "char": 6147,
                    "col": 33,
                    "line": 205
                }
            },
            "name": "gridVertices",
            "type": "int"
        },
        {
            "ast": "VarDecl",
            "loc": {
                "begin": {
                    "char": 6149,
                    "col": 1,
                    "line": 206
                },
                "end": {
                    "char": 6187,
                    "col": 39,
                    "line": 206
                }
            },
            "name": "gridElements",
            "type": "int"
        },
        {
            "ast": "VarDecl",
            "loc": {
                "begin": {
                    "char": 6190,
                    "col": 1,
                    "line": 208
                },
                "end": {
                    "char": 6211,
                    "col": 22,
                    "line": 208
                }
            },
            "name": "projFBOs",
            "nodes": [
                {
                    "ast": "TypeRef",
                    "loc": {
                        "begin": {
                            "char": 6190,
                            "col": 1,
                            "line": 208
                        },
                        "end": {
                            "char": 6199,
                            "col": 10,
                            "line": 208
                        }
                    },
                    "name": "struct SimpleFBO",
                    "type": "SimpleFBO"
                },
                {
                    "ast": "IntegerLiteral",
                    "loc": {
                        "begin": {
                            "char": 6209,
                            "col": 20,
                            "line": 208
                        },
                        "end": {
                            "char": 6210,
                            "col": 21,
                            "line": 208
                        }
                    },
                    "type": "int"
                },
                {
                    "ast": "CallExpr",
                    "loc": {
                        "begin": {
                            "char": 6200,
                            "col": 11,
                            "line": 208
                        },
                        "end": {
                            "char": 6208,
                            "col": 19,
                            "line": 208
                        }
                    },
                    "name": "SimpleFBO",
                    "type": "SimpleFBO [2]"
                }
            ],
            "type": "SimpleFBO [2]"
        },
        {
            "ast": "VarDecl",
            "loc": {
                "begin": {
                    "char": 6214,
                    "col": 1,
                    "line": 210
                },
                "end": {
                    "char": 6225,
                    "col": 12,
                    "line": 210
                }
            },
            "name": "gridVAO",
            "nodes": [
                {
                    "ast": "TypeRef",
                    "loc": {
                        "begin": {
                            "char": 6214,
                            "col": 1,
                            "line": 210
                        },
                        "end": {
                            "char": 6217,
                            "col": 4,
                            "line": 210
                        }
                    },
                    "name": "struct VAO",
                    "type": "VAO"
                },
                {
                    "ast": "CallExpr",
                    "loc": {
                        "begin": {
                            "char": 6218,
                            "col": 5,
                            "line": 210
                        },
                        "end": {
                            "char": 6225,
                            "col": 12,
                            "line": 210
                        }
                    },
                    "name": "VAO",
                    "type": "VAO"
                }
            ],
            "type": "VAO"
        },
        {
            "ast": "VarDecl",
            "loc": {
                "begin": {
                    "char": 6227,
                    "col": 1,
                    "line": 211
                },
                "end": {
                    "char": 6238,
                    "col": 12,
                    "line": 211
                }
            },
            "name": "gridVBO",
            "nodes": [
                {
                    "ast": "TypeRef",
                    "loc": {
                        "begin": {
                            "char": 6227,
                            "col": 1,
                            "line": 211
                        },
                        "end": {
                            "char": 6230,
                            "col": 4,
                            "line": 211
                        }
                    },
                    "name": "struct VBO",
                    "type": "VBO"
                },
                {
                    "ast": "CallExpr",
                    "loc": {
                        "begin": {
                            "char": 6231,
                            "col": 5,
                            "line": 211
                        },
                        "end": {
                            "char": 6238,
                            "col": 12,
                            "line": 211
                        }
                    },
                    "name": "VBO",
                    "type": "VBO"
                }
            ],
            "type": "VBO"
        },
        {
            "ast": "VarDecl",
            "loc": {
                "begin": {
                    "char": 6240,
                    "col": 1,
                    "line": 212
                },
                "end": {
                    "char": 6251,
                    "col": 12,
                    "line": 212
                }
            },
            "name": "gridEBO",
            "nodes": [
                {
                    "ast": "TypeRef",
                    "loc": {
                        "begin": {
                            "char": 6240,
                            "col": 1,
                            "line": 212
                        },
                        "end": {
                            "char": 6243,
                            "col": 4,
                            "line": 212
                        }
                    },
                    "name": "struct EBO",
                    "type": "EBO"
                },
                {
                    "ast": "CallExpr",
                    "loc": {
                        "begin": {
                            "char": 6244,
                            "col": 5,
                            "line": 212
                        },
                        "end": {
                            "char": 6251,
                            "col": 12,
                            "line": 212
                        }
                    },
                    "name": "EBO",
                    "type": "EBO"
                }
            ],
            "type": "EBO"
        },
        {
            "ast": "VarDecl",
            "loc": {
                "begin": {
                    "char": 6253,
                    "col": 1,
                    "line": 213
                },
                "end": {
                    "char": 6279,
                    "col": 27,
                    "line": 213
                }
            },
            "name": "grid_elements",
            "type": "unsigned int"
        },
        {
            "ast": "VarDecl",
            "loc": {
                "begin": {
                    "char": 6282,
                    "col": 1,
                    "line": 215
                },
                "end": {
                    "char": 6294,
                    "col": 13,
                    "line": 215
                }
            },
            "name": "tableVAO",
            "nodes": [
                {
                    "ast": "TypeRef",
                    "loc": {
                        "begin": {
                            "char": 6282,
                            "col": 1,
                            "line": 215
                        },
                        "end": {
                            "char": 6285,
                            "col": 4,
                            "line": 215
                        }
                    },
                    "name": "struct VAO",
                    "type": "VAO"
                },
                {
                    "ast": "CallExpr",
                    "loc": {
                        "begin": {
                            "char": 6286,
                            "col": 5,
                            "line": 215
                        },
                        "end": {
                            "char": 6294,
                            "col": 13,
                            "line": 215
                        }
                    },
                    "name": "VAO",
                    "type": "VAO"
                }
            ],
            "type": "VAO"
        },
        {
            "ast": "VarDecl",
            "loc": {
                "begin": {
                    "char": 6296,
                    "col": 1,
                    "line": 216
                },
                "end": {
                    "char": 6308,
                    "col": 13,
                    "line": 216
                }
            },
            "name": "tableVBO",
            "nodes": [
                {
                    "ast": "TypeRef",
                    "loc": {
                        "begin": {
                            "char": 6296,
                            "col": 1,
                            "line": 216
                        },
                        "end": {
                            "char": 6299,
                            "col": 4,
                            "line": 216
                        }
                    },
                    "name": "struct VBO",
                    "type": "VBO"
                },
                {
                    "ast": "CallExpr",
                    "loc": {
                        "begin": {
                            "char": 6300,
                            "col": 5,
                            "line": 216
                        },
                        "end": {
                            "char": 6308,
                            "col": 13,
                            "line": 216
                        }
                    },
                    "name": "VBO",
                    "type": "VBO"
                }
            ],
            "type": "VBO"
        },
        {
            "ast": "VarDecl",
            "loc": {
                "begin": {
                    "char": 6310,
                    "col": 1,
                    "line": 217
                },
                "end": {
                    "char": 6322,
                    "col": 13,
                    "line": 217
                }
            },
            "name": "tableEBO",
            "nodes": [
                {
                    "ast": "TypeRef",
                    "loc": {
                        "begin": {
                            "char": 6310,
                            "col": 1,
                            "line": 217
                        },
                        "end": {
                            "char": 6313,
                            "col": 4,
                            "line": 217
                        }
                    },
                    "name": "struct EBO",
                    "type": "EBO"
                },
                {
                    "ast": "CallExpr",
                    "loc": {
                        "begin": {
                            "char": 6314,
                            "col": 5,
                            "line": 217
                        },
                        "end": {
                            "char": 6322,
                            "col": 13,
                            "line": 217
                        }
                    },
                    "name": "EBO",
                    "type": "EBO"
                }
            ],
            "type": "EBO"
        },
        {
            "ast": "VarDecl",
            "loc": {
                "begin": {
                    "char": 6324,
                    "col": 1,
                    "line": 218
                },
                "end": {
                    "char": 6351,
                    "col": 28,
                    "line": 218
                }
            },
            "name": "table_elements",
            "type": "unsigned int"
        },
        {
            "ast": "VarDecl",
            "loc": {
                "begin": {
                    "char": 6354,
                    "col": 1,
                    "line": 220
                },
                "end": {
                    "char": 6405,
                    "col": 52,
                    "line": 220
                }
            },
            "name": "cubeVBO",
            "nodes": [
                {
                    "ast": "TypeRef",
                    "loc": {
                        "begin": {
                            "char": 6354,
                            "col": 1,
                            "line": 220
                        },
                        "end": {
                            "char": 6357,
                            "col": 4,
                            "line": 220
                        }
                    },
                    "name": "struct VBO",
                    "type": "VBO"
                },
                {
                    "ast": "CallExpr",
                    "loc": {
                        "begin": {
                            "char": 6358,
                            "col": 5,
                            "line": 220
                        },
                        "end": {
                            "char": 6405,
                            "col": 52,
                            "line": 220
                        }
                    },
                    "name": "VBO",
                    "nodes": [
                        {
                            "ast": "UnaryExpr",
                            "loc": {
                                "begin": {
                                    "char": 6366,
                                    "col": 13,
                                    "line": 220
                                },
                                "end": {
                                    "char": 6388,
                                    "col": 35,
                                    "line": 220
                                }
                            },
                            "nodes": [
                                {
                                    "ast": "ParenExpr",
                                    "loc": {
                                        "begin": {
                                            "char": 6372,
                                            "col": 19,
                                            "line": 220
                                        },
                                        "end": {
                                            "char": 6388,
                                            "col": 35,
                                            "line": 220
                                        }
                                    },
                                    "nodes": [
                                        {
                                            "ast": "DeclRefExpr",
                                            "loc": {
                                                "begin": {
                                                    "char": 6373,
                                                    "col": 20,
                                                    "line": 220
                                                },
                                                "end": {
                                                    "char": 6387,
                                                    "col": 34,
                                                    "line": 220
                                                }
                                            },
                                            "name": "positions_cube",
                                            "type": "float [108]"
                                        }
                                    ],
                                    "type": "float [108]"
                                }
                            ],
                            "type": "unsigned long"
                        },
                        {
                            "ast": "DeclRefExpr",
                            "loc": {
                                "begin": {
                                    "char": 6390,
                                    "col": 37,
                                    "line": 220
                                },
                                "end": {
                                    "char": 6404,
                                    "col": 51,
                                    "line": 220
                                }
                            },
                            "name": "positions_cube",
                            "type": "float [108]"
                        }
                    ],
                    "type": "VBO"
                }
            ],
            "type": "VBO"
        },
        {
            "ast": "VarDecl",
            "loc": {
                "begin": {
                    "char": 6408,
                    "col": 1,
                    "line": 222
                },
                "end": {
                    "char": 6421,
                    "col": 14,
                    "line": 222
                }
            },
            "name": "objectVAO",
            "nodes": [
                {
                    "ast": "TypeRef",
                    "loc": {
                        "begin": {
                            "char": 6408,
                            "col": 1,
                            "line": 222
                        },
                        "end": {
                            "char": 6411,
                            "col": 4,
                            "line": 222
                        }
                    },
                    "name": "struct VAO",
                    "type": "VAO"
                },
                {
                    "ast": "CallExpr",
                    "loc": {
                        "begin": {
                            "char": 6412,
                            "col": 5,
                            "line": 222
                        },
                        "end": {
                            "char": 6421,
                            "col": 14,
                            "line": 222
                        }
                    },
                    "name": "VAO",
                    "type": "VAO"
                }
            ],
            "type": "VAO"
        },
        {
            "ast": "VarDecl",
            "loc": {
                "begin": {
                    "char": 6423,
                    "col": 1,
                    "line": 223
                },
                "end": {
                    "char": 6445,
                    "col": 23,
                    "line": 223
                }
            },
            "name": "objectInstancesVBO",
            "nodes": [
                {
                    "ast": "TypeRef",
                    "loc": {
                        "begin": {
                            "char": 6423,
                            "col": 1,
                            "line": 223
                        },
                        "end": {
                            "char": 6426,
                            "col": 4,
                            "line": 223
                        }
                    },
                    "name": "struct VBO",
                    "type": "VBO"
                }
            ],
            "type": "VBO"
        },
        {
            "ast": "VarDecl",
            "loc": {
                "begin": {
                    "char": 6472,
                    "col": 1,
                    "line": 225
                },
                "end": {
                    "char": 6486,
                    "col": 15,
                    "line": 225
                }
            },
            "name": "segmentVAO",
            "nodes": [
                {
                    "ast": "TypeRef",
                    "loc": {
                        "begin": {
                            "char": 6472,
                            "col": 1,
                            "line": 225
                        },
                        "end": {
                            "char": 6475,
                            "col": 4,
                            "line": 225
                        }
                    },
                    "name": "struct VAO",
                    "type": "VAO"
                },
                {
                    "ast": "CallExpr",
                    "loc": {
                        "begin": {
                            "char": 6476,
                            "col": 5,
                            "line": 225
                        },
                        "end": {
                            "char": 6486,
                            "col": 15,
                            "line": 225
                        }
                    },
                    "name": "VAO",
                    "type": "VAO"
                }
            ],
            "type": "VAO"
        },
        {
            "ast": "VarDecl",
            "loc": {
                "begin": {
                    "char": 6488,
                    "col": 1,
                    "line": 226
                },
                "end": {
                    "char": 6511,
                    "col": 24,
                    "line": 226
                }
            },
            "name": "segmentInstancesVBO",
            "nodes": [
                {
                    "ast": "TypeRef",
                    "loc": {
                        "begin": {
                            "char": 6488,
                            "col": 1,
                            "line": 226
                        },
                        "end": {
                            "char": 6491,
                            "col": 4,
                            "line": 226
                        }
                    },
                    "name": "struct VBO",
                    "type": "VBO"
                }
            ],
            "type": "VBO"
        },
        {
            "ast": "VarDecl",
            "loc": {
                "begin": {
                    "char": 6539,
                    "col": 1,
                    "line": 228
                },
                "end": {
                    "char": 6555,
                    "col": 17,
                    "line": 228
                }
            },
            "name": "particlesVAO",
            "nodes": [
                {
                    "ast": "TypeRef",
                    "loc": {
                        "begin": {
                            "char": 6539,
                            "col": 1,
                            "line": 228
                        },
                        "end": {
                            "char": 6542,
                            "col": 4,
                            "line": 228
                        }
                    },
                    "name": "struct VAO",
                    "type": "VAO"
                },
                {
                    "ast": "CallExpr",
                    "loc": {
                        "begin": {
                            "char": 6543,
                            "col": 5,
                            "line": 228
                        },
                        "end": {
                            "char": 6555,
                            "col": 17,
                            "line": 228
                        }
                    },
                    "name": "VAO",
                    "type": "VAO"
                }
            ],
            "type": "VAO"
        },
        {
            "ast": "VarDecl",
            "loc": {
                "begin": {
                    "char": 6557,
                    "col": 1,
                    "line": 229
                },
                "end": {
                    "char": 6573,
                    "col": 17,
                    "line": 229
                }
            },
            "name": "particlesVBO",
            "nodes": [
                {
                    "ast": "TypeRef",
                    "loc": {
                        "begin": {
                            "char": 6557,
                            "col": 1,
                            "line": 229
                        },
                        "end": {
                            "char": 6560,
                            "col": 4,
                            "line": 229
                        }
                    },
                    "name": "struct VBO",
                    "type": "VBO"
                }
            ],
            "type": "VBO"
        },
        {
            "ast": "VarDecl",
            "loc": {
                "begin": {
                    "char": 6602,
                    "col": 1,
                    "line": 231
                },
                "end": {
                    "char": 6614,
                    "col": 13,
                    "line": 231
                }
            },
            "name": "debugVAO",
            "nodes": [
                {
                    "ast": "TypeRef",
                    "loc": {
                        "begin": {
                            "char": 6602,
                            "col": 1,
                            "line": 231
                        },
                        "end": {
                            "char": 6605,
                            "col": 4,
                            "line": 231
                        }
                    },
                    "name": "struct VAO",
                    "type": "VAO"
                },
                {
                    "ast": "CallExpr",
                    "loc": {
                        "begin": {
                            "char": 6606,
                            "col": 5,
                            "line": 231
                        },
                        "end": {
                            "char": 6614,
                            "col": 13,
                            "line": 231
                        }
                    },
                    "name": "VAO",
                    "type": "VAO"
                }
            ],
            "type": "VAO"
        },
        {
            "ast": "VarDecl",
            "loc": {
                "begin": {
                    "char": 6616,
                    "col": 1,
                    "line": 232
                },
                "end": {
                    "char": 6628,
                    "col": 13,
                    "line": 232
                }
            },
            "name": "debugVBO",
            "nodes": [
                {
                    "ast": "TypeRef",
                    "loc": {
                        "begin": {
                            "char": 6616,
                            "col": 1,
                            "line": 232
                        },
                        "end": {
                            "char": 6619,
                            "col": 4,
                            "line": 232
                        }
                    },
                    "name": "struct VBO",
                    "type": "VBO"
                }
            ],
            "type": "VBO"
        },
        {
            "ast": "VarDecl",
            "loc": {
                "begin": {
                    "char": 6657,
                    "col": 1,
                    "line": 234
                },
                "end": {
                    "char": 6683,
                    "col": 27,
                    "line": 234
                }
            },
            "name": "particleSize",
            "nodes": [
                {
                    "ast": "FloatingLiteral",
                    "loc": {
                        "begin": {
                            "char": 6678,
                            "col": 22,
                            "line": 234
                        },
                        "end": {
                            "char": 6683,
                            "col": 27,
                            "line": 234
                        }
                    },
                    "type": "double"
                }
            ],
            "type": "float"
        },
        {
            "ast": "VarDecl",
            "loc": {
                "begin": {
                    "char": 6685,
                    "col": 1,
                    "line": 235
                },
                "end": {
                    "char": 6718,
                    "col": 34,
                    "line": 235
                }
            },
            "name": "creature_fluid_push",
            "nodes": [
                {
                    "ast": "FloatingLiteral",
                    "loc": {
                        "begin": {
                            "char": 6713,
                            "col": 29,
                            "line": 235
                        },
                        "end": {
                            "char": 6718,
                            "col": 34,
                            "line": 235
                        }
                    },
                    "type": "float",
                    "value": 0.75
                }
            ],
            "type": "float"
        },
        {
            "ast": "VarDecl",
            "loc": {
                "begin": {
                    "char": 6721,
                    "col": 1,
                    "line": 237
                },
                "end": {
                    "char": 6738,
                    "col": 18,
                    "line": 237
                }
            },
            "name": "debugMode",
            "nodes": [
                {
                    "ast": "IntegerLiteral",
                    "loc": {
                        "begin": {
                            "char": 6737,
                            "col": 17,
                            "line": 237
                        },
                        "end": {
                            "char": 6738,
                            "col": 18,
                            "line": 237
                        }
                    },
                    "type": "int",
                    "value": 0
                }
            ],
            "type": "int"
        },
        {
            "ast": "VarDecl",
            "loc": {
                "begin": {
                    "char": 6740,
                    "col": 1,
                    "line": 238
                },
                "end": {
                    "char": 6755,
                    "col": 16,
                    "line": 238
                }
            },
            "name": "camMode",
            "nodes": [
                {
                    "ast": "IntegerLiteral",
                    "loc": {
                        "begin": {
                            "char": 6754,
                            "col": 15,
                            "line": 238
                        },
                        "end": {
                            "char": 6755,
                            "col": 16,
                            "line": 238
                        }
                    },
                    "type": "int",
                    "value": 0
                }
            ],
            "type": "int"
        },
        {
            "ast": "VarDecl",
            "loc": {
                "begin": {
                    "char": 6757,
                    "col": 1,
                    "line": 239
                },
                "end": {
                    "char": 6775,
                    "col": 19,
                    "line": 239
                }
            },
            "name": "camModeMax",
            "nodes": [
                {
                    "ast": "IntegerLiteral",
                    "loc": {
                        "begin": {
                            "char": 6774,
                            "col": 18,
                            "line": 239
                        },
                        "end": {
                            "char": 6775,
                            "col": 19,
                            "line": 239
                        }
                    },
                    "type": "int",
                    "value": 4
                }
            ],
            "type": "int"
        },
        {
            "ast": "VarDecl",
            "loc": {
                "begin": {
                    "char": 6777,
                    "col": 1,
                    "line": 240
                },
                "end": {
                    "char": 6793,
                    "col": 17,
                    "line": 240
                }
            },
            "name": "camVel",
            "nodes": [
                {
                    "ast": "NamespaceRef",
                    "loc": {
                        "begin": {
                            "char": 6777,
                            "col": 1,
                            "line": 240
                        },
                        "end": {
                            "char": 6780,
                            "col": 4,
                            "line": 240
                        }
                    },
                    "name": "glm"
                },
                {
                    "ast": "TypeRef",
                    "loc": {
                        "begin": {
                            "char": 6782,
                            "col": 6,
                            "line": 240
                        },
                        "end": {
                            "char": 6786,
                            "col": 10,
                            "line": 240
                        }
                    },
                    "name": "glm::vec3",
                    "type": "glm::vec3"
                }
            ],
            "type": "glm::vec3"
        },
        {
            "ast": "VarDecl",
            "loc": {
                "begin": {
                    "char": 6777,
                    "col": 1,
                    "line": 240
                },
                "end": {
                    "char": 6802,
                    "col": 26,
                    "line": 240
                }
            },
            "name": "camTurn",
            "nodes": [
                {
                    "ast": "NamespaceRef",
                    "loc": {
                        "begin": {
                            "char": 6777,
                            "col": 1,
                            "line": 240
                        },
                        "end": {
                            "char": 6780,
                            "col": 4,
                            "line": 240
                        }
                    },
                    "name": "glm"
                },
                {
                    "ast": "TypeRef",
                    "loc": {
                        "begin": {
                            "char": 6782,
                            "col": 6,
                            "line": 240
                        },
                        "end": {
                            "char": 6786,
                            "col": 10,
                            "line": 240
                        }
                    },
                    "name": "glm::vec3",
                    "type": "glm::vec3"
                }
            ],
            "type": "glm::vec3"
        },
        {
            "ast": "VarDecl",
            "loc": {
                "begin": {
                    "char": 6804,
                    "col": 1,
                    "line": 241
                },
                "end": {
                    "char": 6823,
                    "col": 20,
                    "line": 241
                }
            },
            "name": "cameraLoc",
            "nodes": [
                {
                    "ast": "NamespaceRef",
                    "loc": {
                        "begin": {
                            "char": 6804,
                            "col": 1,
                            "line": 241
                        },
                        "end": {
                            "char": 6807,
                            "col": 4,
                            "line": 241
                        }
                    },
                    "name": "glm"
                },
                {
                    "ast": "TypeRef",
                    "loc": {
                        "begin": {
                            "char": 6809,
                            "col": 6,
                            "line": 241
                        },
                        "end": {
                            "char": 6813,
                            "col": 10,
                            "line": 241
                        }
                    },
                    "name": "glm::vec3",
                    "type": "glm::vec3"
                }
            ],
            "type": "glm::vec3"
        },
        {
            "ast": "VarDecl",
            "loc": {
                "begin": {
                    "char": 6825,
                    "col": 1,
                    "line": 242
                },
                "end": {
                    "char": 6844,
                    "col": 20,
                    "line": 242
                }
            },
            "name": "cameraOri",
            "nodes": [
                {
                    "ast": "NamespaceRef",
                    "loc": {
                        "begin": {
                            "char": 6825,
                            "col": 1,
                            "line": 242
                        },
                        "end": {
                            "char": 6828,
                            "col": 4,
                            "line": 242
                        }
                    },
                    "name": "glm"
                },
                {
                    "ast": "TypeRef",
                    "loc": {
                        "begin": {
                            "char": 6830,
                            "col": 6,
                            "line": 242
                        },
                        "end": {
                            "char": 6834,
                            "col": 10,
                            "line": 242
                        }
                    },
                    "name": "glm::quat",
                    "type": "glm::quat"
                }
            ],
            "type": "glm::quat"
        },
        {
            "ast": "VarDecl",
            "loc": {
                "begin": {
                    "char": 6847,
                    "col": 1,
                    "line": 244
                },
                "end": {
                    "char": 6867,
                    "col": 21,
                    "line": 244
                }
            },
            "name": "sim_mutex",
            "type": "int"
        },
        {
            "ast": "VarDecl",
            "loc": {
                "begin": {
                    "char": 6870,
                    "col": 1,
                    "line": 246
                },
                "end": {
                    "char": 6889,
                    "col": 20,
                    "line": 246
                }
            },
            "name": "world_min",
            "nodes": [
                {
                    "ast": "NamespaceRef",
                    "loc": {
                        "begin": {
                            "char": 6870,
                            "col": 1,
                            "line": 246
                        },
                        "end": {
                            "char": 6873,
                            "col": 4,
                            "line": 246
                        }
                    },
                    "name": "glm"
                },
                {
                    "ast": "TypeRef",
                    "loc": {
                        "begin": {
                            "char": 6875,
                            "col": 6,
                            "line": 246
                        },
                        "end": {
                            "char": 6879,
                            "col": 10,
                            "line": 246
                        }
                    },
                    "name": "glm::vec3",
                    "type": "glm::vec3"
                }
            ],
            "type": "glm::vec3"
        },
        {
            "ast": "VarDecl",
            "loc": {
                "begin": {
                    "char": 6906,
                    "col": 1,
                    "line": 247
                },
                "end": {
                    "char": 6925,
                    "col": 20,
                    "line": 247
                }
            },
            "name": "world_max",
            "nodes": [
                {
                    "ast": "NamespaceRef",
                    "loc": {
                        "begin": {
                            "char": 6906,
                            "col": 1,
                            "line": 247
                        },
                        "end": {
                            "char": 6909,
                            "col": 4,
                            "line": 247
                        }
                    },
                    "name": "glm"
                },
                {
                    "ast": "TypeRef",
                    "loc": {
                        "begin": {
                            "char": 6911,
                            "col": 6,
                            "line": 247
                        },
                        "end": {
                            "char": 6915,
                            "col": 10,
                            "line": 247
                        }
                    },
                    "name": "glm::vec3",
                    "type": "glm::vec3"
                }
            ],
            "type": "glm::vec3"
        },
        {
            "ast": "VarDecl",
            "loc": {
                "begin": {
                    "char": 6945,
                    "col": 1,
                    "line": 248
                },
                "end": {
                    "char": 6967,
                    "col": 23,
                    "line": 248
                }
            },
            "name": "world_centre",
            "nodes": [
                {
                    "ast": "NamespaceRef",
                    "loc": {
                        "begin": {
                            "char": 6945,
                            "col": 1,
                            "line": 248
                        },
                        "end": {
                            "char": 6948,
                            "col": 4,
                            "line": 248
                        }
                    },
                    "name": "glm"
                },
                {
                    "ast": "TypeRef",
                    "loc": {
                        "begin": {
                            "char": 6950,
                            "col": 6,
                            "line": 248
                        },
                        "end": {
                            "char": 6954,
                            "col": 10,
                            "line": 248
                        }
                    },
                    "name": "glm::vec3",
                    "type": "glm::vec3"
                }
            ],
            "type": "glm::vec3"
        },
        {
            "ast": "VarDecl",
            "comment": {
                "text": "// how to convert world positions into fluid texture coordinates:"
            },
            "loc": {
                "begin": {
                    "char": 7054,
                    "col": 1,
                    "line": 251
                },
                "end": {
                    "char": 7077,
                    "col": 24,
                    "line": 251
                }
            },
            "name": "field2world_scale",
            "type": "float"
        },
        {
            "ast": "VarDecl",
            "loc": {
                "begin": {
                    "char": 7079,
                    "col": 1,
                    "line": 252
                },
                "end": {
                    "char": 7100,
                    "col": 22,
                    "line": 252
                }
            },
            "name": "world2field",
            "nodes": [
                {
                    "ast": "NamespaceRef",
                    "loc": {
                        "begin": {
                            "char": 7079,
                            "col": 1,
                            "line": 252
                        },
                        "end": {
                            "char": 7082,
                            "col": 4,
                            "line": 252
                        }
                    },
                    "name": "glm"
                },
                {
                    "ast": "TypeRef",
                    "loc": {
                        "begin": {
                            "char": 7084,
                            "col": 6,
                            "line": 252
                        },
                        "end": {
                            "char": 7088,
                            "col": 10,
                            "line": 252
                        }
                    },
                    "name": "glm::mat4",
                    "type": "glm::mat4"
                }
            ],
            "type": "glm::mat4"
        },
        {
            "ast": "VarDecl",
            "loc": {
                "begin": {
                    "char": 7102,
                    "col": 1,
                    "line": 253
                },
                "end": {
                    "char": 7123,
                    "col": 22,
                    "line": 253
                }
            },
            "name": "field2world",
            "nodes": [
                {
                    "ast": "NamespaceRef",
                    "loc": {
                        "begin": {
                            "char": 7102,
                            "col": 1,
                            "line": 253
                        },
                        "end": {
                            "char": 7105,
                            "col": 4,
                            "line": 253
                        }
                    },
                    "name": "glm"
                },
                {
                    "ast": "TypeRef",
                    "loc": {
                        "begin": {
                            "char": 7107,
                            "col": 6,
                            "line": 253
                        },
                        "end": {
                            "char": 7111,
                            "col": 10,
                            "line": 253
                        }
                    },
                    "name": "glm::mat4",
                    "type": "glm::mat4"
                }
            ],
            "type": "glm::mat4"
        },
        {
            "ast": "VarDecl",
            "loc": {
                "begin": {
                    "char": 7125,
                    "col": 1,
                    "line": 254
                },
                "end": {
                    "char": 7145,
                    "col": 21,
                    "line": 254
                }
            },
            "name": "vive2world",
            "nodes": [
                {
                    "ast": "NamespaceRef",
                    "loc": {
                        "begin": {
                            "char": 7125,
                            "col": 1,
                            "line": 254
                        },
                        "end": {
                            "char": 7128,
                            "col": 4,
                            "line": 254
                        }
                    },
                    "name": "glm"
                },
                {
                    "ast": "TypeRef",
                    "loc": {
                        "begin": {
                            "char": 7130,
                            "col": 6,
                            "line": 254
                        },
                        "end": {
                            "char": 7134,
                            "col": 10,
                            "line": 254
                        }
                    },
                    "name": "glm::mat4",
                    "type": "glm::mat4"
                }
            ],
            "type": "glm::mat4"
        },
        {
            "ast": "VarDecl",
            "loc": {
                "begin": {
                    "char": 7147,
                    "col": 1,
                    "line": 255
                },
                "end": {
                    "char": 7169,
                    "col": 23,
                    "line": 255
                }
            },
            "name": "kinect2world",
            "nodes": [
                {
                    "ast": "NamespaceRef",
                    "loc": {
                        "begin": {
                            "char": 7147,
                            "col": 1,
                            "line": 255
                        },
                        "end": {
                            "char": 7150,
                            "col": 4,
                            "line": 255
                        }
                    },
                    "name": "glm"
                },
                {
                    "ast": "TypeRef",
                    "loc": {
                        "begin": {
                            "char": 7152,
                            "col": 6,
                            "line": 255
                        },
                        "end": {
                            "char": 7156,
                            "col": 10,
                            "line": 255
                        }
                    },
                    "name": "glm::mat4",
                    "type": "glm::mat4"
                }
            ],
            "type": "glm::mat4"
        },
        {
            "ast": "VarDecl",
            "loc": {
                "begin": {
                    "char": 7172,
                    "col": 1,
                    "line": 256
                },
                "end": {
                    "char": 7189,
                    "col": 18,
                    "line": 256
                }
            },
            "name": "viewMat",
            "nodes": [
                {
                    "ast": "NamespaceRef",
                    "loc": {
                        "begin": {
                            "char": 7172,
                            "col": 1,
                            "line": 256
                        },
                        "end": {
                            "char": 7175,
                            "col": 4,
                            "line": 256
                        }
                    },
                    "name": "glm"
                },
                {
                    "ast": "TypeRef",
                    "loc": {
                        "begin": {
                            "char": 7177,
                            "col": 6,
                            "line": 256
                        },
                        "end": {
                            "char": 7181,
                            "col": 10,
                            "line": 256
                        }
                    },
                    "name": "glm::mat4",
                    "type": "glm::mat4"
                }
            ],
            "type": "glm::mat4"
        },
        {
            "ast": "VarDecl",
            "loc": {
                "begin": {
                    "char": 7191,
                    "col": 1,
                    "line": 257
                },
                "end": {
                    "char": 7208,
                    "col": 18,
                    "line": 257
                }
            },
            "name": "projMat",
            "nodes": [
                {
                    "ast": "NamespaceRef",
                    "loc": {
                        "begin": {
                            "char": 7191,
                            "col": 1,
                            "line": 257
                        },
                        "end": {
                            "char": 7194,
                            "col": 4,
                            "line": 257
                        }
                    },
                    "name": "glm"
                },
                {
                    "ast": "TypeRef",
                    "loc": {
                        "begin": {
                            "char": 7196,
                            "col": 6,
                            "line": 257
                        },
                        "end": {
                            "char": 7200,
                            "col": 10,
                            "line": 257
                        }
                    },
                    "name": "glm::mat4",
                    "type": "glm::mat4"
                }
            ],
            "type": "glm::mat4"
        },
        {
            "ast": "VarDecl",
            "loc": {
                "begin": {
                    "char": 7210,
                    "col": 1,
                    "line": 258
                },
                "end": {
                    "char": 7231,
                    "col": 22,
                    "line": 258
                }
            },
            "name": "viewProjMat",
            "nodes": [
                {
                    "ast": "NamespaceRef",
                    "loc": {
                        "begin": {
                            "char": 7210,
                            "col": 1,
                            "line": 258
                        },
                        "end": {
                            "char": 7213,
                            "col": 4,
                            "line": 258
                        }
                    },
                    "name": "glm"
                },
                {
                    "ast": "TypeRef",
                    "loc": {
                        "begin": {
                            "char": 7215,
                            "col": 6,
                            "line": 258
                        },
                        "end": {
                            "char": 7219,
                            "col": 10,
                            "line": 258
                        }
                    },
                    "name": "glm::mat4",
                    "type": "glm::mat4"
                }
            ],
            "type": "glm::mat4"
        },
        {
            "ast": "VarDecl",
            "loc": {
                "begin": {
                    "char": 7233,
                    "col": 1,
                    "line": 259
                },
                "end": {
                    "char": 7257,
                    "col": 25,
                    "line": 259
                }
            },
            "name": "viewMatInverse",
            "nodes": [
                {
                    "ast": "NamespaceRef",
                    "loc": {
                        "begin": {
                            "char": 7233,
                            "col": 1,
                            "line": 259
                        },
                        "end": {
                            "char": 7236,
                            "col": 4,
                            "line": 259
                        }
                    },
                    "name": "glm"
                },
                {
                    "ast": "TypeRef",
                    "loc": {
                        "begin": {
                            "char": 7238,
                            "col": 6,
                            "line": 259
                        },
                        "end": {
                            "char": 7242,
                            "col": 10,
                            "line": 259
                        }
                    },
                    "name": "glm::mat4",
                    "type": "glm::mat4"
                }
            ],
            "type": "glm::mat4"
        },
        {
            "ast": "VarDecl",
            "loc": {
                "begin": {
                    "char": 7259,
                    "col": 1,
                    "line": 260
                },
                "end": {
                    "char": 7283,
                    "col": 25,
                    "line": 260
                }
            },
            "name": "projMatInverse",
            "nodes": [
                {
                    "ast": "NamespaceRef",
                    "loc": {
                        "begin": {
                            "char": 7259,
                            "col": 1,
                            "line": 260
                        },
                        "end": {
                            "char": 7262,
                            "col": 4,
                            "line": 260
                        }
                    },
                    "name": "glm"
                },
                {
                    "ast": "TypeRef",
                    "loc": {
                        "begin": {
                            "char": 7264,
                            "col": 6,
                            "line": 260
                        },
                        "end": {
                            "char": 7268,
                            "col": 10,
                            "line": 260
                        }
                    },
                    "name": "glm::mat4",
                    "type": "glm::mat4"
                }
            ],
            "type": "glm::mat4"
        },
        {
            "ast": "VarDecl",
            "loc": {
                "begin": {
                    "char": 7285,
                    "col": 1,
                    "line": 261
                },
                "end": {
                    "char": 7313,
                    "col": 29,
                    "line": 261
                }
            },
            "name": "viewProjMatInverse",
            "nodes": [
                {
                    "ast": "NamespaceRef",
                    "loc": {
                        "begin": {
                            "char": 7285,
                            "col": 1,
                            "line": 261
                        },
                        "end": {
                            "char": 7288,
                            "col": 4,
                            "line": 261
                        }
                    },
                    "name": "glm"
                },
                {
                    "ast": "TypeRef",
                    "loc": {
                        "begin": {
                            "char": 7290,
                            "col": 6,
                            "line": 261
                        },
                        "end": {
                            "char": 7294,
                            "col": 10,
                            "line": 261
                        }
                    },
                    "name": "glm::mat4",
                    "type": "glm::mat4"
                }
            ],
            "type": "glm::mat4"
        },
        {
            "ast": "VarDecl",
            "loc": {
                "begin": {
                    "char": 7315,
                    "col": 1,
                    "line": 262
                },
                "end": {
                    "char": 7334,
                    "col": 20,
                    "line": 262
                }
            },
            "name": "leap2view",
            "nodes": [
                {
                    "ast": "NamespaceRef",
                    "loc": {
                        "begin": {
                            "char": 7315,
                            "col": 1,
                            "line": 262
                        },
                        "end": {
                            "char": 7318,
                            "col": 4,
                            "line": 262
                        }
                    },
                    "name": "glm"
                },
                {
                    "ast": "TypeRef",
                    "loc": {
                        "begin": {
                            "char": 7320,
                            "col": 6,
                            "line": 262
                        },
                        "end": {
                            "char": 7324,
                            "col": 10,
                            "line": 262
                        }
                    },
                    "name": "glm::mat4",
                    "type": "glm::mat4"
                }
            ],
            "type": "glm::mat4"
        },
        {
            "ast": "VarDecl",
            "loc": {
                "begin": {
                    "char": 7336,
                    "col": 1,
                    "line": 263
                },
                "end": {
                    "char": 7357,
                    "col": 22,
                    "line": 263
                }
            },
            "name": "mini2world",
            "nodes": [
                {
                    "ast": "FloatingLiteral",
                    "loc": {
                        "begin": {
                            "char": 7355,
                            "col": 20,
                            "line": 263
                        },
                        "end": {
                            "char": 7357,
                            "col": 22,
                            "line": 263
                        }
                    },
                    "type": "double"
                }
            ],
            "type": "float"
        },
        {
            "ast": "VarDecl",
            "loc": {
                "begin": {
                    "char": 7359,
                    "col": 1,
                    "line": 264
                },
                "end": {
                    "char": 7394,
                    "col": 36,
                    "line": 264
                }
            },
            "name": "near_clip",
            "nodes": [
                {
                    "ast": "BinaryOperator",
                    "loc": {
                        "begin": {
                            "char": 7377,
                            "col": 19,
                            "line": 264
                        },
                        "end": {
                            "char": 7394,
                            "col": 36,
                            "line": 264
                        }
                    },
                    "nodes": [
                        {
                            "ast": "FloatingLiteral",
                            "loc": {
                                "begin": {
                                    "char": 7377,
                                    "col": 19,
                                    "line": 264
                                },
                                "end": {
                                    "char": 7381,
                                    "col": 23,
                                    "line": 264
                                }
                            },
                            "type": "float"
                        },
                        {
                            "ast": "DeclRefExpr",
                            "loc": {
                                "begin": {
                                    "char": 7384,
                                    "col": 26,
                                    "line": 264
                                },
                                "end": {
                                    "char": 7394,
                                    "col": 36,
                                    "line": 264
                                }
                            },
                            "name": "mini2world",
                            "type": "float"
                        }
                    ],
                    "type": "float"
                }
            ],
            "type": "float"
        },
        {
            "ast": "VarDecl",
            "comment": {
                "text": "// / mini2world;"
            },
            "loc": {
                "begin": {
                    "char": 7396,
                    "col": 1,
                    "line": 265
                },
                "end": {
                    "char": 7432,
                    "col": 37,
                    "line": 265
                }
            },
            "name": "far_clip",
            "nodes": [
                {
                    "ast": "BinaryOperator",
                    "loc": {
                        "begin": {
                            "char": 7413,
                            "col": 18,
                            "line": 265
                        },
                        "end": {
                            "char": 7432,
                            "col": 37,
                            "line": 265
                        }
                    },
                    "nodes": [
                        {
                            "ast": "FloatingLiteral",
                            "loc": {
                                "begin": {
                                    "char": 7413,
                                    "col": 18,
                                    "line": 265
                                },
                                "end": {
                                    "char": 7419,
                                    "col": 24,
                                    "line": 265
                                }
                            },
                            "type": "float"
                        },
                        {
                            "ast": "DeclRefExpr",
                            "loc": {
                                "begin": {
                                    "char": 7422,
                                    "col": 27,
                                    "line": 265
                                },
                                "end": {
                                    "char": 7432,
                                    "col": 37,
                                    "line": 265
                                }
                            },
                            "name": "mini2world",
                            "type": "float"
                        }
                    ],
                    "type": "float"
                }
            ],
            "type": "float"
        },
        {
            "ast": "VarDecl",
            "loc": {
                "begin": {
                    "char": 7450,
                    "col": 1,
                    "line": 266
                },
                "end": {
                    "char": 7466,
                    "col": 17,
                    "line": 266
                }
            },
            "name": "eyePos",
            "nodes": [
                {
                    "ast": "NamespaceRef",
                    "loc": {
                        "begin": {
                            "char": 7450,
                            "col": 1,
                            "line": 266
                        },
                        "end": {
                            "char": 7453,
                            "col": 4,
                            "line": 266
                        }
                    },
                    "name": "glm"
                },
                {
                    "ast": "TypeRef",
                    "loc": {
                        "begin": {
                            "char": 7455,
                            "col": 6,
                            "line": 266
                        },
                        "end": {
                            "char": 7459,
                            "col": 10,
                            "line": 266
                        }
                    },
                    "name": "glm::vec3",
                    "type": "glm::vec3"
                }
            ],
            "type": "glm::vec3"
        },
        {
            "ast": "VarDecl",
            "loc": {
                "begin": {
                    "char": 7468,
                    "col": 1,
                    "line": 267
                },
                "end": {
                    "char": 7485,
                    "col": 18,
                    "line": 267
                }
            },
            "name": "viewport",
            "nodes": [
                {
                    "ast": "TypeRef",
                    "loc": {
                        "begin": {
                            "char": 7468,
                            "col": 1,
                            "line": 267
                        },
                        "end": {
                            "char": 7476,
                            "col": 9,
                            "line": 267
                        }
                    },
                    "name": "struct Viewport",
                    "type": "Viewport"
                },
                {
                    "ast": "CallExpr",
                    "loc": {
                        "begin": {
                            "char": 7477,
                            "col": 10,
                            "line": 267
                        },
                        "end": {
                            "char": 7485,
                            "col": 18,
                            "line": 267
                        }
                    },
                    "name": "Viewport",
                    "type": "Viewport"
                }
            ],
            "type": "Viewport"
        },
        {
            "ast": "VarDecl",
            "loc": {
                "begin": {
                    "char": 7534,
                    "col": 1,
                    "line": 270
                },
                "end": {
                    "char": 7554,
                    "col": 21,
                    "line": 270
                }
            },
            "name": "vrLocation",
            "nodes": [
                {
                    "ast": "NamespaceRef",
                    "loc": {
                        "begin": {
                            "char": 7534,
                            "col": 1,
                            "line": 270
                        },
                        "end": {
                            "char": 7537,
                            "col": 4,
                            "line": 270
                        }
                    },
                    "name": "glm"
                },
                {
                    "ast": "TypeRef",
                    "loc": {
                        "begin": {
                            "char": 7539,
                            "col": 6,
                            "line": 270
                        },
                        "end": {
                            "char": 7543,
                            "col": 10,
                            "line": 270
                        }
                    },
                    "name": "glm::vec3",
                    "type": "glm::vec3"
                }
            ],
            "type": "glm::vec3"
        },
        {
            "ast": "VarDecl",
            "loc": {
                "begin": {
                    "char": 7585,
                    "col": 1,
                    "line": 272
                },
                "end": {
                    "char": 7597,
                    "col": 13,
                    "line": 272
                }
            },
            "name": "kidx",
            "nodes": [
                {
                    "ast": "IntegerLiteral",
                    "loc": {
                        "begin": {
                            "char": 7596,
                            "col": 12,
                            "line": 272
                        },
                        "end": {
                            "char": 7597,
                            "col": 13,
                            "line": 272
                        }
                    },
                    "type": "int",
                    "value": 0
                }
            ],
            "type": "int"
        },
        {
            "ast": "VarDecl",
            "loc": {
                "begin": {
                    "char": 7600,
                    "col": 1,
                    "line": 274
                },
                "end": {
                    "char": 7613,
                    "col": 14,
                    "line": 274
                }
            },
            "name": "state",
            "nodes": [
                {
                    "ast": "TypeRef",
                    "loc": {
                        "begin": {
                            "char": 7600,
                            "col": 1,
                            "line": 274
                        },
                        "end": {
                            "char": 7605,
                            "col": 6,
                            "line": 274
                        }
                    },
                    "name": "struct State",
                    "type": "State"
                }
            ],
            "type": "State *"
        },
        {
            "ast": "VarDecl",
            "loc": {
                "begin": {
                    "char": 7615,
                    "col": 1,
                    "line": 275
                },
                "end": {
                    "char": 7635,
                    "col": 21,
                    "line": 275
                }
            },
            "name": "statemap",
            "nodes": [
                {
                    "ast": "TemplateRef",
                    "loc": {
                        "begin": {
                            "char": 7615,
                            "col": 1,
                            "line": 275
                        },
                        "end": {
                            "char": 7619,
                            "col": 5,
                            "line": 275
                        }
                    },
                    "name": "Mmap"
                },
                {
                    "ast": "TypeRef",
                    "loc": {
                        "begin": {
                            "char": 7620,
                            "col": 6,
                            "line": 275
                        },
                        "end": {
                            "char": 7625,
                            "col": 11,
                            "line": 275
                        }
                    },
                    "name": "struct State",
                    "type": "State"
                }
            ],
            "type": "Mmap<State>"
        },
        {
            "ast": "VarDecl",
            "loc": {
                "begin": {
                    "char": 7638,
                    "col": 1,
                    "line": 277
                },
                "end": {
                    "char": 7659,
                    "col": 22,
                    "line": 277
                }
            },
            "name": "fluid_passes",
            "nodes": [
                {
                    "ast": "IntegerLiteral",
                    "loc": {
                        "begin": {
                            "char": 7657,
                            "col": 20,
                            "line": 277
                        },
                        "end": {
                            "char": 7659,
                            "col": 22,
                            "line": 277
                        }
                    },
                    "type": "int",
                    "value": 14
                }
            ],
            "type": "int"
        },
        {
            "ast": "VarDecl",
            "loc": {
                "begin": {
                    "char": 7661,
                    "col": 1,
                    "line": 278
                },
                "end": {
                    "char": 7687,
                    "col": 27,
                    "line": 278
                }
            },
            "name": "fluid_noise_count",
            "nodes": [
                {
                    "ast": "IntegerLiteral",
                    "loc": {
                        "begin": {
                            "char": 7685,
                            "col": 25,
                            "line": 278
                        },
                        "end": {
                            "char": 7687,
                            "col": 27,
                            "line": 278
                        }
                    },
                    "type": "int",
                    "value": 32
                }
            ],
            "type": "int"
        },
        {
            "ast": "VarDecl",
            "loc": {
                "begin": {
                    "char": 7689,
                    "col": 1,
                    "line": 279
                },
                "end": {
                    "char": 7716,
                    "col": 28,
                    "line": 279
                }
            },
            "name": "fluid_decay",
            "nodes": [
                {
                    "ast": "FloatingLiteral",
                    "loc": {
                        "begin": {
                            "char": 7709,
                            "col": 21,
                            "line": 279
                        },
                        "end": {
                            "char": 7716,
                            "col": 28,
                            "line": 279
                        }
                    },
                    "type": "float",
                    "value": 0.9998999834060669
                }
            ],
            "type": "float"
        },
        {
            "ast": "VarDecl",
            "comment": {
                "text": "//0.00001;"
            },
            "loc": {
                "begin": {
                    "char": 7718,
                    "col": 1,
                    "line": 280
                },
                "end": {
                    "char": 7753,
                    "col": 36,
                    "line": 280
                }
            },
            "name": "fluid_viscosity",
            "nodes": [
                {
                    "ast": "FloatingLiteral",
                    "loc": {
                        "begin": {
                            "char": 7743,
                            "col": 26,
                            "line": 280
                        },
                        "end": {
                            "char": 7753,
                            "col": 36,
                            "line": 280
                        }
                    },
                    "type": "double",
                    "value": 1e-08
                }
            ],
            "type": "double"
        },
        {
            "ast": "VarDecl",
            "loc": {
                "begin": {
                    "char": 7766,
                    "col": 1,
                    "line": 281
                },
                "end": {
                    "char": 7800,
                    "col": 35,
                    "line": 281
                }
            },
            "name": "fluid_boundary_damping",
            "nodes": [
                {
                    "ast": "FloatingLiteral",
                    "loc": {
                        "begin": {
                            "char": 7798,
                            "col": 33,
                            "line": 281
                        },
                        "end": {
                            "char": 7800,
                            "col": 35,
                            "line": 281
                        }
                    },
                    "type": "double",
                    "value": 0.2
                }
            ],
            "type": "double"
        },
        {
            "ast": "VarDecl",
            "loc": {
                "begin": {
                    "char": 7802,
                    "col": 1,
                    "line": 282
                },
                "end": {
                    "char": 7825,
                    "col": 24,
                    "line": 282
                }
            },
            "name": "fluid_noise",
            "nodes": [
                {
                    "ast": "FloatingLiteral",
                    "loc": {
                        "begin": {
                            "char": 7823,
                            "col": 22,
                            "line": 282
                        },
                        "end": {
                            "char": 7825,
                            "col": 24,
                            "line": 282
                        }
                    },
                    "type": "double",
                    "value": 8.0
                }
            ],
            "type": "double"
        },
        {
            "ast": "VarDecl",
            "loc": {
                "begin": {
                    "char": 7828,
                    "col": 1,
                    "line": 284
                },
                "end": {
                    "char": 7855,
                    "col": 28,
                    "line": 284
                }
            },
            "name": "density_decay",
            "nodes": [
                {
                    "ast": "FloatingLiteral",
                    "loc": {
                        "begin": {
                            "char": 7850,
                            "col": 23,
                            "line": 284
                        },
                        "end": {
                            "char": 7855,
                            "col": 28,
                            "line": 284
                        }
                    },
                    "type": "float",
                    "value": 0.9800000190734863
                }
            ],
            "type": "float"
        },
        {
            "ast": "VarDecl",
            "comment": {
                "text": "// somwhere between 0.1 and 0.01 seems to be good"
            },
            "loc": {
                "begin": {
                    "char": 7857,
                    "col": 1,
                    "line": 285
                },
                "end": {
                    "char": 7885,
                    "col": 29,
                    "line": 285
                }
            },
            "name": "density_diffuse",
            "nodes": [
                {
                    "ast": "FloatingLiteral",
                    "loc": {
                        "begin": {
                            "char": 7881,
                            "col": 25,
                            "line": 285
                        },
                        "end": {
                            "char": 7885,
                            "col": 29,
                            "line": 285
                        }
                    },
                    "type": "double"
                }
            ],
            "type": "float"
        },
        {
            "ast": "VarDecl",
            "loc": {
                "begin": {
                    "char": 7937,
                    "col": 1,
                    "line": 286
                },
                "end": {
                    "char": 7962,
                    "col": 26,
                    "line": 286
                }
            },
            "name": "density_scale",
            "nodes": [
                {
                    "ast": "FloatingLiteral",
                    "loc": {
                        "begin": {
                            "char": 7959,
                            "col": 23,
                            "line": 286
                        },
                        "end": {
                            "char": 7962,
                            "col": 26,
                            "line": 286
                        }
                    },
                    "type": "double"
                }
            ],
            "type": "float"
        },
        {
            "ast": "VarDecl",
            "loc": {
                "begin": {
                    "char": 7965,
                    "col": 1,
                    "line": 288
                },
                "end": {
                    "char": 7990,
                    "col": 26,
                    "line": 288
                }
            },
            "name": "simThread",
            "nodes": [
                {
                    "ast": "TypeRef",
                    "loc": {
                        "begin": {
                            "char": 7965,
                            "col": 1,
                            "line": 288
                        },
                        "end": {
                            "char": 7976,
                            "col": 12,
                            "line": 288
                        }
                    },
                    "name": "struct MetroThread",
                    "type": "MetroThread"
                },
                {
                    "ast": "CallExpr",
                    "loc": {
                        "begin": {
                            "char": 7977,
                            "col": 13,
                            "line": 288
                        },
                        "end": {
                            "char": 7990,
                            "col": 26,
                            "line": 288
                        }
                    },
                    "name": "MetroThread",
                    "nodes": [
                        {
                            "ast": "IntegerLiteral",
                            "loc": {
                                "begin": {
                                    "char": 7987,
                                    "col": 23,
                                    "line": 288
                                },
                                "end": {
                                    "char": 7989,
                                    "col": 25,
                                    "line": 288
                                }
                            },
                            "type": "int"
                        }
                    ],
                    "type": "MetroThread"
                }
            ],
            "type": "MetroThread"
        },
        {
            "ast": "VarDecl",
            "loc": {
                "begin": {
                    "char": 7992,
                    "col": 1,
                    "line": 289
                },
                "end": {
                    "char": 8019,
                    "col": 28,
                    "line": 289
                }
            },
            "name": "fluidThread",
            "nodes": [
                {
                    "ast": "TypeRef",
                    "loc": {
                        "begin": {
                            "char": 7992,
                            "col": 1,
                            "line": 289
                        },
                        "end": {
                            "char": 8003,
                            "col": 12,
                            "line": 289
                        }
                    },
                    "name": "struct MetroThread",
                    "type": "MetroThread"
                },
                {
                    "ast": "CallExpr",
                    "loc": {
                        "begin": {
                            "char": 8004,
                            "col": 13,
                            "line": 289
                        },
                        "end": {
                            "char": 8019,
                            "col": 28,
                            "line": 289
                        }
                    },
                    "name": "MetroThread",
                    "nodes": [
                        {
                            "ast": "IntegerLiteral",
                            "loc": {
                                "begin": {
                                    "char": 8016,
                                    "col": 25,
                                    "line": 289
                                },
                                "end": {
                                    "char": 8018,
                                    "col": 27,
                                    "line": 289
                                }
                            },
                            "type": "int"
                        }
                    ],
                    "type": "MetroThread"
                }
            ],
            "type": "MetroThread"
        },
        {
            "ast": "VarDecl",
            "loc": {
                "begin": {
                    "char": 8021,
                    "col": 1,
                    "line": 290
                },
                "end": {
                    "char": 8039,
                    "col": 19,
                    "line": 290
                }
            },
            "name": "isRunning",
            "nodes": [
                {
                    "ast": "IntegerLiteral",
                    "loc": {
                        "begin": {
                            "char": 8038,
                            "col": 18,
                            "line": 290
                        },
                        "end": {
                            "char": 8039,
                            "col": 19,
                            "line": 290
                        }
                    },
                    "type": "int"
                }
            ],
            "type": "bool"
        },
        {
            "ast": "VarDecl",
            "loc": {
                "begin": {
                    "char": 8042,
                    "col": 1,
                    "line": 292
                },
                "end": {
                    "char": 8059,
                    "col": 18,
                    "line": 292
                }
            },
            "name": "gBufferVR",
            "nodes": [
                {
                    "ast": "TypeRef",
                    "loc": {
                        "begin": {
                            "char": 8042,
                            "col": 1,
                            "line": 292
                        },
                        "end": {
                            "char": 8049,
                            "col": 8,
                            "line": 292
                        }
                    },
                    "name": "struct GBuffer",
                    "type": "GBuffer"
                },
                {
                    "ast": "CallExpr",
                    "loc": {
                        "begin": {
                            "char": 8050,
                            "col": 9,
                            "line": 292
                        },
                        "end": {
                            "char": 8059,
                            "col": 18,
                            "line": 292
                        }
                    },
                    "name": "GBuffer",
                    "type": "GBuffer"
                }
            ],
            "type": "GBuffer"
        },
        {
            "ast": "VarDecl",
            "loc": {
                "begin": {
                    "char": 8061,
                    "col": 1,
                    "line": 293
                },
                "end": {
                    "char": 8080,
                    "col": 20,
                    "line": 293
                }
            },
            "name": "gBufferProj",
            "nodes": [
                {
                    "ast": "TypeRef",
                    "loc": {
                        "begin": {
                            "char": 8061,
                            "col": 1,
                            "line": 293
                        },
                        "end": {
                            "char": 8068,
                            "col": 8,
                            "line": 293
                        }
                    },
                    "name": "struct GBuffer",
                    "type": "GBuffer"
                },
                {
                    "ast": "CallExpr",
                    "loc": {
                        "begin": {
                            "char": 8069,
                            "col": 9,
                            "line": 293
                        },
                        "end": {
                            "char": 8080,
                            "col": 20,
                            "line": 293
                        }
                    },
                    "name": "GBuffer",
                    "type": "GBuffer"
                }
            ],
            "type": "GBuffer"
        },
        {
            "ast": "FunctionDecl",
            "loc": {
                "begin": {
                    "char": 8083,
                    "col": 1,
                    "line": 295
                },
                "end": {
                    "char": 9479,
                    "col": 2,
                    "line": 341
                }
            },
            "mangled_name": "__Z17fluid_land_resistPN3glm5tvec3IfLNS_9precisionE0EEENS0_IiLS1_0EEEPfS4_",
            "name": "fluid_land_resist",
            "nodes": [
                {
                    "ast": "ParmDecl",
                    "loc": {
                        "begin": {
                            "char": 8106,
                            "col": 24,
                            "line": 295
                        },
                        "end": {
                            "char": 8128,
                            "col": 46,
                            "line": 295
                        }
                    },
                    "name": "velocities",
                    "nodes": [
                        {
                            "ast": "NamespaceRef",
                            "loc": {
                                "begin": {
                                    "char": 8106,
                                    "col": 24,
                                    "line": 295
                                },
                                "end": {
                                    "char": 8109,
                                    "col": 27,
                                    "line": 295
                                }
                            },
                            "name": "glm"
                        },
                        {
                            "ast": "TypeRef",
                            "loc": {
                                "begin": {
                                    "char": 8111,
                                    "col": 29,
                                    "line": 295
                                },
                                "end": {
                                    "char": 8115,
                                    "col": 33,
                                    "line": 295
                                }
                            },
                            "name": "glm::vec3",
                            "type": "glm::vec3"
                        }
                    ],
                    "type": "glm::vec3 *"
                },
                {
                    "ast": "ParmDecl",
                    "loc": {
                        "begin": {
                            "char": 8130,
                            "col": 48,
                            "line": 295
                        },
                        "end": {
                            "char": 8156,
                            "col": 74,
                            "line": 295
                        }
                    },
                    "name": "field_dim",
                    "nodes": [
                        {
                            "ast": "NamespaceRef",
                            "loc": {
                                "begin": {
                                    "char": 8136,
                                    "col": 54,
                                    "line": 295
                                },
                                "end": {
                                    "char": 8139,
                                    "col": 57,
                                    "line": 295
                                }
                            },
                            "name": "glm"
                        },
                        {
                            "ast": "TypeRef",
                            "loc": {
                                "begin": {
                                    "char": 8141,
                                    "col": 59,
                                    "line": 295
                                },
                                "end": {
                                    "char": 8146,
                                    "col": 64,
                                    "line": 295
                                }
                            },
                            "name": "glm::ivec3",
                            "type": "glm::ivec3"
                        }
                    ],
                    "type": "const glm::ivec3"
                },
                {
                    "ast": "ParmDecl",
                    "loc": {
                        "begin": {
                            "char": 8158,
                            "col": 76,
                            "line": 295
                        },
                        "end": {
                            "char": 8179,
                            "col": 97,
                            "line": 295
                        }
                    },
                    "name": "distancefield",
                    "type": "float *"
                },
                {
                    "ast": "ParmDecl",
                    "loc": {
                        "begin": {
                            "char": 8181,
                            "col": 99,
                            "line": 295
                        },
                        "end": {
                            "char": 8206,
                            "col": 124,
                            "line": 295
                        }
                    },
                    "name": "land_dim",
                    "nodes": [
                        {
                            "ast": "NamespaceRef",
                            "loc": {
                                "begin": {
                                    "char": 8187,
                                    "col": 105,
                                    "line": 295
                                },
                                "end": {
                                    "char": 8190,
                                    "col": 108,
                                    "line": 295
                                }
                            },
                            "name": "glm"
                        },
                        {
                            "ast": "TypeRef",
                            "loc": {
                                "begin": {
                                    "char": 8192,
                                    "col": 110,
                                    "line": 295
                                },
                                "end": {
                                    "char": 8197,
                                    "col": 115,
                                    "line": 295
                                }
                            },
                            "name": "glm::ivec3",
                            "type": "glm::ivec3"
                        }
                    ],
                    "type": "const glm::ivec3"
                },
                {
                    "ast": "CompoundStmt",
                    "loc": {
                        "begin": {
                            "char": 8208,
                            "col": 126,
                            "line": 295
                        },
                        "end": {
                            "char": 9479,
                            "col": 2,
                            "line": 341
                        }
                    },
                    "text": "{\n\n\t/* \n\t\tboundary effect of landscape: the closer we get to the landscape, \n\t\tthe more the velocities should be redirected away from the surface\n\n\n\n\n\t*/\n\n\tglm::vec3 field_dimf = glm::vec3(field_dim);\n\n\tint i = 0;\n\tfor (size_t z = 0; z<field_dim.z; z++) {\n\t\tfor (size_t y = 0; y<field_dim.y; y++) {\n\t\t\tfor (size_t x = 0; x<field_dim.x; x++, i++) {\n\t\t\t\t\n\t\t\t\t// get norm'd coordinate:\n\t\t\t\tglm::vec3 norm = glm::vec3(x,y,z) / field_dimf;\n\n\t\t\t\t// use this to sample the landscape:\n\t\t\t\tfloat sdist;\n\t\t\t\tal_field3d_readnorm_interp(land_dim, state->distance, norm, &sdist );\n\t\t\t\tfloat dist = fabsf(sdist);\n\n\t\t\t\t// generate a normalized influence factor -- the closer we are to the surface, the greater this is\n\t\t\t\t//float influence = glm::smoothstep(0.05f, 0.f, dist);\n\t\t\t\t// s is the amount of dist where the influence is 50%\n\t\t\t\tfloat s = 0.01f;\n\t\t\t\tfloat influence = s / (s + dist);\n\n\t\t\t\tglm::vec3& vel = velocities[i];\n\t\t\t\t\n\t\t\t\t// get a normal for the land:\n\t\t\t\t// TODO: or read from state->land xyz?\n\t\t\t\tglm::vec3 normal = sdf_field_normal4(land_dim, state->distance, norm, 2.f/LAND_DIM);\n\n\t\t\t\t// re-orient to be orthogonal to the land normal:\n\t\t\t\tglm::vec3 rescaled = make_orthogonal_to(vel, normal);\n\n\t\t\t\t// update:\n\t\t\t\tvel = mix(vel, rescaled, influence);\t\n\t\t\t}\n\t\t}\n\t}\n}"
                }
            ],
            "type": "void (glm::vec3 *, const glm::ivec3, float *, const glm::ivec3)",
            "type_args": [
                "glm::vec3 *",
                "const glm::ivec3",
                "float *",
                "const glm::ivec3"
            ],
            "type_ret": "void"
        },
        {
            "ast": "FunctionDecl",
            "loc": {
                "begin": {
                    "char": 9481,
                    "col": 1,
                    "line": 343
                },
                "end": {
                    "char": 9538,
                    "col": 58,
                    "line": 343
                }
            },
            "mangled_name": "__Z12fluid_updated",
            "name": "fluid_update",
            "nodes": [
                {
                    "ast": "ParmDecl",
                    "loc": {
                        "begin": {
                            "char": 9499,
                            "col": 19,
                            "line": 343
                        },
                        "end": {
                            "char": 9508,
                            "col": 28,
                            "line": 343
                        }
                    },
                    "name": "dt",
                    "type": "double"
                },
                {
                    "ast": "CompoundStmt",
                    "loc": {
                        "begin": {
                            "char": 9510,
                            "col": 30,
                            "line": 343
                        },
                        "end": {
                            "char": 9538,
                            "col": 58,
                            "line": 343
                        }
                    },
                    "text": "{ state->fluid_update(dt); }"
                }
            ],
            "type": "void (double)",
            "type_args": [
                "double"
            ],
            "type_ret": "void"
        },
        {
            "ast": "CXXMethod",
            "loc": {
                "begin": {
                    "char": 9540,
                    "col": 1,
                    "line": 345
                },
                "end": {
                    "char": 11936,
                    "col": 2,
                    "line": 412
                }
            },
            "mangled_name": "__ZN5State12fluid_updateEf",
            "name": "fluid_update",
            "nodes": [
                {
                    "ast": "TypeRef",
                    "loc": {
                        "begin": {
                            "char": 9545,
                            "col": 6,
                            "line": 345
                        },
                        "end": {
                            "char": 9550,
                            "col": 11,
                            "line": 345
                        }
                    },
                    "name": "struct State",
                    "type": "State"
                },
                {
                    "ast": "ParmDecl",
                    "loc": {
                        "begin": {
                            "char": 9565,
                            "col": 26,
                            "line": 345
                        },
                        "end": {
                            "char": 9573,
                            "col": 34,
                            "line": 345
                        }
                    },
                    "name": "dt",
                    "type": "float"
                },
                {
                    "ast": "CompoundStmt",
                    "loc": {
                        "begin": {
                            "char": 9575,
                            "col": 36,
                            "line": 345
                        },
                        "end": {
                            "char": 11936,
                            "col": 2,
                            "line": 412
                        }
                    },
                    "text": "{\n\t\n\tconst glm::ivec3 dim = fluidpod.dim();\n\t// diffuse the velocities (viscosity)\n\tfluidpod.velocities.swap();\n\tal_field3d_diffuse(dim, fluidpod.velocities.back(), fluidpod.velocities.front(), fluid_viscosity, fluid_passes);\n\n\t// stabilize:\n\t// prepare new gradient data:\n\tal_field3d_zero(dim, fluidpod.gradient.back());\n\tal_field3d_derive_gradient(dim, fluidpod.velocities.back(), fluidpod.gradient.back()); \n\t// diffuse it:\n\tal_field3d_diffuse(dim, fluidpod.gradient.back(), fluidpod.gradient.front(), 0.5, fluid_passes / 2);\n\t// subtract from current velocities:\n\tal_field3d_subtract_gradient(dim, fluidpod.gradient.front(), fluidpod.velocities.front());\n\t\n\t// advect:\n\tfluidpod.velocities.swap(); \n\tal_field3d_advect(dim, fluidpod.velocities.front(), fluidpod.velocities.back(), fluidpod.velocities.front(), 1.);\n\n\t// apply boundaries:\n\tfluid_land_resist(fluidpod.velocities.front(), dim, distance, land_dim);\n\n\t// friction:\n\tal_field3d_scale(dim, fluidpod.velocities.front(), glm::vec3(fluid_decay));\n\t\n\n\t/*\n\t// update fluid\n\tField3D<>& velocities = fluid.velocities;\n\tconst size_t dim0 = velocities.dimx();\n\tconst size_t dim1 = velocities.dimy();\n\tconst size_t dim2 = velocities.dimz();\n\tglm::vec3 * data = (glm::vec3 *)velocities.front().ptr();\n\t//float * boundary = boundary;\n\n\t// and some turbulence:\n\tif (0) {\n\t\tfor (int i=0; i < rnd::integer(fluid_noise_count); i++) {\n\t\t\t// pick a cell at random:\n\t\t\tglm::vec3 * cell = data + (size_t)rnd::integer(dim0*dim1*dim2);\n\t\t\t// add a random vector:\n\t\t\t*cell = glm::sphericalRand(rnd::uni((float)fluid_noise));\n\t\t}\n\t}\n\n\t//apply_fluid_boundary2(data, (glm::vec4 *)landscape.ptr(), dim0, dim1, dim2);\n\tvelocities.diffuse(fluid_viscosity, fluid_passes);\n\t// apply boundaries:\n\t//apply_fluid_boundary2(data, boundary, dim0, dim1, dim2);\n\t//apply_fluid_boundary2(data, (glm::vec4 *)landscape.ptr(), dim0, dim1, dim2);\n\t// stabilize:\n\tfluid.project(fluid_passes / 2);\n\t// advect:\n\tvelocities.advect(velocities.back(), 1.);\n\n\tfluid_land_resist((glm::vec3 *)velocities.front().data, field_dim, state->distance, land_dim);\n\n\t// apply boundaries:\n\t//apply_fluid_boundary2(data, boundary, dim0, dim1, dim2);\n\t//apply_fluid_boundary2(data, (glm::vec4 *)landscape.ptr(), dim0, dim1, dim2);\n\tvelocities.front().scale(fluid_decay);\n\n\t// clear gradients:\n\tfluid.gradient.front().zero();\n\tfluid.gradient.back().zero();\n\t*/\n}"
                }
            ],
            "type": "void (float)",
            "type_args": [
                "float"
            ],
            "type_ret": "void"
        },
        {
            "ast": "FunctionDecl",
            "loc": {
                "begin": {
                    "char": 11938,
                    "col": 1,
                    "line": 414
                },
                "end": {
                    "char": 13590,
                    "col": 2,
                    "line": 462
                }
            },
            "mangled_name": "__Z13fungus_updatef",
            "name": "fungus_update",
            "nodes": [
                {
                    "ast": "ParmDecl",
                    "loc": {
                        "begin": {
                            "char": 11957,
                            "col": 20,
                            "line": 414
                        },
                        "end": {
                            "char": 11965,
                            "col": 28,
                            "line": 414
                        }
                    },
                    "name": "dt",
                    "type": "float"
                },
                {
                    "ast": "CompoundStmt",
                    "loc": {
                        "begin": {
                            "char": 11967,
                            "col": 30,
                            "line": 414
                        },
                        "end": {
                            "char": 13590,
                            "col": 2,
                            "line": 462
                        }
                    },
                    "text": "{\n\tconst glm::ivec2 dim = glm::ivec2(FUNGUS_DIM, FUNGUS_DIM);\n\tauto & src_array = state->fungus;\n\tauto & dst_array = state->fungus_old;\n\n\t//float * land = state->\n\n\tfor (int i=0, y=0; y<dim.y; y++) {\n\t\tfor (int x=0; x<dim.x; x++, i++) {\n\t\t\tconst glm::vec2 cell = glm::vec2(float(x),float(y));\t\t\t\n\t\t\tconst glm::vec2 norm = cell/glm::vec2(dim); // TODO convert to premultiplier\n\t\t\tfloat C = src_array[i];\n\t\t\tfloat C1 = C - 0.1;\n\t\t\t//float h = 20 * .1;//heightmap_array.sample(norm);\n\t\t\tglm::vec4 l;\n\t\t\tal_field2d_readnorm_interp(glm::ivec2(LAND_DIM, LAND_DIM), state->land, norm, &l);\n\t\t\tfloat h = 20.f * l.w;\n\t\t\tfloat hu = 0.;//humanmap_array.sample(norm);\n\t\t\tfloat dst = C;\n\t\t\tif (h <= 0 || hu > 0.1) {\n\t\t\t\t// force lowlands to be vacant\n\t\t\t\t// (note, human will also do this)\n\t\t\t\tdst = 0;\n\t\t\t} else if (C < -0.1) {\n\t\t\t\t// very negative values gradually drift back to zero\n\t\t\t\tdst = C * 0.999;\n\t\t\t} else if (C < 0) {\n\t\t\t\t// and then jump to zero when in [-0.1,0) range\n\t\t\t\tdst = 0;\n\t\t\t} else if (h < C1 || rnd::uni() < 0.00005*h) {\n\t\t\t\t// if land lower than vitality, decrease vitality\n\t\t\t\t// also random chance of decay for any living cell\n\t\t\t\tdst = h*rnd::uni();\n\t\t\t} else if (rnd::uni() < 0.06*h) {\n\t\t\t\t// migration chance increases with altitude\n\t\t\t\t// pick a neighbour cell:\n\t\t\t\tglm::vec2 tc = cell + glm::vec2(floor(rnd::uni()*3)-1, floor(rnd::uni()*3)-1);\n\t\t\t\tfloat tv = al_field2d_read(dim, src_array, tc); //src_array.samplepix(tc);\n\t\t\t\t// if alive, copy it\n\t\t\t\tif (tv > 0.) { dst = tv; }\n\t\t\t}\n\t\t\tdst_array[i] = dst;\n\t\t}\n\t}\n\n\tmemcpy(src_array, dst_array, sizeof(state->fungus));\n\n\t//fungus_write = !fungus_write;\n}"
                }
            ],
            "type": "void (float)",
            "type_args": [
                "float"
            ],
            "type_ret": "void"
        },
        {
            "ast": "FunctionDecl",
            "loc": {
                "begin": {
                    "char": 13592,
                    "col": 1,
                    "line": 464
                },
                "end": {
                    "char": 19849,
                    "col": 2,
                    "line": 655
                }
            },
            "mangled_name": "__Z10sim_updatef",
            "name": "sim_update",
            "nodes": [
                {
                    "ast": "ParmDecl",
                    "loc": {
                        "begin": {
                            "char": 13608,
                            "col": 17,
                            "line": 464
                        },
                        "end": {
                            "char": 13616,
                            "col": 25,
                            "line": 464
                        }
                    },
                    "name": "dt",
                    "type": "float"
                },
                {
                    "ast": "CompoundStmt",
                    "loc": {
                        "begin": {
                            "char": 13618,
                            "col": 27,
                            "line": 464
                        },
                        "end": {
                            "char": 19849,
                            "col": 2,
                            "line": 655
                        }
                    },
                    "text": "{\n\n\t// inverse dt gives rate (per second)\n\tfloat idt = 1.f/dt;\n\n\n\tconst Alice& alice = Alice::Instance();\n\tif (!alice.isSimulating) return;\n\n\tauto& kinect0 = alice.cloudDeviceManager.devices[0];\n\tauto& kinect1 = alice.cloudDeviceManager.devices[1];\n\n\t// \n\tal_field3d_scale(field_dim, state->density, glm::vec3(density_decay));\n\tal_field3d_diffuse(field_dim, state->density, state->density, density_diffuse);\n\tmemcpy(state->density_back, state->density, sizeof(glm::vec3) * FIELD_VOXELS);\n\n\tfungus_update(dt);\n\n\t// get the most recent complete frame:\n\t\n\tflip = !flip;\n\tconst CloudDevice& cd = alice.cloudDeviceManager.devices[flip];\n\tconst CloudFrame& cloudFrame = cd.cloudFrame();\n\tconst glm::vec3 * cloud_points = cloudFrame.xyz;\n\tconst glm::vec2 * uv_points = cloudFrame.uv;\n\tconst glm::vec3 * rgb_points = cloudFrame.rgb;\n\tuint64_t max_cloud_points = sizeof(cloudFrame.xyz)/sizeof(glm::vec3);\n\tglm::vec3 kinectloc = world_centre + glm::vec3(0,0,-4);\n\t\t\n\tif (1) {\n\t\tfor (int i=0; i<NUM_PARTICLES; i++) {\n\t\t\tParticle &o = state->particles[i];\n\n\t\t\t// get norm'd coordinate:\n\t\t\tglm::vec3 norm = transform(world2field, o.location);\n\n\t\t\t//glm::vec3 flow;\n\t\t\t//fluid.velocities.front().readnorm(transform(world2field, o.location), &flow.x);\n\t\t\tglm::vec3 flow = al_field3d_readnorm_interp(field_dim, state->fluidpod.velocities.front(), norm);\n\n\t\t\t// noise:\n\t\t\tflow += glm::sphericalRand(0.0002f);\n\t\t\t\n\t\t\to.velocity = flow * idt;\n\n\t\t\tif (cd.capturing && i < max_cloud_points) {\n\t\t\t\tuint64_t idx = i % max_cloud_points;\n\t\t\t\tglm::vec3 p = cloud_points[idx];\n\n\t\t\t\t//if (i == rnd::integer(max_cloud_points)) { console.log(\"                        p.z %f %f %f\", p.x, p.y, p.z); }\n\n\t\t\t\tif (p.z > 1.f) {\n\t\t\t\t\to.location = p + kinectloc;\n\t\t\t\t\to.color =  glm::vec3(uv_points[idx], 0.5f);\n\t\t\t\t\t// o.color = rgb_points[i] + 0.5f;\n\t\t\t\t\to.velocity = glm::vec3(0);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\t// sometimes assign to a random creature?\n\t\t\t\tif (rnd::uni() < 0.0001/NUM_PARTICLES) {\n\t\t\t\t\tint idx = i % NUM_OBJECTS;\n\t\t\t\t\to.location = state->objects[idx].location;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t} else {\n\n\t\tif (cd.capturing) {\n\t\t\tfor (int idx=0; idx<max_cloud_points; idx++) {\n\t\t\t\tglm::vec3 p = cloud_points[idx];\n\t\t\t\tif (p.z > 1.f) {\n\t\t\t\t\tParticle &o = state->particles[kidx];\n\t\t\t\t\to.location = p + kinectloc;\n\t\t\t\t\to.color = glm::vec3(uv_points[idx], 0.5f);\n\n\t\t\t\t\tif (idx == rnd::integer(max_cloud_points)) { console.log(\"p.z %f %d %d ||| %d %d\", p.z, idx, kidx, cd.lastCloudFrame, cd.lastColourFrame); }\n\n\t\t\t\t\tkidx++;\n\t\t\t\t\tif (kidx >= NUM_PARTICLES) kidx = 0;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t} \n\n\t// simulate creatures:\n\tfor (int i=0; i<NUM_OBJECTS; i++) {\n\t\tauto &o = state->objects[i];\n\n\t\t// get norm'd coordinate:\n\t\tglm::vec3 norm = transform(world2field, o.location);\n\n\t\t// get fluid flow:\n\t\t//glm::vec3 flow;\n\t\t//fluid.velocities.front().readnorm(norm, &flow.x);\n\t\tglm::vec3 flow = al_field3d_readnorm_interp(field_dim, state->fluidpod.velocities.front(), norm);\n\n\t\t// get my distance from the ground:\n\t\tfloat sdist; // creature's distance above the ground (or negative if below)\n\t\tal_field3d_readnorm_interp(land_dim, state->distance, norm, &sdist);\n\n\t\t// convert to meters per second:\n\t\t// (why is this needed? shouldn't it be m/s already?)\n\t\tflow *= idt;\n\n\t\tfloat gravity = 2.0f;\n\t\to.accel.y -= gravity; //glm::mix(o.accel.y, newrise, 0.04f);\n\t\tif (sdist < (o.scale * 0.025f)) { //(o.scale * rnd::uni(2.f))) {\n\t\t\t// jump!\n\t\t\tfloat jump = rnd::uni();\n\t\t\to.accel.y = jump * gravity * 2.f * o.scale;\n\n\t\t\t// this is a good time to also emit a pulse:\n\t\t\tal_field3d_addnorm_interp(field_dim, state->density, norm, o.color * density_scale * jump);\n\t\t}\n\n\t\t// set my velocity, in meters per second:\n\t\to.velocity = flow + o.accel*dt;\n\t\t\n\t\t// wander:\n\t\to.orientation = safe_normalize(glm::slerp(o.orientation, quat_random() * o.orientation, 0.025f));\n\n\t\t// get a normal for the land:\n\t\tglm::vec3 normal = sdf_field_normal4(land_dim, state->distance, norm, 0.05f/LAND_DIM);\n\t\t// re-orient relative to ground:\n\t\to.orientation = glm::slerp(o.orientation, align_up_to(o.orientation, normal), 0.2f);\n\t\t\t\n\t\t// add my direction to the fluid current\n\t\tglm::vec3 push = quat_uf(o.orientation) * (creature_fluid_push * (float)dt);\n\t\t//fluid.velocities.front().addnorm(norm, &push.x);\n\t\tal_field3d_addnorm_interp(field_dim, state->fluidpod.velocities.front(), norm, push);\n\t}\n\n\n\t//if(accel == 1)state->objects[0].velocity += state->objects[0].velocity;\n\t//else if(decel == 1)state->objects[0].velocity -= state->objects[0].velocity * glm::vec3(2.);\n\n\tfor (int i=0; i<NUM_SEGMENTS; i++) {\n\t\tauto &o = state->segments[i];\n\t\tif (i % 8 == 0) {\n\t\t\t// a root;\n\t\t\t\n\t\t\t/*\n\t\t\tglm::vec3 fluidloc = transform(world2field, o.location);\n\t\t\tglm::vec3 flow;\n\t\t\tfluid.velocities.front().readnorm(fluidloc, &flow.x);\n\t\t\tglm::vec3 push = quat_uf(o.orientation) * (creature_fluid_push * (float)dt);\n\t\t\tfluid.velocities.front().addnorm(fluidloc, &push.x);\n\t\t\to.velocity = flow * idt;\n\n\t\t\tal_field3d_addnorm_interp(field_dim, state->density, fluidloc, o.color * density_scale * 0.02f);\n\t\t\t*/\n\n\n\t\t\t// get norm'd coordinate:\n\t\t\tglm::vec3 norm = transform(world2field, o.location);\n\n\t\t\t// get fluid flow:\n\t\t\t//glm::vec3 flow;\n\t\t\t//fluid.velocities.front().readnorm(norm, &flow.x);\n\t\t\tglm::vec3 flow = al_field3d_readnorm_interp(field_dim, state->fluidpod.velocities.front(), norm);\n\n\t\t\t// get my distance from the ground:\n\t\t\tfloat sdist; // creature's distance above the ground (or negative if below)\n\t\t\tal_field3d_readnorm_interp(land_dim, state->distance, norm, &sdist);\n\n\t\t\t// convert to meters per second:\n\t\t\tflow *= idt;\n\n\t\t\t// if below ground, rise up;\n\t\t\t// if above ground, sink down:\n\t\t\tfloat gravity = 0.1f;\n\t\t\tflow.y += sdist < 0.1f ? gravity : -gravity;\n\n\t\t\t// set my velocity, in meters per second:\n\t\t\to.velocity = flow;\n\t\t\t//if(accel == 1) o.velocity += o.velocity;\n\t\t\t//else if (decel == 1) o.velocity -= o.velocity * glm::vec3(2.);\n\n\t\t\t// use this to sample the landscape:\n\t\t\t\n\t\t\t// get a normal for the land:\n\t\t\tglm::vec3 normal = sdf_field_normal4(land_dim, state->distance, norm, 0.05f/LAND_DIM);\n\t\t\t// re-orient relative to ground:\n\t\t\to.orientation = glm::slerp(o.orientation, align_up_to(o.orientation, normal), 0.2f);\n\t\t\t\n\t\t} else {\n\t\t\tauto& p = state->segments[i-1];\n\t\t\to.scale = p.scale * 0.9f;\n\t\t}\n\t}\n}"
                }
            ],
            "type": "void (float)",
            "type_args": [
                "float"
            ],
            "type_ret": "void"
        },
        {
            "ast": "FunctionDecl",
            "loc": {
                "begin": {
                    "char": 19852,
                    "col": 1,
                    "line": 658
                },
                "end": {
                    "char": 20710,
                    "col": 2,
                    "line": 696
                }
            },
            "mangled_name": "__Z11onUnloadGPUv",
            "name": "onUnloadGPU",
            "nodes": [
                {
                    "ast": "CompoundStmt",
                    "loc": {
                        "begin": {
                            "char": 19871,
                            "col": 20,
                            "line": 658
                        },
                        "end": {
                            "char": 20710,
                            "col": 2,
                            "line": 696
                        }
                    },
                    "text": "{\n\t// free resources:\n\tlandShader.dest_closing();\n\theightMeshShader.dest_closing();\n\tparticleShader.dest_closing();\n\tobjectShader.dest_closing();\n\tsegmentShader.dest_closing();\n\tdeferShader.dest_closing();\n\tsimpleShader.dest_closing();\n\n\tquadMesh.dest_closing();\n\tcubeVBO.dest_closing();\n\tobjectInstancesVBO.dest_closing();\n\tobjectVAO.dest_closing();\n\tsegmentInstancesVBO.dest_closing();\n\tsegmentVAO.dest_closing();\n\tparticlesVAO.dest_closing();\n\tdebugVAO.dest_closing();\n\n\tfluidTex.dest_closing();\n\tdensityTex.dest_closing();\n\tdistanceTex.dest_closing();\n\tfungusTex.dest_closing();\n\tlandTex.dest_closing();\n\n\tprojFBOs[0].dest_closing();\n\tprojFBOs[1].dest_closing();\n\n\tgBufferVR.dest_closing();\n\tgBufferProj.dest_closing();\n\tAlice::Instance().hmd->dest_closing();\n\n\tif (colorTex) {\n\t\tglDeleteTextures(1, &colorTex);\n\t\tcolorTex = 0;\n\t}\n\n\t\n}"
                }
            ],
            "type": "void ()",
            "type_args": [],
            "type_ret": "void"
        },
        {
            "ast": "FunctionDecl",
            "loc": {
                "begin": {
                    "char": 20712,
                    "col": 1,
                    "line": 698
                },
                "end": {
                    "char": 24692,
                    "col": 2,
                    "line": 831
                }
            },
            "mangled_name": "__Z11onReloadGPUv",
            "name": "onReloadGPU",
            "nodes": [
                {
                    "ast": "CompoundStmt",
                    "loc": {
                        "begin": {
                            "char": 20731,
                            "col": 20,
                            "line": 698
                        },
                        "end": {
                            "char": 24692,
                            "col": 2,
                            "line": 831
                        }
                    },
                    "text": "{\n\n\tonUnloadGPU();\n\n\tsimpleShader.readFiles(\"simple.vert.glsl\", \"simple.frag.glsl\");\n\tobjectShader.readFiles(\"object.vert.glsl\", \"object.frag.glsl\");\n\tsegmentShader.readFiles(\"segment.vert.glsl\", \"segment.frag.glsl\");\n\tparticleShader.readFiles(\"particle.vert.glsl\", \"particle.frag.glsl\");\n\tlandShader.readFiles(\"land.vert.glsl\", \"land.frag.glsl\");\n\theightMeshShader.readFiles(\"hmesh.vert.glsl\", \"hmesh.frag.glsl\");\n\tdeferShader.readFiles(\"defer.vert.glsl\", \"defer.frag.glsl\");\n\tdebugShader.readFiles(\"debug.vert.glsl\", \"debug.frag.glsl\");\n\t\n\tquadMesh.dest_changed();\n\n\ttableVAO.bind();\n\ttableVBO.bind();\n\ttableVBO.submit(&tableObj.vertices[0], sizeof(Vertex) * tableObj.vertices.size());\n\ttableEBO.submit(&tableObj.indices[0], tableObj.indices.size());\n\ttableEBO.bind();\n\ttableVAO.attr(0, &Vertex::position);\n\ttableVAO.attr(1, &Vertex::normal);\n\ttableVAO.attr(2, &Vertex::texcoord);\n\n\tgridVAO.bind();\n\t{\n\t\tconst int dim = LAND_DIM+1;\n\t\tgridVertices.resize(dim*dim);\n\t\t\n\t\tconst glm::vec3 normalizer = 1.f/glm::vec3(dim, 1.f, dim);\n\n\t\tfor (int i=0, y=0; y<dim; y++) {\n\t\t\tfor (int x=0; x<dim; x++) {\n\t\t\t\tVertex& v = gridVertices[i++];\n\t\t\t\tv.position = glm::vec3(x, 0, y) * normalizer;\n\t\t\t\tv.normal = glm::vec3(0, 1, 0);\n\t\t\t\t// depends whether wrapping or not, divide dim or dim+1?\n\t\t\t\tv.texcoord = glm::vec2(v.position.x, v.position.z);\n\t\t\t}\n\t\t}\n\t\tgridVBO.submit((void *)&gridVertices[0], sizeof(Vertex) * gridVertices.size());\n\n\t\t/*\n\t\t\te.g.: 2x2 squares:\n\t\t\t0 1 2\n\t\t\t3 4 5\n\t\t\t6 7 8\n\n\t\t\tdim = 3x3 vertices\n\t\t\telements = 2x2 squares * 2 tris * 3 verts:\n\t\t\t034 410, 145 521\n\t\t\t367 743, 478 854\n\t\t*/\n\t\tgrid_elements = (dim-1) * (dim-1) * 6;\n\t\tgridElements.resize(grid_elements);\n\t\tint i=0;\n\t\tfor (unsigned int y=0; y<dim-1; y++) {\n\t\t\tfor (unsigned int x=0; x<dim-1; x++) {\n\t\t\t\tunsigned int p00 = (y*dim) + (x);\n\t\t\t\tunsigned int p01 = p00 + 1;\n\t\t\t\tunsigned int p10 = p00 + dim;\n\t\t\t\tunsigned int p11 = p00 + dim + 1;\n\t\t\t\t// tri 1:\n\t\t\t\tgridElements[i++] = p00;\n\t\t\t\tgridElements[i++] = p10;\n\t\t\t\tgridElements[i++] = p11;\n\t\t\t\t// tri 2:\n\t\t\t\tgridElements[i++] = p11;\n\t\t\t\tgridElements[i++] = p01;\n\t\t\t\tgridElements[i++] = p00;\n\t\t\t}\n\t\t}\n\t\tgridEBO.submit(&gridElements[0], gridElements.size());\n\t}\n\n\tgridVBO.bind();\n\tgridEBO.bind();\n\tgridVAO.attr(0, &Vertex::position);\n\tgridVAO.attr(1, &Vertex::normal);\n\tgridVAO.attr(2, &Vertex::texcoord);\n\n\tobjectVAO.bind();\n\tcubeVBO.bind();\n\tobjectVAO.attr(0, 3, GL_FLOAT, sizeof(glm::vec3), 0);\n\tobjectInstancesVBO.bind();\n\tobjectVAO.attr(2, &Object::location, true);\n\tobjectVAO.attr(3, &Object::orientation, true);\n\tobjectVAO.attr(4, &Object::scale, true);\n\tobjectVAO.attr(5, &Object::phase, true);\n\tobjectVAO.attr(6, &Object::color, true);\n\t\t\n\tsegmentVAO.bind();\n\tcubeVBO.bind();\n\tsegmentVAO.attr(0, 3, GL_FLOAT, sizeof(glm::vec3), 0);\n\tsegmentInstancesVBO.bind();\n\tsegmentVAO.attr(2, &Segment::location, true);\n\tsegmentVAO.attr(3, &Segment::orientation, true);\n\tsegmentVAO.attr(4, &Segment::scale, true);\n\tsegmentVAO.attr(5, &Segment::phase, true);\n\tsegmentVAO.attr(6, &Segment::color, true);\n\n\tparticlesVAO.bind();\n\tparticlesVBO.bind();\n\tparticlesVAO.attr(0, &Particle::location);\n\tparticlesVAO.attr(1, &Particle::color);\n\n\tdebugVAO.bind();\n\tdebugVBO.bind();\n\tdebugVAO.attr(0, &DebugDot::location);\n\tdebugVAO.attr(1, &DebugDot::color);\n\n\tlandTex.wrap = GL_CLAMP_TO_EDGE;\n\tdistanceTex.wrap = GL_CLAMP_TO_EDGE;\n\n\t{\n\t\tglGenTextures(1, &colorTex);\n\t\tglBindTexture(GL_TEXTURE_2D, colorTex);\n\t\tglTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_MIN_FILTER, GL_LINEAR);\t\n\t\tglTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_MAG_FILTER, GL_LINEAR);\t\n\t\tglTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_WRAP_S, GL_CLAMP_TO_EDGE);  \n\t\tglTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_WRAP_T, GL_CLAMP_TO_EDGE);  \n\t\t//glTexParameteri( GL_TEXTURE_3D, GL_GENERATE_MIPMAP, GL_TRUE ); \n\t\tglBindTexture(GL_TEXTURE_2D, 0);\n\t}\n\n\tprojFBOs[0].dest_changed();\n\tprojFBOs[1].dest_changed();\n\n\tgBufferVR.dest_changed();\n\tgBufferProj.dest_changed();\n\t\n\tAlice::Instance().hmd->dest_changed();\n\n}"
                }
            ],
            "type": "void ()",
            "type_args": [],
            "type_ret": "void"
        },
        {
            "ast": "FunctionDecl",
            "loc": {
                "begin": {
                    "char": 24694,
                    "col": 1,
                    "line": 833
                },
                "end": {
                    "char": 28475,
                    "col": 2,
                    "line": 946
                }
            },
            "mangled_name": "__Z10draw_sceneii",
            "name": "draw_scene",
            "nodes": [
                {
                    "ast": "ParmDecl",
                    "loc": {
                        "begin": {
                            "char": 24710,
                            "col": 17,
                            "line": 833
                        },
                        "end": {
                            "char": 24719,
                            "col": 26,
                            "line": 833
                        }
                    },
                    "name": "width",
                    "type": "int"
                },
                {
                    "ast": "ParmDecl",
                    "loc": {
                        "begin": {
                            "char": 24721,
                            "col": 28,
                            "line": 833
                        },
                        "end": {
                            "char": 24731,
                            "col": 38,
                            "line": 833
                        }
                    },
                    "name": "height",
                    "type": "int"
                },
                {
                    "ast": "CompoundStmt",
                    "loc": {
                        "begin": {
                            "char": 24733,
                            "col": 40,
                            "line": 833
                        },
                        "end": {
                            "char": 28475,
                            "col": 2,
                            "line": 946
                        }
                    },
                    "text": "{\n\tdouble t = Alice::Instance().simTime;\n\n\tdistanceTex.bind(4);\n\tfungusTex.bind(5);\n\tlandTex.bind(6);\n\tfluidTex.bind(7);\n\n\tif (0) {\n\t\tsimpleShader.use();\n\t\tsimpleShader.uniform(\"uViewProjectionMatrix\", viewProjMat);\n\t\ttableVAO.drawElements(tableObj.indices.size());\n\t}\n\n\tif (1) {\n\t\theightMeshShader.use();\n\t\theightMeshShader.uniform(\"uViewProjectionMatrix\", viewProjMat);\n\t\theightMeshShader.uniform(\"uViewProjectionMatrixInverse\", viewProjMatInverse);\n\t\theightMeshShader.uniform(\"uLandMatrix\", world2field);\n\t\theightMeshShader.uniform(\"uLandMatrixInverse\", field2world);\n\t\theightMeshShader.uniform(\"uDistanceTex\", 4);\n\t\theightMeshShader.uniform(\"uFungusTex\", 5);\n\t\theightMeshShader.uniform(\"uLandTex\", 6);\n\n\t\tglPolygonMode(GL_FRONT_AND_BACK, GL_LINE);\n\t\tgridVAO.drawElements(grid_elements);\n\t\tglPolygonMode(GL_FRONT_AND_BACK, GL_FILL);\n\t}\n\n\tif (0) {\n\t\tlandShader.use();\n\t\tlandShader.uniform(\"time\", t);\n\t\tlandShader.uniform(\"uViewProjectionMatrix\", viewProjMat);\n\t\tlandShader.uniform(\"uViewProjectionMatrixInverse\", viewProjMatInverse);\n\t\tlandShader.uniform(\"uNearClip\", near_clip);\n\t\tlandShader.uniform(\"uFarClip\", far_clip);\n\t\tlandShader.uniform(\"uDistanceTex\", 4);\n\t\tlandShader.uniform(\"uFungusTex\", 5);\n\t\tlandShader.uniform(\"uLandTex\", 6);\n\t\tlandShader.uniform(\"uLandMatrix\", world2field);\n\t\tquadMesh.draw();\n\t}\n\n\tdistanceTex.unbind(4);\n\tfungusTex.unbind(5);\n\tlandTex.unbind(6);\n\n\tif (0) {\n\t\tobjectShader.use();\n\t\tobjectShader.uniform(\"time\", t);\n\t\tobjectShader.uniform(\"uViewMatrix\", viewMat);\n\t\tobjectShader.uniform(\"uViewProjectionMatrix\", viewProjMat);\n\t\tobjectShader.uniform(\"uFluidTex\", 7);\n\t\tobjectShader.uniform(\"uFluidMatrix\", world2field);\n\t\tobjectVAO.drawInstanced(sizeof(positions_cube) / sizeof(glm::vec3), NUM_OBJECTS);\n\t}\n\n\tif (0) {\n\t\tsegmentShader.use();\n\t\tsegmentShader.uniform(\"time\", t);\n\t\tsegmentShader.uniform(\"uEyePos\", eyePos);\n\t\tsegmentShader.uniform(\"uMini2World\", mini2world);\n\t\tsegmentShader.uniform(\"uViewMatrix\", viewMat);\n\t\tsegmentShader.uniform(\"uViewProjectionMatrix\", viewProjMat);\n\t\tsegmentVAO.drawInstanced(sizeof(positions_cube) / sizeof(glm::vec3), NUM_SEGMENTS);\n\t}\n\n\tif (0) {\n\t\tparticleShader.use(); \n\t\tparticleShader.uniform(\"time\", t);\n\t\tparticleShader.uniform(\"uViewMatrix\", viewMat);\n\t\tparticleShader.uniform(\"uViewMatrixInverse\", viewMatInverse);\n\t\tparticleShader.uniform(\"uProjectionMatrix\", projMat);\n\t\tparticleShader.uniform(\"uViewProjectionMatrix\", viewProjMat);\n\t\tparticleShader.uniform(\"uViewPortHeight\", (float)height);\n\t\tparticleShader.uniform(\"uPointSize\", particleSize);\n\t\tparticleShader.uniform(\"uColorTex\", 0);\n\n\t\tglActiveTexture(GL_TEXTURE0);\n\t\tglBindTexture(GL_TEXTURE_2D, colorTex);\n\t\tglEnable( GL_PROGRAM_POINT_SIZE );\n\t\tglEnable(GL_POINT_SPRITE);\n\t\tglTexEnvi(GL_POINT_SPRITE, GL_COORD_REPLACE, GL_TRUE);\n\t\tparticlesVAO.draw(NUM_PARTICLES, GL_POINTS);\n\t\tglDisable(GL_VERTEX_PROGRAM_POINT_SIZE);\n\t\tglDisable(GL_POINT_SPRITE);\n\t\tglActiveTexture(GL_TEXTURE0);\n\t\tglBindTexture(GL_TEXTURE_2D, 0);\n\t}\n\n\tif (1) {\n\t\tdebugShader.use(); \n\t\tdebugShader.uniform(\"uViewMatrix\", viewMat);\n\t\tdebugShader.uniform(\"uViewMatrixInverse\", viewMatInverse);\n\t\tdebugShader.uniform(\"uProjectionMatrix\", projMat);\n\t\tdebugShader.uniform(\"uViewProjectionMatrix\", viewProjMat);\n\t\tdebugShader.uniform(\"uViewPortHeight\", (float)height);\n\t\tdebugShader.uniform(\"uPointSize\", particleSize * 8.);\n\t\tdebugShader.uniform(\"uColorTex\", 0);\n\n\t\tglBindTexture(GL_TEXTURE_2D, colorTex);\n\t\tglEnable( GL_PROGRAM_POINT_SIZE );\n\t\tglEnable(GL_POINT_SPRITE);\n\t\tglTexEnvi(GL_POINT_SPRITE, GL_COORD_REPLACE, GL_TRUE);\n\t\tdebugVAO.draw(NUM_PARTICLES, GL_POINTS);\n\t\tglDisable(GL_VERTEX_PROGRAM_POINT_SIZE);\n\t\tglDisable(GL_POINT_SPRITE);\n\t\tglBindTexture(GL_TEXTURE_2D, 0);\n\n\t\tglDisable(GL_CULL_FACE);\n\t}\n\n\tglDisable(GL_CULL_FACE);\n}"
                }
            ],
            "type": "void (int, int)",
            "type_args": [
                "int",
                "int"
            ],
            "type_ret": "void"
        },
        {
            "ast": "FunctionDecl",
            "loc": {
                "begin": {
                    "char": 28477,
                    "col": 1,
                    "line": 948
                },
                "end": {
                    "char": 30134,
                    "col": 2,
                    "line": 1002
                }
            },
            "mangled_name": "__Z12draw_gbufferR9SimpleFBOR7GBufferN3glm5tvec2IfLNS3_9precisionE0EEES6_",
            "name": "draw_gbuffer",
            "nodes": [
                {
                    "ast": "ParmDecl",
                    "loc": {
                        "begin": {
                            "char": 28495,
                            "col": 19,
                            "line": 948
                        },
                        "end": {
                            "char": 28509,
                            "col": 33,
                            "line": 948
                        }
                    },
                    "name": "fbo",
                    "nodes": [
                        {
                            "ast": "TypeRef",
                            "loc": {
                                "begin": {
                                    "char": 28495,
                                    "col": 19,
                                    "line": 948
                                },
                                "end": {
                                    "char": 28504,
                                    "col": 28,
                                    "line": 948
                                }
                            },
                            "name": "struct SimpleFBO",
                            "type": "SimpleFBO"
                        }
                    ],
                    "type": "SimpleFBO &"
                },
                {
                    "ast": "ParmDecl",
                    "loc": {
                        "begin": {
                            "char": 28511,
                            "col": 35,
                            "line": 948
                        },
                        "end": {
                            "char": 28527,
                            "col": 51,
                            "line": 948
                        }
                    },
                    "name": "gbuffer",
                    "nodes": [
                        {
                            "ast": "TypeRef",
                            "loc": {
                                "begin": {
                                    "char": 28511,
                                    "col": 35,
                                    "line": 948
                                },
                                "end": {
                                    "char": 28518,
                                    "col": 42,
                                    "line": 948
                                }
                            },
                            "name": "struct GBuffer",
                            "type": "GBuffer"
                        }
                    ],
                    "type": "GBuffer &"
                },
                {
                    "ast": "ParmDecl",
                    "loc": {
                        "begin": {
                            "char": 28529,
                            "col": 53,
                            "line": 948
                        },
                        "end": {
                            "char": 28554,
                            "col": 78,
                            "line": 948
                        }
                    },
                    "name": "viewport_scale",
                    "nodes": [
                        {
                            "ast": "NamespaceRef",
                            "loc": {
                                "begin": {
                                    "char": 28529,
                                    "col": 53,
                                    "line": 948
                                },
                                "end": {
                                    "char": 28532,
                                    "col": 56,
                                    "line": 948
                                }
                            },
                            "name": "glm"
                        },
                        {
                            "ast": "TypeRef",
                            "loc": {
                                "begin": {
                                    "char": 28534,
                                    "col": 58,
                                    "line": 948
                                },
                                "end": {
                                    "char": 28538,
                                    "col": 62,
                                    "line": 948
                                }
                            },
                            "name": "glm::vec2",
                            "type": "glm::vec2"
                        }
                    ],
                    "type": "glm::vec2"
                },
                {
                    "ast": "ParmDecl",
                    "loc": {
                        "begin": {
                            "char": 28570,
                            "col": 94,
                            "line": 948
                        },
                        "end": {
                            "char": 28596,
                            "col": 120,
                            "line": 948
                        }
                    },
                    "name": "viewport_offset",
                    "nodes": [
                        {
                            "ast": "NamespaceRef",
                            "loc": {
                                "begin": {
                                    "char": 28570,
                                    "col": 94,
                                    "line": 948
                                },
                                "end": {
                                    "char": 28573,
                                    "col": 97,
                                    "line": 948
                                }
                            },
                            "name": "glm"
                        },
                        {
                            "ast": "TypeRef",
                            "loc": {
                                "begin": {
                                    "char": 28575,
                                    "col": 99,
                                    "line": 948
                                },
                                "end": {
                                    "char": 28579,
                                    "col": 103,
                                    "line": 948
                                }
                            },
                            "name": "glm::vec2",
                            "type": "glm::vec2"
                        }
                    ],
                    "type": "glm::vec2"
                },
                {
                    "ast": "CompoundStmt",
                    "loc": {
                        "begin": {
                            "char": 28612,
                            "col": 136,
                            "line": 948
                        },
                        "end": {
                            "char": 30134,
                            "col": 2,
                            "line": 1002
                        }
                    },
                    "text": "{\n\n\tfbo.begin();\n\tglScissor(\n\t\tfbo.dim.x*viewport_offset.x, \n\t\tfbo.dim.y*viewport_offset.y, \n\t\tfbo.dim.x*viewport_scale.x, \n\t\tfbo.dim.y*viewport_scale.y);\n\tglViewport(\n\t\tfbo.dim.x*viewport_offset.x, \n\t\tfbo.dim.y*viewport_offset.y, \n\t\tfbo.dim.x*viewport_scale.x, \n\t\tfbo.dim.y*viewport_scale.y);\n\tglEnable(GL_DEPTH_TEST);\n\tglClearColor(0.f, 0.f, 0.f, 1.0f);\n\tglClear(GL_COLOR_BUFFER_BIT | GL_DEPTH_BUFFER_BIT);\n\t{\n\t\tgbuffer.bindTextures(); // 0,1,2\n\t\tdistanceTex.bind(4);\n\t\tfungusTex.bind(5);\n\t\tdensityTex.bind(6);\n\t\tfluidTex.bind(7);\n\n\t\tdeferShader.use();\n\t\tdeferShader.uniform(\"gColor\", 0);\n\t\tdeferShader.uniform(\"gNormal\", 1);\n\t\tdeferShader.uniform(\"gPosition\", 2);\n\t\tdeferShader.uniform(\"uDistanceTex\", 4);\n\t\tdeferShader.uniform(\"uFungusTex\", 5);\n\t\tdeferShader.uniform(\"uDensityTex\", 6);\n\t\tdeferShader.uniform(\"uFluidTex\", 7);\n\n\t\tdeferShader.uniform(\"uViewMatrix\", viewMat);\n\t\tdeferShader.uniform(\"uViewProjectionMatrixInverse\", viewProjMatInverse);\n\t\tdeferShader.uniform(\"uFluidMatrix\", world2field);\n\t\tdeferShader.uniform(\"uNearClip\", near_clip);\n\t\tdeferShader.uniform(\"uFarClip\", far_clip);\n\t\t\n\t\tdeferShader.uniform(\"time\", Alice::Instance().simTime);\n\t\tdeferShader.uniform(\"uDim\", glm::vec2(gbuffer.dim.x, gbuffer.dim.y));\n\t\tdeferShader.uniform(\"uTexScale\", viewport_scale);\n\t\tdeferShader.uniform(\"uTexOffset\", viewport_offset);\n\t\t\n\t\tquadMesh.draw();\n\n\t\tdeferShader.unuse();\n\t\t\n\t\tdistanceTex.unbind(4);\n\t\tfungusTex.unbind(5);\n\t\tdensityTex.unbind(6);\n\t\tfluidTex.unbind(7);\n\t\tgbuffer.unbindTextures();\n\t}\n\tfbo.end();\n}"
                }
            ],
            "type": "void (SimpleFBO &, GBuffer &, glm::vec2, glm::vec2)",
            "type_args": [
                "SimpleFBO &",
                "GBuffer &",
                "glm::vec2",
                "glm::vec2"
            ],
            "type_ret": "void"
        },
        {
            "ast": "FunctionDecl",
            "loc": {
                "begin": {
                    "char": 30136,
                    "col": 1,
                    "line": 1004
                },
                "end": {
                    "char": 45364,
                    "col": 2,
                    "line": 1450
                }
            },
            "mangled_name": "__Z7onFramejj",
            "name": "onFrame",
            "nodes": [
                {
                    "ast": "ParmDecl",
                    "loc": {
                        "begin": {
                            "char": 30149,
                            "col": 14,
                            "line": 1004
                        },
                        "end": {
                            "char": 30163,
                            "col": 28,
                            "line": 1004
                        }
                    },
                    "name": "width",
                    "nodes": [
                        {
                            "ast": "TypeRef",
                            "loc": {
                                "begin": {
                                    "char": 30149,
                                    "col": 14,
                                    "line": 1004
                                },
                                "end": {
                                    "char": 30157,
                                    "col": 22,
                                    "line": 1004
                                }
                            },
                            "name": "uint32_t",
                            "type": "uint32_t"
                        }
                    ],
                    "type": "uint32_t"
                },
                {
                    "ast": "ParmDecl",
                    "loc": {
                        "begin": {
                            "char": 30165,
                            "col": 30,
                            "line": 1004
                        },
                        "end": {
                            "char": 30180,
                            "col": 45,
                            "line": 1004
                        }
                    },
                    "name": "height",
                    "nodes": [
                        {
                            "ast": "TypeRef",
                            "loc": {
                                "begin": {
                                    "char": 30165,
                                    "col": 30,
                                    "line": 1004
                                },
                                "end": {
                                    "char": 30173,
                                    "col": 38,
                                    "line": 1004
                                }
                            },
                            "name": "uint32_t",
                            "type": "uint32_t"
                        }
                    ],
                    "type": "uint32_t"
                },
                {
                    "ast": "CompoundStmt",
                    "loc": {
                        "begin": {
                            "char": 30182,
                            "col": 47,
                            "line": 1004
                        },
                        "end": {
                            "char": 45364,
                            "col": 2,
                            "line": 1450
                        }
                    },
                    "text": "{\n\tAlice& alice = Alice::Instance();\n\tdouble t = alice.simTime;\n\tfloat dt = alice.dt;\n\tfloat aspect = gBufferVR.dim.x / (float)gBufferVR.dim.y;\n\tauto& kinect0 = alice.cloudDeviceManager.devices[0];\n\tauto& kinect1 = alice.cloudDeviceManager.devices[1];\n\n\tif (1) {\n\t\t//kinect0.cloudTransform = \n\t\t\t//glm::scale(glm::vec3(0.1f)) * \n\t\t\t//glm::rotate(float(t), glm::vec3(1,0,0)) * \n\t\t\t//glm::translate(world_centre) *\n\t\t\t//glm::scale(glm::vec3(0.1f)) * \n\t\t\t//glm::mat4();\n\t\t\n\t\t//kinect1.cloudTransform = kinect0.cloudTransform;\n\t}\n\n\tif (alice.framecount % 60 == 0) console.log(\"fps %f at %f; fluid %f(%f) sim %f(%f) wxh %dx%d\", alice.fpsAvg, t, fluidThread.fps.fps, fluidThread.potentialFPS(), simThread.fps.fps, simThread.potentialFPS(), width, height);\n\n\tif (alice.leap->isConnected) {\n\t\t// copy bones into debugdots\n\t\tglm::mat4 trans = viewMatInverse * leap2view;\n\n\t\tint num_ray_dots = 64;\n\t\tint num_hand_dots = 5*4;\n\n\t\tfor (int h=0; h<2; h++) {\n\n\t\t\tint d = h * (num_hand_dots + num_ray_dots);\n\t\t\tauto& hand = alice.leap->hands[h];\n\n\t\t\tif (hand.pinch == 1) {\n\t\t\t\tvrLocation = state->objects[1].location + glm::vec3(0., 0.5, 0.);\n\t\t\t} else if (hand.pinch == 0) {\n\t\t\t\t//vrLocation = glm::vec3(34.5, 17., 33.);\n\t\t\t\t/*\n\t\t\t\tfloat idt = 1.f/dt;\n\t\t\t\tglm::vec3 flow;\n\t\t\t\tflow *= idt;\n\t\t\t\tglm::vec3 norm = transform(world2field, state->objects[1].location);\n\t\t\t\t// get my distance from the ground:\n\t\t\t\tfloat sdist; // creature's distance above the ground (or negative if below)\n\t\t\t\tal_field3d_readnorm_interp(land_dim, state->distance, norm, &sdist);\n\t\t\t\t// if below ground, rise up;\n\t\t\t\t// if above ground, sink down:\n\t\t\t\tfloat gravity = 0.1f;\n\t\t\t\tflow.y += sdist < 0.1f ? gravity : -gravity;\n\t\t\t\t// set my velocity, in meters per second:\n\t\t\t\tstate->objects[1].velocity = flow;\n\t\t\t\tvrLocation = vrLocation - sdist;\n\t\t\t\t*/\n\n\t\t\t}\n\n\t\t\t//glm::vec3 col = (hand.id % 2) ?  glm::vec3(1, 0, hand.pinch) :  glm::vec3(0, 1, hand.pinch);\n\t\t\tfloat cf = fmod(hand.id / 6.f, 1.f);\n\t\t\tglm::vec3 col = glm::vec3(cf, 1.-cf, h);\n\t\t\tif (!hand.isVisible) {\n\t\t\t\tcol = glm::vec3(0.2);\n\t\t\t};\n\n\t\t\tfor (int f=0; f<5; f++) {\n\t\t\t\tauto& finger = hand.fingers[f];\n\t\t\t\tfor (int b=0; b<4; b++) {\n\t\t\t\t\tauto& bone = finger.bones[b];\n\t\t\t\t\tif (hand.isVisible) state->debugdots[d].location = transform(trans, bone.center);\n\t\t\t\t\tstate->debugdots[d].color = col;\n\n\t\t\t\t\td++;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t//get hand position and direction and cast ray forward until it hits land\n\t\t\tglm::vec3 handPos = hand.palmPos;\n\t\t\tglm::vec3 handDir = hand.direction;\n\n\t\t\t// these are in 'leap' space, need to convert to world space\n\t\t\thandPos = transform(trans, handPos);\n\t\t\thandDir = transform(trans, handDir);\n\n\t\t\tauto a = hand.fingers[3].bones[0].center;\n\t\t\tauto b = hand.fingers[3].bones[1].center;\n\n\t\t\ta = transform(trans, a);\n\t\t\tb = transform(trans, b);\n\n\n\t\t\thandDir = glm::normalize(b - a);\n\t\t\t//handDir = safe_normalize(glm::mix(handDir, glm::vec3(0,1,0), 0.25));\n\t\t\thandPos = a;\n\n\t\t\tauto rotaxis = safe_normalize(glm::cross(handDir, glm::vec3(0, 1, 0)));\n\t\t\tauto warp = glm::rotate(-0.1f, rotaxis);\n\n\t\t\tglm::vec3 p = a;\n\n\t\t\tfor (int i=0; i<num_ray_dots; i++) {\n\t\t\t\tglm::vec3 loc = state->debugdots[d].location;\n\t\t\t\t//loc = p;\n\t\t\t\tif (hand.isVisible) state->debugdots[d].location = glm::mix(loc, p, 0.2f);\n\t\t\t\tp = loc;\n\n\t\t\t\t//handDir = safe_normalize(transform(warp, handDir));\n\t\t\t\thandDir = safe_normalize(glm::mix(handDir, glm::vec3(0, -1, 0), 0.1f));\n\n\t\t\t\tauto norm = transform(world2field, p);\n\t\t\t\tfloat dist = al_field3d_readnorm_interp(land_dim, state->distance, norm);\n\n\t\t\t\t// distance in world coordinates:\n\t\t\t\t//float dist_w = field2world_scale * dist;\n\n\t\t\t\tp = p + 0.01f * handDir;\n\n\t\t\t\tfloat c = 0.01;\n\t\t\t\tc = c / (c + dist);\n\t\t\t\tstate->debugdots[d].color = glm::vec3(c, 0.5, 1. - c);\n\t\t\t\tif (dist <= 0) break;\n\n\t\t\t\td++;\n\t\t\t}\n\t\t}\n\t}\n\n\n\tif (alice.isSimulating && isRunning) {\n\t\t// keep the simulation in here to absolute minimum\n\t\t// since it detracts from frame rate\n\t\t// here we should only be extrapolating visible features\n\t\t// such as location (and maybe also orientation?)\n\n\t\tfor (int i=0; i<NUM_PARTICLES; i++) {\n\t\t\tParticle &o = state->particles[i];\n\t\t\to.location = o.location + o.velocity * dt;\n\t\t\to.location = wrap(o.location, world_min, world_max);\n\t\t}\n\t\n\t\tfor (int i=0; i<NUM_OBJECTS; i++) {\n\t\t\tauto &o = state->objects[i];\n\t\t\t// TODO: dt-ify this:\t\n\t\t\t\n\t\t\to.location = wrap(o.location + o.velocity * dt, world_min, world_max);\n\n\t\t\tglm::vec3 norm = transform(world2field, o.location);\n\t\t\tauto landpt = al_field2d_readnorm_interp(glm::vec2(land_dim), state->land, glm::vec2(norm.x, norm.z));\n\t\t\to.location = transform(field2world, glm::vec3(norm.x, landpt.w, norm.z));\n\n\t\t\to.phase += dt;\n\t\t}\n\n\t\tfor (int i=0; i<NUM_SEGMENTS; i++) {\n\t\t\tauto &o = state->segments[i];\n\t\t\tif (i % 8 == 0) {\n\t\t\t\t// a root;\n\t\t\t\t// TODO: dt-ify\n\t\t\t\to.orientation = safe_normalize(glm::slerp(o.orientation, o.orientation * quat_random(), 0.015f));\n\t\t\t\to.location = wrap(o.location + o.velocity * dt, world_min, world_max);\n\t\t\t\to.phase += dt;\n\t\t\t} else {\n\t\t\t\tauto& p = state->segments[i-1];\n\t\t\t\to.orientation = safe_normalize(glm::slerp(o.orientation, p.orientation, 0.015f));\n\t\t\t\tglm::vec3 uz = quat_uz(p.orientation);\n\t\t\t\to.location = p.location + uz*o.scale;\n\t\t\t\to.phase = p.phase + 0.1f;\n\t\t\t}\n\t\t}\n\n\t\t//change mode to have object[0], segement[0], or nothing in focus\n\t\t//float oScale = state->objects[0].scale;\n\t\t//console.log(\"%f\", oScale);\n\n\n\t\tint speciesCount = 6;\n\t\tspeciesCount++;\n\t\tif(debugMode % speciesCount == 1){\n\t\t\tstate->objects[0].location = world_centre;\n\t\t\tstate->objects[0].scale = 2.0;\n\t\t\tstate->segments[0].scale = 2.5;\n\t\t\t//console.log(\"Creature 1\");\n\t\t}else if(debugMode % speciesCount == 2){\n\t\t\tstate->objects[1].location = world_centre;\n\t\t\tstate->objects[1].scale = 2.0;\n\t\t\tstate->objects[0].scale = 1.0;\n\t\t\tstate->segments[0].scale = 2.5;\n\t\t\t//console.log(\"Creature 2\");\n\t\t}else if(debugMode % speciesCount == 3){\n\t\t\tstate->objects[2].location = world_centre;\n\t\t\tstate->objects[2].scale = 2.0;\n\t\t\tstate->objects[1].scale = 1.0;\n\t\t\tstate->segments[0].scale = 2.5;\n\t\t\t//console.log(\"Creature 3\");\n\t\t}else if(debugMode % speciesCount == 4){\n\t\t\tstate->objects[3].location = world_centre;\n\t\t\tstate->objects[3].scale = 2.0;\n\t\t\tstate->objects[2].scale = 1.0;\n\t\t\tstate->segments[0].scale = 2.5;\n\t\t\t//console.log(\"Creature 4\");\n\t\t}else if(debugMode % speciesCount == 5){\n\t\t\tstate->objects[4].location = world_centre;\n\t\t\tstate->objects[4].scale = 2.0;\n\t\t\tstate->objects[3].scale = 1.0;\n\t\t\tstate->segments[0].scale = 2.5;\n\t\t\t//console.log(\"Creature 5\");\n\t\t}else if(debugMode % speciesCount == 6){\n\t\t\tstate->segments[0].location = world_centre;\n\t\t\tstate->segments[0].scale = 5.0;\n\t\t\tstate->objects[4].scale = 1.0;\n\t\t\tstate->objects[0].scale = 1.0;\n\t\t}else{\n\t\t\tstate->segments[0].scale = 2.5;\n\t\t\tstate->objects[0].scale = 1.0;\n\t\t}\n\t\n\t\t\n\n\t\t// upload VBO data to GPU:\n\t\tobjectInstancesVBO.submit(&state->objects[0], sizeof(state->objects));\n\t\tsegmentInstancesVBO.submit(&state->segments[0], sizeof(state->segments));\n\t\tparticlesVBO.submit(&state->particles[0], sizeof(state->particles));\n\t\tdebugVBO.submit(&state->debugdots[0], sizeof(state->debugdots));\n\t\t\n\t\t// upload texture data to GPU:\n\t\t//fluidTex.submit(fluid.velocities.dim(), (glm::vec3 *)fluid.velocities.front()[0]);\n\t\tfluidTex.submit(field_dim, state->fluidpod.velocities.front());\n\t\tdensityTex.submit(field_dim, state->density_back);\n\t\tfungusTex.submit(glm::ivec2(FUNGUS_DIM, FUNGUS_DIM), &state->fungus[0]);\n\t\tlandTex.submit(glm::ivec2(LAND_DIM, LAND_DIM), &state->land[0]);\n\t\tdistanceTex.submit(land_dim, (float *)&state->distance[0]);\n\t\t\n\t\t//if (alice.cloudDevice->use_colour) {\n\t\t\tconst CloudDevice& cd = alice.cloudDeviceManager.devices[flip];\n\t\t\tconst ColourFrame& image = cd.colourFrame();\n\t\t\tglActiveTexture(GL_TEXTURE0);\n\t\t\tglBindTexture(GL_TEXTURE_2D, colorTex);\n\t\t\tglTexImage2D(GL_TEXTURE_2D, 0, GL_RGB, cColorWidth, cColorHeight, 0, GL_RGB, \n\t\t\tGL_UNSIGNED_BYTE, image.color);\n\t\t//}\n\t}\n\n\t\n\tHmd& vive = *alice.hmd;\n\tSimpleFBO& fbo = vive.fbo;\n\tif (width && height) {\n\t\tif (vive.connected) {\t\n\t\t\t\t\n\t\t\tvive.near_clip = near_clip;\n\t\t\tvive.far_clip = far_clip;\t\n\t\t\tvive.update();\n\t\t\tglEnable(GL_SCISSOR_TEST);\n\n\t\t\t//vrLocation = state->objects[1].location + glm::vec3(0., 1., 0.);\n\n\t\t\tfor (int eye = 0; eye < 2; eye++) {\n\t\t\t\t// update nav\n\t\t\t\tviewMat = glm::inverse(vive.m_mat4viewEye[eye]) * glm::mat4_cast(glm::inverse(vive.mTrackedQuat)) * glm::translate(glm::mat4(1.f), -vive.mTrackedPosition) * glm::translate(-vrLocation);\n\t\t\t\tprojMat = glm::frustum(vive.frustum[eye].l, vive.frustum[eye].r, vive.frustum[eye].b, vive.frustum[eye].t, vive.frustum[eye].n, vive.frustum[eye].f);\n\n\t\t\t\tviewProjMat = projMat * viewMat;\n\t\t\t\tprojMatInverse = glm::inverse(projMat);\n\t\t\t\tviewMatInverse = glm::inverse(viewMat);\n\t\t\t\tviewProjMatInverse = glm::inverse(viewProjMat);\n\n\t\t\t\tglm::vec2 viewport_scale = glm::vec2(0.5f, 1.f);\n\t\t\t\tglm::vec2 viewport_offset = glm::vec2(eye*0.5f, 0.f);\n\n\t\t\t\tgBufferVR.begin();\n\n\t\t\t\t\tviewport.pos = glm::ivec2(gBufferVR.dim.x * viewport_offset.x, gBufferVR.dim.y * viewport_offset.y);\n\t\t\t\t\tviewport.dim = glm::ivec2(gBufferVR.dim.x * viewport_scale.x, gBufferVR.dim.y * viewport_scale.y);\n\n\t\t\t\t\t//console.log(\"eye %d vp %d %d %d %d\", eye, viewport.pos.x, viewport.pos.y, viewport.dim.x, viewport.dim.y);\n\n\t\t\t\t\tglScissor(\n\t\t\t\t\t\tviewport.pos.x, \n\t\t\t\t\t\tviewport.pos.y, \n\t\t\t\t\t\tviewport.dim.x, \n\t\t\t\t\t\tviewport.dim.y);\n\t\t\t\t\tglViewport(\n\t\t\t\t\t\tviewport.pos.x, \n\t\t\t\t\t\tviewport.pos.y, \n\t\t\t\t\t\tviewport.dim.x, \n\t\t\t\t\t\tviewport.dim.y);\n\t\t\t\t\tglEnable(GL_DEPTH_TEST);\n\t\t\t\t\tglClear(GL_COLOR_BUFFER_BIT | GL_DEPTH_BUFFER_BIT);\n\n\t\t\t\t\tdraw_scene(viewport.dim.x, viewport.dim.y);\n\t\t\t\tgBufferVR.end();\n\n\t\t\t\t//glGenerateMipmap(GL_TEXTURE_2D); // not sure if we need this\n\t\t\t\tdraw_gbuffer(fbo, gBufferVR, viewport_scale, viewport_offset);\n\t\t\t}\n\t\t\tglDisable(GL_SCISSOR_TEST);\n\t\t} else {\n\t\t\t\n\t\t\tswitch (camMode){\n\t\t\t\tcase 0: {\n\t\t\t\t\t// WASD mode:\n\t\t\t\t\tfloat camera_turnangle = 1.f;\n\t\t\t\t\tfloat camera_speed = 4.f;\n\n\t\t\t\t\t// move camera:\n\t\t\t\t\tcameraLoc += quat_rotate(cameraOri, camVel) * (camera_speed * dt);\n\t\t\t\t\t// wrap to world:\n\t\t\t\t\tcameraLoc = wrap(cameraLoc, world_min, world_max);\n\n\t\t\t\t\t// stick to floor:\n\t\t\t\t\tglm::vec3 norm = transform(world2field, cameraLoc);\n\t\t\t\t\tglm::vec4 landpt = al_field2d_readnorm_interp(glm::vec2(land_dim), state->land, glm::vec2(norm.x, norm.z));\n\t\t\t\t\tcameraLoc = transform(field2world, glm::vec3(norm.x, landpt.w, norm.z)) ;\n\t\t\t\n\t\t\t\t\t// rotate camera:\n\t\t\t\t\tcameraOri = safe_normalize(cameraOri * glm::angleAxis(camera_turnangle * dt, camTurn));\n\t\t\t\t\t// now orient to floor:\n\t\t\t\t\tglm::vec3 up = glm::vec3(landpt);\n\t\t\t\t\tup = glm::mix(up, glm::vec3(0,1,0), 0.5);\n\t\t\t\t\tcameraOri = align_up_to(cameraOri, glm::normalize(up));\n\n\t\t\t\t\t// now create view matrix:\n\t\t\t\t\tglm::vec3 boom = glm::vec3(0., 1.7, 1.7);\n\t\t\t\t\t//glm::vec3 boom = glm::vec3(0.);\n\t\t\t\t\tviewMat = glm::inverse(glm::translate(cameraLoc) * glm::mat4_cast(cameraOri) * glm::translate(boom));\n\t\t\t\t\tprojMat = glm::perspective(glm::radians(110.0f), aspect, near_clip, far_clip);\n\t\t\t\t\n\t\t\t\t} break;\n\t\t\t\tcase 1: {\n\t\t\t\t\t// follow a creature mode:\n\t\t\t\t\tauto& o = state->objects[0];\n\n\t\t\t\t\tglm::vec3 fluidloc = transform(world2field, o.location);\n\t\t\t\t\tglm::vec3 flow = al_field3d_readnorm_interp(field_dim, state->fluidpod.velocities.front(), fluidloc);\n\t\t\t\t\tflow = flow * dt * 100.0f;\n\t\t\t\t\t\n\t\t\t\t\tcameraLoc = glm::mix(cameraLoc, o.location + flow, 0.1f);\n\t\t\t\t\tcameraOri = glm::slerp(cameraOri, o.orientation, 0.01f);\n\t\t\t\t\t//TODO: Once creatures follow the ground, fix boom going into the earth\n\t\t\t\t\t\n\t\t\t\t\tauto boom = glm::vec3(0., o.scale*2.f, o.scale*4.);\n\t\t\t\t\tviewMat = glm::inverse(glm::translate(cameraLoc) * glm::mat4_cast(cameraOri) * glm::translate(boom));\n\t\t\t\t\tprojMat = glm::perspective(glm::radians(75.0f), aspect, near_clip, far_clip);\n\t\t\t\t\n\t\t\t\t} break;\n\t\t\t\tcase 2: {\n\t\t\t\t\t// follow a predator\n\t\t\t\t\tdouble a = M_PI * t / 30.;\n\t\t\t\t\tauto& o = state->segments[0];\n\n\t\t\t\t\tglm::vec3 fluidloc = transform(world2field, o.location);\n\t\t\t\t\tglm::vec3 flow = al_field3d_readnorm_interp(field_dim, state->fluidpod.velocities.front(), fluidloc);\n\t\t\t\t\tflow = flow * dt * 100.0f;\n\t\t\t\t\t\n\t\t\t\t\tcameraLoc = glm::mix(cameraLoc, o.location + flow, 0.1f);\n\t\t\t\t\tcameraOri = glm::slerp(cameraOri, o.orientation, 0.01f);\n\t\t\t\t\t//TODO: Once creatures follow the ground, fix boom going into the earth\n\n\t\t\t\t\tauto boom = glm::vec3(0., o.scale*2.f, o.scale*4.);\n\t\t\t\t\tviewMat = glm::inverse(glm::translate(cameraLoc) * glm::mat4_cast(cameraOri) * glm::translate(boom));\n\t\t\t\t\tprojMat = glm::perspective(glm::radians(75.0f), aspect, near_clip, far_clip);\n\t\t\t\t\n\t\t\t\t} break;\n\t\t\t\tdefault: {\n\t\t\t\t\t// orbit around\n\t\t\t\t\tdouble a = M_PI * t / 30.;\n\t\t\t\t\tviewMat = glm::lookAt(\n\t\t\t\t\t\tworld_centre + \n\t\t\t\t\t\tglm::vec3(0.5*sin(t), 0.85*sin(0.5*a), 4.*sin(a)), \n\t\t\t\t\t\tworld_centre, \n\t\t\t\t\t\tglm::vec3(0., 1., 0.));\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tviewMat = viewMat * glm::scale(glm::vec3(mini2world));\n\t\t\tviewProjMat = projMat * viewMat;\n\t\t\tprojMatInverse = glm::inverse(projMat);\n\t\t\tviewMatInverse = glm::inverse(viewMat);\n\t\t\tviewProjMatInverse = glm::inverse(viewProjMat);\n\n\t\t\t// draw the scene into the GBuffer:\n\t\t\tglEnable(GL_SCISSOR_TEST);\n\t\t\tgBufferVR.begin();\n\t\t\t\n\t\t\t\t// No HMD:\n\t\t\t\tglScissor(0, 0, gBufferVR.dim.x, gBufferVR.dim.y);\n\t\t\t\tglViewport(0, 0, gBufferVR.dim.x, gBufferVR.dim.y);\n\t\t\t\tglEnable(GL_DEPTH_TEST);\n\t\t\t\tglClear(GL_COLOR_BUFFER_BIT | GL_DEPTH_BUFFER_BIT);\n\t\t\t\tdraw_scene(gBufferVR.dim.x, gBufferVR.dim.y);\n\t\t\n\t\t\tgBufferVR.end();\n\t\t\t//glGenerateMipmap(GL_TEXTURE_2D); // not sure if we need this\n\n\t\t\t// now process the GBuffer and render the result into the fbo\n\t\t\tdraw_gbuffer(alice.hmd->fbo, gBufferVR, glm::vec2(1.f), glm::vec2(0.f));\n\t\t\tglDisable(GL_SCISSOR_TEST);\n\t\t}\n\t} \n\t\t\n\talice.hmd->submit();\n\n\n\tfor (int i=0; i<2; i++) {\n\t\tSimpleFBO& fbo = projFBOs[i];\n\n\t\t//top down camera view\n\t\teyePos = world_centre + glm::vec3(0.0f, 6.0f + 20.f*i, 0.0f);\n\t\tviewMat = glm::lookAt(\n\t\t\teyePos, \n\t\t\tworld_centre, \n\t\t\tglm::vec3(0.0f, 0.0f, 1.0f));\n\t\tprojMat = glm::perspective(glm::radians(60.0f), aspect, near_clip, far_clip);\n\t\tviewMat = viewMat * glm::scale(glm::vec3(mini2world));\n\t\tviewProjMat = projMat * viewMat;\n\t\tprojMatInverse = glm::inverse(projMat);\n\t\tviewMatInverse = glm::inverse(viewMat);\n\t\tviewProjMatInverse = glm::inverse(viewProjMat);\n\t\t\n\t\t// draw the scene into the GBuffer:\n\t\tglEnable(GL_SCISSOR_TEST);\n\t\tgBufferProj.begin();\n\t\t\tglScissor(0, 0, gBufferProj.dim.x, gBufferProj.dim.y);\n\t\t\tglViewport(0, 0, gBufferProj.dim.x, gBufferProj.dim.y);\n\t\t\tglEnable(GL_DEPTH_TEST);\n\t\t\tglClear(GL_COLOR_BUFFER_BIT | GL_DEPTH_BUFFER_BIT);\n\t\t\tdraw_scene(gBufferProj.dim.x, gBufferProj.dim.y);\n\t\tgBufferProj.end();\n\t\t//glGenerateMipmap(GL_TEXTURE_2D); // not sure if we need this\n\t\tdraw_gbuffer(fbo, gBufferProj, glm::vec2(1.f), glm::vec2(0.f));\n\t\tglDisable(GL_SCISSOR_TEST);\n\t}\n\n\tglViewport(0, 0, width, height);\n\tglEnable(GL_DEPTH_TEST);\n\tglClearColor(0.f, 0.f, 0.f, 1.0f);\n\tglClear(GL_COLOR_BUFFER_BIT | GL_DEPTH_BUFFER_BIT);\n\tprojFBOs[0].draw(glm::vec2(0.5f), glm::vec2(-0.5, -0.5));\n\tprojFBOs[1].draw(glm::vec2(0.5f), glm::vec2( 0.5, -0.5));\n\n\tfbo.draw(glm::vec2(0.5f), glm::vec2(-0.5,  0.5));\n\n\t//fbo.draw(glm::vec2(0.5f), glm::vec2( 0.5,  0.5));\n\n\n\t\n\t// openvr header recommends this after submit:\n\t//glFlush();\n\t//glFinish();\n}"
                }
            ],
            "type": "void (uint32_t, uint32_t)",
            "type_args": [
                "uint32_t",
                "uint32_t"
            ],
            "type_ret": "void"
        },
        {
            "ast": "FunctionDecl",
            "loc": {
                "begin": {
                    "char": 45367,
                    "col": 1,
                    "line": 1453
                },
                "end": {
                    "char": 47759,
                    "col": 2,
                    "line": 1569
                }
            },
            "mangled_name": "__Z10onKeyEventiiibbbb",
            "name": "onKeyEvent",
            "nodes": [
                {
                    "ast": "ParmDecl",
                    "loc": {
                        "begin": {
                            "char": 45383,
                            "col": 17,
                            "line": 1453
                        },
                        "end": {
                            "char": 45394,
                            "col": 28,
                            "line": 1453
                        }
                    },
                    "name": "keycode",
                    "type": "int"
                },
                {
                    "ast": "ParmDecl",
                    "loc": {
                        "begin": {
                            "char": 45396,
                            "col": 30,
                            "line": 1453
                        },
                        "end": {
                            "char": 45408,
                            "col": 42,
                            "line": 1453
                        }
                    },
                    "name": "scancode",
                    "type": "int"
                },
                {
                    "ast": "ParmDecl",
                    "loc": {
                        "begin": {
                            "char": 45410,
                            "col": 44,
                            "line": 1453
                        },
                        "end": {
                            "char": 45420,
                            "col": 54,
                            "line": 1453
                        }
                    },
                    "name": "downup",
                    "type": "int"
                },
                {
                    "ast": "ParmDecl",
                    "loc": {
                        "begin": {
                            "char": 45422,
                            "col": 56,
                            "line": 1453
                        },
                        "end": {
                            "char": 45432,
                            "col": 66,
                            "line": 1453
                        }
                    },
                    "name": "shift",
                    "type": "bool"
                },
                {
                    "ast": "ParmDecl",
                    "loc": {
                        "begin": {
                            "char": 45434,
                            "col": 68,
                            "line": 1453
                        },
                        "end": {
                            "char": 45443,
                            "col": 77,
                            "line": 1453
                        }
                    },
                    "name": "ctrl",
                    "type": "bool"
                },
                {
                    "ast": "ParmDecl",
                    "loc": {
                        "begin": {
                            "char": 45445,
                            "col": 79,
                            "line": 1453
                        },
                        "end": {
                            "char": 45453,
                            "col": 87,
                            "line": 1453
                        }
                    },
                    "name": "alt",
                    "type": "bool"
                },
                {
                    "ast": "ParmDecl",
                    "loc": {
                        "begin": {
                            "char": 45455,
                            "col": 89,
                            "line": 1453
                        },
                        "end": {
                            "char": 45463,
                            "col": 97,
                            "line": 1453
                        }
                    },
                    "name": "cmd",
                    "type": "bool"
                },
                {
                    "ast": "CompoundStmt",
                    "loc": {
                        "begin": {
                            "char": 45464,
                            "col": 98,
                            "line": 1453
                        },
                        "end": {
                            "char": 47759,
                            "col": 2,
                            "line": 1569
                        }
                    },
                    "text": "{\n\tAlice& alice = Alice::Instance();\n\n\tswitch(keycode) {\n\t\tcase GLFW_KEY_ENTER: {\n\t\t\tif (downup && alt) {\n\t\t\t\tif (alice.hmd->connected) {\n\t\t\t\t\talice.hmd->disconnect();\n\t\t\t\t} else if (alice.hmd->connect()) {\n\t\t\t\t\tgBufferVR.dim = alice.hmd->fbo.dim;\n\t\t\t\t\tgBufferVR.dest_changed();\n\t\t\t\t\talice.hmd->dest_changed();\n\t\t\t\t\talice.desiredFrameRate = 90;\n\t\t\t\t}\n\t\t\t}\n\t\t} break;\n\n\t\t// ? key to switch debug modes\n\t\tcase GLFW_KEY_SLASH: {\n\t\t\t//console.log(\"D was pressed\");\n\t\t\tif (downup) debugMode++;\n\t\t} break;\n\t\t\n\t\tcase GLFW_KEY_C: {\n\t\t\tif (downup) { \n\t\t\t\tcamMode = (camMode+1) % camModeMax;\n\t\t\t\tconsole.log(\"Cam mode %d\", camMode);\n\t\t\t}\n\t\t} break;\n\n\t\t// WASD+arrows for nav:\n\t\tcase GLFW_KEY_UP:\n\t\tcase GLFW_KEY_W:\n\t\t\tif (downup) camVel.z = -1.f; \n\t\t\telse camVel.z = 0.f; \n\t\t\tbreak;\n\t\tcase GLFW_KEY_DOWN:\n\t\tcase GLFW_KEY_S:\n\t\t\tif (downup) camVel.z =  1.f; \n\t\t\telse camVel.z = 0.f; \n\t\t\tbreak;\n\t\tcase GLFW_KEY_RIGHT:\n\t\t\tif (downup) camTurn.y = -1.f; \n\t\t\telse camTurn.y = 0.f; \n\t\t\tbreak;\n\t\tcase GLFW_KEY_LEFT:\n\t\t\tif (downup) camTurn.y =  1.f; \n\t\t\telse camTurn.y = 0.f; \n\t\t\tbreak;\n\t\tcase GLFW_KEY_A:\n\t\t\tif (downup) camVel.x = -1.f; \n\t\t\telse camVel.x = 0.f; \n\t\t\tbreak;\n\t\tcase GLFW_KEY_D:\n\t\t\tif (downup) camVel.x =  1.f; \n\t\t\telse camVel.x = 0.f; \n\t\t\tbreak;\n\t\n\t/*\n\t\t//pitch up\n\t\tcase GLFW_KEY_KP_8:\n\t\tcase GLFW_KEY_UP:{\n\t\t\tcamPitch += camSpeed;\n\t\t} break;\n\t\t//pitch down\n\t\tcase GLFW_KEY_KP_2: \n\t\tcase GLFW_KEY_DOWN:{\n\t\t\tcamPitch -= camSpeed;\n\t\t} break;\n\t\t//yaw left\n\t\tcase GLFW_KEY_KP_4:\n\t\tcase GLFW_KEY_LEFT: {\n\t\t\tcamYaw += camSpeed;\n\t\t} break;\n\t\t//yaw right\n\t\tcase GLFW_KEY_KP_6:\n\t\tcase GLFW_KEY_RIGHT: {\n\t\t\tcamYaw -= camSpeed;\n\t\t} break;\n\t\t//Go left\n\t\tcase GLFW_KEY_KP_7:\n\t\tcase GLFW_KEY_O: {\n\t\t\tcamStrafe -= camSpeed;\n\t\t} break;\n\t\t//Go right\n\t\tcase GLFW_KEY_KP_9:\n\t\tcase GLFW_KEY_P: {\n\t\t\tcamStrafe += camSpeed;\n\t\t} break;\n\t\t//Go Up\n\t\tcase GLFW_KEY_KP_ADD:\n\t\tcase GLFW_KEY_LEFT_BRACKET: {\n\t\t\tcamUp += camSpeed;\n\t\t} break;\n\t\t//Go down\n\t\tcase GLFW_KEY_KP_SUBTRACT:\n\t\tcase GLFW_KEY_RIGHT_BRACKET: { \n\t\t\tcamUp -= camSpeed;\n\t\t} break;\n\t\t//Go Forward\n\t\tcase GLFW_KEY_KP_1:\n\t\tcase GLFW_KEY_K: {\n\t\t\tcamForward = true;\n\t\t} break;\n\t\t//Go Back\n\t\tcase GLFW_KEY_KP_3:\n\t\tcase GLFW_KEY_L: {\n\t\t\tcamBackwards = true;\n\t\t} break;\n\t\t// default:\n\t\t//state->objects[0].velocity = glm::vec3(0.);\n\t\taccel = 0;\n\t\tdecel = 0;\n\t\t*/\n\t}\n\n}"
                }
            ],
            "type": "void (int, int, int, bool, bool, bool, bool)",
            "type_args": [
                "int",
                "int",
                "int",
                "bool",
                "bool",
                "bool",
                "bool"
            ],
            "type_ret": "void"
        },
        {
            "ast": "FunctionDecl",
            "loc": {
                "begin": {
                    "char": 47762,
                    "col": 1,
                    "line": 1572
                },
                "end": {
                    "char": 47961,
                    "col": 2,
                    "line": 1579
                }
            },
            "mangled_name": "__Z13threads_beginv",
            "name": "threads_begin",
            "nodes": [
                {
                    "ast": "CompoundStmt",
                    "loc": {
                        "begin": {
                            "char": 47783,
                            "col": 22,
                            "line": 1572
                        },
                        "end": {
                            "char": 47961,
                            "col": 2,
                            "line": 1579
                        }
                    },
                    "text": "{\n\tconsole.log(\"starting threads\");\n\t// allow threads to run\n\tisRunning = true;\n\tsimThread.begin(sim_update);\n\tfluidThread.begin(fluid_update);\n\tconsole.log(\"started threads\");\n}"
                }
            ],
            "type": "void ()",
            "type_args": [],
            "type_ret": "void"
        },
        {
            "ast": "FunctionDecl",
            "loc": {
                "begin": {
                    "char": 47963,
                    "col": 1,
                    "line": 1581
                },
                "end": {
                    "char": 48127,
                    "col": 2,
                    "line": 1588
                }
            },
            "mangled_name": "__Z11threads_endv",
            "name": "threads_end",
            "nodes": [
                {
                    "ast": "CompoundStmt",
                    "loc": {
                        "begin": {
                            "char": 47982,
                            "col": 20,
                            "line": 1581
                        },
                        "end": {
                            "char": 48127,
                            "col": 2,
                            "line": 1588
                        }
                    },
                    "text": "{\n\t// release threads:\n\tisRunning = false;\n\tconsole.log(\"ending threads\");\n\tsimThread.end();\n\tfluidThread.end();\n\tconsole.log(\"ended threads\");\n}"
                }
            ],
            "type": "void ()",
            "type_args": [],
            "type_ret": "void"
        },
        {
            "ast": "FunctionDecl",
            "comment": {
                "text": "// The onReset event is triggered when pressing the \"Backspace\" key in Alice"
            },
            "loc": {
                "begin": {
                    "char": 48206,
                    "col": 1,
                    "line": 1591
                },
                "end": {
                    "char": 53329,
                    "col": 2,
                    "line": 1784
                }
            },
            "mangled_name": "__Z7onResetv",
            "name": "onReset",
            "nodes": [
                {
                    "ast": "CompoundStmt",
                    "loc": {
                        "begin": {
                            "char": 48221,
                            "col": 16,
                            "line": 1591
                        },
                        "end": {
                            "char": 53329,
                            "col": 2,
                            "line": 1784
                        }
                    },
                    "text": "{\n\n\tthreads_end();\n\n\t// zero by default:\n\tmemset(state, 0, sizeof(State));\n\n\tstate->fluidpod.reset();\n\n\tfor (int i=0; i<NUM_OBJECTS; i++) {\n\t\tauto& o = state->objects[i];\n\t\to.location = world_centre+glm::ballRand(10.f);\n\t\to.color = glm::mix(glm::ballRand(1.f)*0.5f+0.5f, glm::vec3(0.3, 0.2, 0.8), 0.5f);\n\t\to.phase = rnd::uni();\n\t\to.scale = 1.;\n\t\to.accel = glm::vec3(0.f);\n\t}\n\tfor (int i=0; i<NUM_SEGMENTS; i++) {\n\t\tauto& o = state->segments[i];\n\t\to.location = world_centre+glm::ballRand(10.f);\n\t\to.color = glm::ballRand(1.f)*0.5f+0.5f;\n\t\to.phase = rnd::uni();\n\t\to.scale = 2.5;\n\t}\n\tfor (int i=0; i<NUM_PARTICLES; i++) {\n\t\tauto& o = state->particles[i];\n\t\to.location = world_centre+glm::ballRand(10.f);\n\t\to.color = glm::vec3(1.f);\n\t}\n\n\n\t{\n\t\tint i=0;\n\t\tglm::ivec2 dim = glm::ivec2(FUNGUS_DIM, FUNGUS_DIM);\n\t\tfor (size_t y=0;y<dim.y;y++) {\n\t\t\tfor (size_t x=0;x<dim.x;x++) {\n\t\t\t\tstate->fungus[i] = rnd::uni();\n\t\t\t\tstate->fungus_old[i] = rnd::uni();\n\t\t\t}\n\t\t}\n\t}\n\n\t//al_field3d_zero(field_dim, state->density);\n\t{\n\t\tint i=0;\n\t\tglm::ivec3 dim = field_dim;\n\t\tfor (size_t z=0;z<dim.z;z++) {\n\t\t\tfor (size_t y=0;y<dim.y;y++) {\n\t\t\t\tfor (size_t x=0;x<dim.x;x++) {\n\t\t\t\t\tglm::vec3 coord = glm::vec3(x, y, z);\n\t\t\t\t\tglm::vec3 norm = coord/glm::vec3(dim);\n\t\t\t\t\t//glm::vec3 snorm = norm*2.f-1.f;\n\t\t\t\t\t//glm::vec3 snormhalf = snorm * 0.5f;\n\t\t\t\t\tstate->density[i] = glm::vec3(0.f);//norm * 0.000001f;\n\t\t\t\t\tstate->density_back[i] = state->density[i];\n\n\t\t\t\t\ti++;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\n\t/*\n\t\tCreate the initial landscape:\n\t*/\n\t{\t\n\t\tint i=0;\n\t\tglm::ivec2 dim2 = glm::ivec2(LAND_DIM, LAND_DIM);\n\t\tfor (size_t y=0;y<dim2.y;y++) {\n\t\t\tfor (size_t x=0;x<dim2.x;x++, i++) {\n\t\t\t\tglm::vec2 coord = glm::vec2(x, y);\n\t\t\t\tglm::vec2 norm = coord/glm::vec2(dim2);\n\t\t\t\tglm::vec2 snorm = norm*2.f-1.f;\n\n\t\t\t\tfloat w = 0.f;\n\n\t\t\t\tglm::vec2 p = snorm;\n\t\t\t\t//w += pow((cos(M_PI * p.x)+1.)*(cos(M_PI * p.y)+1.)*0.25, 0.5);\n\n\t\t\t\tp = p * 2.f;\n\t\t\t\tp += glm::vec2(0.234f, 0.567f);\n\t\t\t\tp = glm::rotate(p, 2.f);\n\t\t\t\tw += pow((cos(M_PI * p.x)+1.)*(cos(M_PI * p.y)+1.)*0.25, 0.5) * 0.5;\n\n\n\t\t\t\tp = p * 2.f;\n\t\t\t\tp += glm::vec2(0.234f, 0.567f);\n\t\t\t\tp = glm::rotate(p, 2.f);\n\t\t\t\tw += pow((cos(M_PI * p.x)+1.)*(cos(M_PI * p.y)+1.)*0.25, 0.5) * 0.25;\n\n\t\t\t\tp = p * 2.f;\n\t\t\t\tp += glm::vec2(0.234f, 0.567f);\n\t\t\t\tp = glm::rotate(p, 2.f);\n\t\t\t\tw += pow((cos(M_PI * p.x)+1.)*(cos(M_PI * p.y)+1.)*0.25, 0.5) * 0.125;\n\n\t\t\t\tp = p * glm::length(snorm);\n\t\t\t\tp += glm::vec2(0.234f, 0.567f);\n\t\t\t\tp = glm::rotate(p, 2.f);\n\t\t\t\tw += pow((cos(M_PI * p.x)+1.)*(cos(M_PI * p.y)+1.)*0.25, 0.5) * 0.125;\n\n\n\t\t\t\tw *= pow((cos(M_PI * snorm.x)+1.1)*(cos(M_PI * snorm.y)+1.1)*0.25, 0.35);\n\n\n\t\t\t\tw = glm::max(w - 0.2f, 0.f);\n\n\t\t\t\tstate->land[i].w = w * 0.3 + 0.01;\n\t\t\t}\n\t\t}\n\t}\n\t{\n\t\t// generate SDF from state->land height:\n\t\tint i=0;\n\t\tglm::ivec3 dim = glm::ivec3(LAND_DIM, LAND_DIM, LAND_DIM);\n\t\tglm::ivec2 dim2 = glm::ivec2(LAND_DIM, LAND_DIM);\n\t\tfor (size_t z=0;z<dim.z;z++) {\n\t\t\tfor (size_t y=0;y<dim.y;y++) {\n\t\t\t\tfor (size_t x=0;x<dim.x;x++) {\n\t\t\t\t\tglm::vec3 coord = glm::vec3(x, y, z);\n\t\t\t\t\tglm::vec3 norm = coord/glm::vec3(dim);\n\t\t\t\t\t\n\t\t\t\t\tint ii = al_field2d_index(dim2, glm::ivec2(x, z));\n\t\t\t\t\tfloat w = state->land[ ii ].w;\n\n\t\t\t\t\tstate->distance[i] = norm.y < w ? -1. : 1.;\n\t\t\t\t\tstate->distance_binary[i] = state->distance[i] < 0.f ? 0.f : 1.f;\n\n\t\t\t\t\ti++;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tsdf_from_binary(land_dim, state->distance_binary, state->distance);\n\t\t//sdf_from_binary_deadreckoning(land_dim, state->distance_binary, state->distance);\n\t\tal_field3d_scale(land_dim, state->distance, 1.f/land_dim.x);\n\t}\n\t{\n\t\t// generate state->land normals:\n\t\tint i=0;\n\t\tglm::ivec2 dim2 = glm::ivec2(LAND_DIM, LAND_DIM);\n\t\tfor (size_t y=0;y<dim2.y;y++) {\n\t\t\tfor (size_t x=0;x<dim2.x;x++, i++) {\n\t\t\t\tglm::vec2 coord = glm::vec2(x, y);\n\t\t\t\tglm::vec2 norm = coord/glm::vec2(dim2);\n\t\t\t\tglm::vec2 snorm = norm*2.f-1.f;\n\n\t\t\t\tfloat w = state->land[i].w;\n\n\t\t\t\tglm::vec3 norm3 = glm::vec3(norm.x, w, norm.y);\n\n\t\t\t\tglm::vec3 normal = sdf_field_normal4(land_dim, state->distance, norm3, 1.f/LAND_DIM);\n\t\t\t\tstate->land[i] = glm::vec4(normal, w);\n\t\t\t}\n\t\t}\n\t}\n\n\n\tint div = sqrt(NUM_DEBUGDOTS);\n\tfor (int i=0; i<NUM_DEBUGDOTS; i++) {\n\t\tauto& o = state->debugdots[i];\n\t\t\n\t\tfloat x = (i / div) / float(div);\n\t\tfloat z = (i % div) / float(div);\n\t\t\n\t\t//o.location = glm::linearRand(world_min, world_max);\n\n\t\t// normalized coordinate (0..1)\n\t\tglm::vec3 norm = glm::vec3(x, 0, z); //transform(world2field, o.location);\n\n\t\t// get land data at this point:\n\t\t// xyz is normal, w is height\n\t\tglm::vec4 landpt = al_field2d_readnorm_interp(glm::vec2(land_dim.x, land_dim.z), state->land, glm::vec2(norm.x, norm.z));\n\t\t\n\t\t// if flatness == 1, land is horizontal. \n\t\t// if flatness == 0, land is vertical.\n\t\tfloat flatness = fabsf(landpt.y); // simplified dot product of landnorm with (0,1,0)\n\t\t// make it more extreme\n\t\tflatness = powf(flatness, 2.f);\t\t\t\t\n\n\t\t// get land surface coordinate:\n\t\tglm::vec3 land_coord = transform(field2world, glm::vec3(norm.x, landpt.w, norm.z));\n\t\t\n\t\t// place on land\n\t\to.location = land_coord;\n\n\t\to.color = glm::vec3(flatness, 0.5, 1. - flatness); //glm::vec3(0, 0, 1);\n\t}\n\n\n\n\tonReloadGPU();\n\n\tthreads_begin();\n}"
                }
            ],
            "type": "void ()",
            "type_args": [],
            "type_ret": "void"
        },
        {
            "ast": "FunctionDecl",
            "loc": {
                "begin": {
                    "char": 53331,
                    "col": 1,
                    "line": 1786
                },
                "end": {
                    "char": 53713,
                    "col": 2,
                    "line": 1805
                }
            },
            "mangled_name": "__Z4testv",
            "name": "test",
            "nodes": [
                {
                    "ast": "CompoundStmt",
                    "loc": {
                        "begin": {
                            "char": 53343,
                            "col": 13,
                            "line": 1786
                        },
                        "end": {
                            "char": 53713,
                            "col": 2,
                            "line": 1805
                        }
                    },
                    "text": "{\n\tTimer timer;\n\tdouble t = 0.1;\n\n\tal_sleep(t);\n\tconsole.log(\"slept, elapsed %f %f\", t, timer.measure());\n\tt *= 0.1;\n\n\tal_sleep(t);\n\tconsole.log(\"slept, elapsed %f %f\", t, timer.measure());\n\tt *= 0.1;\n\n\tal_sleep(t);\n\tconsole.log(\"slept, elapsed %f %f\", t, timer.measure());\n\tt *= 0.1;\n\n\tal_sleep(t);\n\tconsole.log(\"slept, elapsed %f %f\", t, timer.measure());\n\tt *= 0.1;\n}"
                }
            ],
            "type": "void ()",
            "type_args": [],
            "type_ret": "void"
        },
        {
            "ast": "FunctionDecl",
            "loc": {
                "begin": {
                    "char": 53743,
                    "col": 15,
                    "line": 1809
                },
                "end": {
                    "char": 55690,
                    "col": 6,
                    "line": 1873
                }
            },
            "mangled_name": "_onload",
            "name": "onload",
            "nodes": [
                {
                    "ast": "CompoundStmt",
                    "loc": {
                        "begin": {
                            "char": 53756,
                            "col": 28,
                            "line": 1809
                        },
                        "end": {
                            "char": 55690,
                            "col": 6,
                            "line": 1873
                        }
                    },
                    "text": "{\n\n\t\t//test();\n    \t\n\t\tAlice& alice = Alice::Instance();\n\n\t\tconsole.log(\"onload\");\n\t\tconsole.log(\"sim alice %p\", &alice);\n\n\t\t// import/allocate state\n\t\tstate = statemap.create(\"state.bin\", true);\n\t\tconsole.log(\"sim state %p should be size %d\", state, sizeof(State));\n\t\t//state_initialize();\n\t\tconsole.log(\"onload state initialized\");\n\n\n\t\tonReset();\n\t\t\n\t\tprojFBOs[0].dim.x = projFBOs[1].dim.x = 1920;\n\t\tprojFBOs[0].dim.y = projFBOs[1].dim.y = 1080;\n\n\t\tthreads_begin();\n\n\t\t// how to convert the normalized coordinates of the fluid (0..1) into positions in the world:\n\t\t// this effectively defines the bounds of the fluid in the world:\n\t\t// from transform(field2world(glm::vec3(0.)))\n\t\t// to   transform(field2world(glm::vec3(1.)))\n\t\tfield2world_scale = world_max.x - world_min.x;\n\t\tfield2world = glm::scale(glm::vec3(field2world_scale));\n\t\t// how to convert world positions into normalized texture coordinates in the fluid field:\n\t\tworld2field = glm::inverse(field2world);\n\n\t\t//vive2world = glm::rotate(float(M_PI/2), glm::vec3(0,1,0)) * glm::translate(glm::vec3(-40.f, 0.f, -30.f));\n\t\t\t//glm::rotate(M_PI/2., glm::vec3(0., 1., 0.));\n\t\tleap2view = glm::rotate(float(M_PI * -0.26), glm::vec3(1, 0, 0));\n\n\t\tconsole.log(\"onload fluid initialized\");\n\t\n\t\tgBufferVR.dim = glm::ivec2(512, 512);\n\t\talice.hmd->connect();\n\t\tif (alice.hmd->connected) {\n\t\t\talice.desiredFrameRate = 90;\n\t\t\tgBufferVR.dim = alice.hmd->fbo.dim;\n\t\t} else if (isPlatformWindows()) {\n\t\t\tgBufferVR.dim.x = 1920;\n\t\t\tgBufferVR.dim.y = 1080;\n\t\t\t//alice.streamer->init(gBuffer.dim);\n\t\t}\n\t\tconsole.log(\"gBuffer dim %d x %d\", gBufferVR.dim.x, gBufferVR.dim.y);\n\n\t\t// allocate on GPU:\n\t\tonReloadGPU();\n\t\t\n\t\tconsole.log(\"onload onReloadGPU ran\");\n\n\t\t// register event handlers \n\t\talice.onFrame.connect(onFrame);\n\t\talice.onReloadGPU.connect(onReloadGPU);\n\t\talice.onReset.connect(onReset);\n\n\t\talice.onKeyEvent.connect(onKeyEvent);\n\t\talice.window.position(45, 45);\n\n\t\treturn 0;\n    }"
                }
            ],
            "type": "int ()",
            "type_args": [],
            "type_ret": "int"
        },
        {
            "ast": "FunctionDecl",
            "loc": {
                "begin": {
                    "char": 55710,
                    "col": 15,
                    "line": 1875
                },
                "end": {
                    "char": 56248,
                    "col": 6,
                    "line": 1897
                }
            },
            "mangled_name": "_onunload",
            "name": "onunload",
            "nodes": [
                {
                    "ast": "CompoundStmt",
                    "loc": {
                        "begin": {
                            "char": 55725,
                            "col": 30,
                            "line": 1875
                        },
                        "end": {
                            "char": 56248,
                            "col": 6,
                            "line": 1897
                        }
                    },
                    "text": "{\n\t\tAlice& alice = Alice::Instance();\n\n\t\tthreads_end();\n\n    \t// free resources:\n    \tonUnloadGPU();\n\t\tconsole.log(\"unloaded GPU\");\n    \t\n    \t// unregister handlers\n    \talice.onFrame.disconnect(onFrame);\n    \talice.onReloadGPU.disconnect(onReloadGPU);\n\t\talice.onReset.disconnect(onReset);\n\t\talice.onKeyEvent.disconnect(onKeyEvent);\n\t\tconsole.log(\"disconnected events\");\n    \t\n    \t// export/free state\n    \tstatemap.destroy(true);\n\t\tconsole.log(\"let go of map\");\n\t\n\t\tconsole.log(\"onunload done.\");\n        return 0;\n    }"
                }
            ],
            "type": "int ()",
            "type_args": [],
            "type_ret": "int"
        }
    ]
}
